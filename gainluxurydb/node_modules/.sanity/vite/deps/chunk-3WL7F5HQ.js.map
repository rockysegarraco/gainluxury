{
  "version": 3,
  "sources": ["../../../lodash/isNumber.js", "../../../lodash/camelCase.js", "../../../lodash/kebabCase.js", "../../../toggle-selection/index.js", "../../../copy-to-clipboard/index.js", "../../../react-copy-to-clipboard/lib/Component.js", "../../../react-copy-to-clipboard/lib/index.js", "../../../sanity/src/desk/components/Delay.tsx", "../../../sanity/src/desk/components/DocTitle.tsx", "../../../sanity/src/desk/components/TimeAgo.tsx", "../../../sanity/src/desk/components/confirmDeleteDialog/useReferringDocuments.ts", "../../../sanity/src/desk/components/PublishedStatus.tsx", "../../../sanity/src/desk/components/DraftStatus.tsx", "../../../sanity/src/desk/components/paneItem/PaneItemPreview.tsx", "../../../sanity/src/desk/components/paneRouter/PaneRouterContext.tsx", "../../../sanity/src/desk/components/paneRouter/BackLink.tsx", "../../../sanity/src/desk/components/pane/PaneLayoutContext.ts", "../../../sanity/src/desk/components/pane/usePaneLayout.ts", "../../../sanity/src/desk/components/paneRouter/ChildLink.tsx", "../../../sanity/src/desk/components/paneRouter/ReferenceChildLink.tsx", "../../../sanity/src/desk/components/paneRouter/ParameterizedLink.tsx", "../../../sanity/src/desk/components/paneRouter/usePaneRouter.ts", "../../../sanity/src/desk/components/confirmDeleteDialog/ReferencePreviewLink.tsx", "../../../sanity/src/desk/components/confirmDeleteDialog/ConfirmDeleteDialogBody.styles.tsx", "../../../sanity/src/desk/components/confirmDeleteDialog/ConfirmDeleteDialogBody.tsx", "../../../sanity/src/desk/components/confirmDeleteDialog/ConfirmDeleteDialog.tsx", "../../../sanity/src/desk/components/confirmDeleteDialog/index.tsx", "../../../sanity/src/desk/components/pane/PaneMenuButtonItem.tsx", "../../../sanity/src/desk/components/pane/PaneContextMenuButton.tsx", "../../../sanity/src/desk/components/pane/constants.ts", "../../../sanity/src/desk/components/pane/PaneContext.ts", "../../../sanity/src/desk/components/pane/PaneDivider.tsx", "../../../sanity/src/desk/components/pane/Pane.tsx", "../../../sanity/src/desk/components/pane/usePane.ts", "../../../sanity/src/desk/components/pane/PaneContent.styles.tsx", "../../../sanity/src/desk/components/pane/PaneContent.tsx", "../../../sanity/src/desk/components/pane/PaneFooter.styles.tsx", "../../../sanity/src/desk/components/pane/PaneFooter.tsx", "../../../sanity/src/desk/components/pane/PaneHeader.styles.tsx", "../../../sanity/src/desk/components/pane/PaneHeader.tsx", "../../../sanity/src/desk/components/pane/PaneHeaderActionButton.tsx", "../../../sanity/src/desk/components/pane/PaneLayout.styles.tsx", "../../../sanity/src/desk/menuNodes.ts", "../../../sanity/src/desk/components/IntentButton.tsx", "../../../sanity/src/desk/components/paneHeaderActions/InsufficientPermissionsMessageTooltip.tsx", "../../../sanity/src/desk/components/paneHeaderActions/PaneHeaderCreateButton.tsx", "../../../sanity/src/desk/components/paneHeaderActions/PaneHeaderActions.tsx", "../../../sanity/src/desk/panes/document/DocumentPaneContext.ts", "../../../sanity/src/desk/panes/document/useDocumentPane.tsx", "../../../sanity/src/desk/documentActions/DeleteAction.tsx", "../../../sanity/src/desk/documentActions/DiscardChangesAction.tsx", "../../../sanity/src/desk/documentActions/DuplicateAction.tsx", "../../../sanity/src/desk/documentActions/HistoryRestoreAction.tsx", "../../../sanity/src/desk/documentActions/PublishAction.tsx", "../../../sanity/src/desk/documentActions/UnpublishAction.tsx", "../../../sanity/src/desk/documentBadges/LiveEditBadge.ts", "../../../sanity/src/desk/constants.ts", "../../../sanity/src/desk/getIntentState.ts", "../../../sanity/src/desk/router.ts", "../../../sanity/src/desk/panes/document/constants.ts", "../../../sanity/src/desk/panes/document/documentInspector/DocumentInspectorHeader.tsx", "../../../sanity/src/desk/DeskToolContext.ts", "../../../sanity/src/desk/useDeskTool.ts", "../../../sanity/src/desk/panes/document/documentInspector/Resizer.tsx", "../../../sanity/src/desk/panes/document/documentInspector/Resizable.tsx", "../../../sanity/src/desk/panes/document/inspectors/validation/getPathTypes.ts", "../../../sanity/src/desk/panes/document/inspectors/validation/ValidationInspector.tsx", "../../../sanity/src/desk/panes/document/inspectors/validation/index.ts", "../../../sanity/src/desk/panes/document/timeline/constants.ts", "../../../sanity/src/desk/panes/document/timeline/helpers.ts", "../../../sanity/src/desk/panes/document/timeline/userAvatarStack.tsx", "../../../sanity/src/desk/panes/document/timeline/timelineItem.styled.tsx", "../../../sanity/src/desk/panes/document/timeline/timelineItem.tsx", "../../../sanity/src/desk/panes/document/timeline/timeline.styled.tsx", "../../../sanity/src/desk/panes/document/timeline/timeline.tsx", "../../../sanity/src/desk/panes/document/timeline/TimelineError.tsx", "../../../sanity/src/desk/panes/document/timeline/timelineMenu.tsx", "../../../sanity/src/desk/panes/document/inspectors/changes/LoadingContent.tsx", "../../../sanity/src/desk/panes/document/inspectors/changes/helpers.ts", "../../../sanity/src/desk/panes/document/inspectors/changes/ChangesInspector.tsx", "../../../sanity/src/desk/panes/document/inspectors/changes/index.ts", "../../../sanity/src/desk/deskTool.ts", "../../../sanity/src/desk/panes/document/menuItems.ts", "../../../sanity/src/desk/panes/document/usePreviewUrl.ts", "../../../sanity/src/desk/panes/document/getInitialValueTemplateOpts.ts", "../../../sanity/src/desk/panes/document/DocumentInspectorMenuItemsResolver.tsx", "../../../sanity/src/desk/panes/document/DocumentPaneProvider.tsx", "../../../sanity/src/desk/structureBuilder/SerializeError.ts", "../../../sanity/src/desk/structureBuilder/util/getExtendedProjection.ts", "../../../sanity/src/desk/structureBuilder/Sort.ts", "../../../sanity/src/desk/structureBuilder/MenuItem.ts", "../../../sanity/src/desk/structureBuilder/MenuItemGroup.ts", "../../../sanity/src/desk/structureBuilder/util/validateId.ts", "../../../sanity/src/desk/structureBuilder/util/getStructureNodeId.ts", "../../../sanity/src/desk/structureBuilder/Component.ts", "../../../sanity/src/desk/structureBuilder/util/resolveTypeForDocument.ts", "../../../sanity/src/desk/structureBuilder/views/View.ts", "../../../sanity/src/desk/structureBuilder/views/ComponentView.ts", "../../../sanity/src/desk/structureBuilder/views/FormView.ts", "../../../sanity/src/desk/structureBuilder/views/index.ts", "../../../sanity/src/desk/structureBuilder/Document.ts", "../../../sanity/src/desk/structureBuilder/Layout.ts", "../../../sanity/src/desk/structureBuilder/Intent.ts", "../../../sanity/src/desk/structureBuilder/InitialValueTemplateItem.ts", "../../../sanity/src/desk/structureBuilder/GenericList.ts", "../../../sanity/src/desk/structureBuilder/DocumentList.ts", "../../../sanity/src/desk/structureBuilder/List.ts", "../../../sanity/src/desk/structureBuilder/ListItem.ts", "../../../sanity/src/desk/structureBuilder/DocumentListItem.ts", "../../../sanity/src/desk/structureBuilder/DocumentTypeList.ts", "../../../sanity/src/desk/structureBuilder/documentTypeListItems.ts", "../../../sanity/src/desk/structureBuilder/createStructureBuilder.ts", "../../../sanity/src/desk/DeskToolProvider.tsx"],
  "sourcesContent": ["var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar numberTag = '[object Number]';\n\n/**\n * Checks if `value` is classified as a `Number` primitive or object.\n *\n * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are\n * classified as numbers, use the `_.isFinite` method.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a number, else `false`.\n * @example\n *\n * _.isNumber(3);\n * // => true\n *\n * _.isNumber(Number.MIN_VALUE);\n * // => true\n *\n * _.isNumber(Infinity);\n * // => true\n *\n * _.isNumber('3');\n * // => false\n */\nfunction isNumber(value) {\n  return typeof value == 'number' ||\n    (isObjectLike(value) && baseGetTag(value) == numberTag);\n}\n\nmodule.exports = isNumber;\n", "var capitalize = require('./capitalize'),\n    createCompounder = require('./_createCompounder');\n\n/**\n * Converts `string` to [camel case](https://en.wikipedia.org/wiki/CamelCase).\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to convert.\n * @returns {string} Returns the camel cased string.\n * @example\n *\n * _.camelCase('Foo Bar');\n * // => 'fooBar'\n *\n * _.camelCase('--foo-bar--');\n * // => 'fooBar'\n *\n * _.camelCase('__FOO_BAR__');\n * // => 'fooBar'\n */\nvar camelCase = createCompounder(function(result, word, index) {\n  word = word.toLowerCase();\n  return result + (index ? capitalize(word) : word);\n});\n\nmodule.exports = camelCase;\n", "var createCompounder = require('./_createCompounder');\n\n/**\n * Converts `string` to\n * [kebab case](https://en.wikipedia.org/wiki/Letter_case#Special_case_styles).\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to convert.\n * @returns {string} Returns the kebab cased string.\n * @example\n *\n * _.kebabCase('Foo Bar');\n * // => 'foo-bar'\n *\n * _.kebabCase('fooBar');\n * // => 'foo-bar'\n *\n * _.kebabCase('__FOO_BAR__');\n * // => 'foo-bar'\n */\nvar kebabCase = createCompounder(function(result, word, index) {\n  return result + (index ? '-' : '') + word.toLowerCase();\n});\n\nmodule.exports = kebabCase;\n", "\nmodule.exports = function () {\n  var selection = document.getSelection();\n  if (!selection.rangeCount) {\n    return function () {};\n  }\n  var active = document.activeElement;\n\n  var ranges = [];\n  for (var i = 0; i < selection.rangeCount; i++) {\n    ranges.push(selection.getRangeAt(i));\n  }\n\n  switch (active.tagName.toUpperCase()) { // .toUpperCase handles XHTML\n    case 'INPUT':\n    case 'TEXTAREA':\n      active.blur();\n      break;\n\n    default:\n      active = null;\n      break;\n  }\n\n  selection.removeAllRanges();\n  return function () {\n    selection.type === 'Caret' &&\n    selection.removeAllRanges();\n\n    if (!selection.rangeCount) {\n      ranges.forEach(function(range) {\n        selection.addRange(range);\n      });\n    }\n\n    active &&\n    active.focus();\n  };\n};\n", "\"use strict\";\n\nvar deselectCurrent = require(\"toggle-selection\");\n\nvar clipboardToIE11Formatting = {\n  \"text/plain\": \"Text\",\n  \"text/html\": \"Url\",\n  \"default\": \"Text\"\n}\n\nvar defaultMessage = \"Copy to clipboard: #{key}, Enter\";\n\nfunction format(message) {\n  var copyKey = (/mac os x/i.test(navigator.userAgent) ? \"⌘\" : \"Ctrl\") + \"+C\";\n  return message.replace(/#{\\s*key\\s*}/g, copyKey);\n}\n\nfunction copy(text, options) {\n  var debug,\n    message,\n    reselectPrevious,\n    range,\n    selection,\n    mark,\n    success = false;\n  if (!options) {\n    options = {};\n  }\n  debug = options.debug || false;\n  try {\n    reselectPrevious = deselectCurrent();\n\n    range = document.createRange();\n    selection = document.getSelection();\n\n    mark = document.createElement(\"span\");\n    mark.textContent = text;\n    // avoid screen readers from reading out loud the text\n    mark.ariaHidden = \"true\"\n    // reset user styles for span element\n    mark.style.all = \"unset\";\n    // prevents scrolling to the end of the page\n    mark.style.position = \"fixed\";\n    mark.style.top = 0;\n    mark.style.clip = \"rect(0, 0, 0, 0)\";\n    // used to preserve spaces and line breaks\n    mark.style.whiteSpace = \"pre\";\n    // do not inherit user-select (it may be `none`)\n    mark.style.webkitUserSelect = \"text\";\n    mark.style.MozUserSelect = \"text\";\n    mark.style.msUserSelect = \"text\";\n    mark.style.userSelect = \"text\";\n    mark.addEventListener(\"copy\", function(e) {\n      e.stopPropagation();\n      if (options.format) {\n        e.preventDefault();\n        if (typeof e.clipboardData === \"undefined\") { // IE 11\n          debug && console.warn(\"unable to use e.clipboardData\");\n          debug && console.warn(\"trying IE specific stuff\");\n          window.clipboardData.clearData();\n          var format = clipboardToIE11Formatting[options.format] || clipboardToIE11Formatting[\"default\"]\n          window.clipboardData.setData(format, text);\n        } else { // all other browsers\n          e.clipboardData.clearData();\n          e.clipboardData.setData(options.format, text);\n        }\n      }\n      if (options.onCopy) {\n        e.preventDefault();\n        options.onCopy(e.clipboardData);\n      }\n    });\n\n    document.body.appendChild(mark);\n\n    range.selectNodeContents(mark);\n    selection.addRange(range);\n\n    var successful = document.execCommand(\"copy\");\n    if (!successful) {\n      throw new Error(\"copy command was unsuccessful\");\n    }\n    success = true;\n  } catch (err) {\n    debug && console.error(\"unable to copy using execCommand: \", err);\n    debug && console.warn(\"trying IE specific stuff\");\n    try {\n      window.clipboardData.setData(options.format || \"text\", text);\n      options.onCopy && options.onCopy(window.clipboardData);\n      success = true;\n    } catch (err) {\n      debug && console.error(\"unable to copy using clipboardData: \", err);\n      debug && console.error(\"falling back to prompt\");\n      message = format(\"message\" in options ? options.message : defaultMessage);\n      window.prompt(message, text);\n    }\n  } finally {\n    if (selection) {\n      if (typeof selection.removeRange == \"function\") {\n        selection.removeRange(range);\n      } else {\n        selection.removeAllRanges();\n      }\n    }\n\n    if (mark) {\n      document.body.removeChild(mark);\n    }\n    reselectPrevious();\n  }\n\n  return success;\n}\n\nmodule.exports = copy;\n", "\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CopyToClipboard = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _copyToClipboard = _interopRequireDefault(require(\"copy-to-clipboard\"));\n\nvar _excluded = [\"text\", \"onCopy\", \"options\", \"children\"];\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar CopyToClipboard = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(CopyToClipboard, _React$PureComponent);\n\n  var _super = _createSuper(CopyToClipboard);\n\n  function CopyToClipboard() {\n    var _this;\n\n    _classCallCheck(this, CopyToClipboard);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"onClick\", function (event) {\n      var _this$props = _this.props,\n          text = _this$props.text,\n          onCopy = _this$props.onCopy,\n          children = _this$props.children,\n          options = _this$props.options;\n\n      var elem = _react[\"default\"].Children.only(children);\n\n      var result = (0, _copyToClipboard[\"default\"])(text, options);\n\n      if (onCopy) {\n        onCopy(text, result);\n      } // Bypass onClick if it was present\n\n\n      if (elem && elem.props && typeof elem.props.onClick === 'function') {\n        elem.props.onClick(event);\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(CopyToClipboard, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          _text = _this$props2.text,\n          _onCopy = _this$props2.onCopy,\n          _options = _this$props2.options,\n          children = _this$props2.children,\n          props = _objectWithoutProperties(_this$props2, _excluded);\n\n      var elem = _react[\"default\"].Children.only(children);\n\n      return /*#__PURE__*/_react[\"default\"].cloneElement(elem, _objectSpread(_objectSpread({}, props), {}, {\n        onClick: this.onClick\n      }));\n    }\n  }]);\n\n  return CopyToClipboard;\n}(_react[\"default\"].PureComponent);\n\nexports.CopyToClipboard = CopyToClipboard;\n\n_defineProperty(CopyToClipboard, \"defaultProps\", {\n  onCopy: undefined,\n  options: undefined\n});", "\"use strict\";\n\nvar _require = require('./Component'),\n    CopyToClipboard = _require.CopyToClipboard;\n\nCopyToClipboard.CopyToClipboard = CopyToClipboard;\nmodule.exports = CopyToClipboard;", "import React, {useEffect, useState} from 'react'\n\nexport function Delay({\n  children,\n  ms = 0,\n}: {\n  children?: React.ReactElement | (() => React.ReactElement)\n  ms?: number\n}): React.ReactElement {\n  const [ready, setReady] = useState(ms <= 0)\n\n  useEffect(() => {\n    if (ms <= 0) {\n      return undefined\n    }\n\n    const timeoutId = setTimeout(() => setReady(true), ms)\n\n    return () => {\n      clearTimeout(timeoutId)\n    }\n  }, [ms])\n\n  if (!ready || !children) {\n    return <></>\n  }\n\n  return typeof children === 'function' ? children() : children\n}\n", "import {SanityDocumentLike} from '@sanity/types'\nimport React from 'react'\nimport {useSchema, unstable_useValuePreview as useValuePreview} from 'sanity'\n\nexport interface DocTitleProps {\n  document: SanityDocumentLike\n}\n\nexport function DocTitle(props: DocTitleProps) {\n  const {document: documentValue} = props\n  const schema = useSchema()\n  const schemaType = schema.get(documentValue._type)\n\n  const {error, value} = useValuePreview({\n    schemaType: schemaType!,\n    value: documentValue,\n  })\n\n  if (!schemaType) {\n    return <code>Unknown schema type: {documentValue._type}</code>\n  }\n\n  if (error) {\n    return <>Error: {error.message}</>\n  }\n\n  return <>{value?.title || <span style={{color: 'var(--card-muted-fg-color)'}}>Untitled</span>}</>\n}\n", "import React from 'react'\nimport {useTimeAgo} from 'sanity'\n\nexport interface TimeAgoProps {\n  time: string | Date\n}\n\nexport function TimeAgo({time}: TimeAgoProps) {\n  const timeAgo = useTimeAgo(time)\n\n  return <span title={timeAgo}>{timeAgo} ago</span>\n}\n", "import {useMemo} from 'react'\nimport {ClientError, SanityClient} from '@sanity/client'\nimport {Observable, timer, fromEvent, EMPTY, of} from 'rxjs'\nimport {\n  map,\n  startWith,\n  distinctUntilChanged,\n  switchMap,\n  shareReplay,\n  catchError,\n} from 'rxjs/operators'\nimport {\n  AvailabilityResponse,\n  DEFAULT_STUDIO_CLIENT_OPTIONS,\n  DocumentStore,\n  useDocumentStore,\n  createHookFromObservableFactory,\n  getDraftId,\n  getPublishedId,\n  useClient,\n} from 'sanity'\n\n// this is used in place of `instanceof` so the matching can be more robust and\n// won't have any issues with dual packages etc\n// https://nodejs.org/api/packages.html#dual-package-hazard\nfunction isClientError(e: unknown): e is ClientError {\n  if (typeof e !== 'object') return false\n  if (!e) return false\n  return 'statusCode' in e && 'response' in e\n}\n\nconst POLL_INTERVAL = 5000\n\n// only fetches when the document is visible\nlet visiblePoll$: Observable<number>\nconst getVisiblePoll$ = () => {\n  if (!visiblePoll$) {\n    visiblePoll$ = fromEvent(document, 'visibilitychange').pipe(\n      // add empty emission to have this fire on creation\n      startWith(null),\n      map(() => document.visibilityState === 'visible'),\n      distinctUntilChanged(),\n      switchMap((visible) =>\n        visible\n          ? // using timer instead of interval since timer will emit on creation\n            timer(0, POLL_INTERVAL)\n          : EMPTY,\n      ),\n      shareReplay({refCount: true, bufferSize: 1}),\n    )\n  }\n  return visiblePoll$\n}\n\nexport type ReferringDocuments = {\n  isLoading: boolean\n  totalCount: number\n  projectIds: string[]\n  datasetNames: string[]\n  hasUnknownDatasetNames: boolean\n  internalReferences?: {\n    totalCount: number\n    references: Array<{_id: string; _type: string}>\n  }\n  crossDatasetReferences?: {\n    totalCount: number\n    references: Array<{\n      /**\n       * The project ID of the document that is currently referencing the subject\n       * document. Unlike `documentId` and `datasetName`, this should always be\n       * defined.\n       */\n      projectId: string\n      /**\n       * The ID of the document that is currently referencing the subject\n       * document. This will be omitted if there is no access to the current\n       * project and dataset pair (e.g. if no `sanity-project-token` were\n       * configured)\n       */\n      documentId?: string\n      /**\n       * The dataset name that is currently referencing the subject document.\n       * This will be omitted if there is no access to the current project and\n       * dataset pair (e.g. if no `sanity-project-token` were configured)\n       */\n      datasetName?: string\n    }>\n  }\n}\n\nfunction getDocumentExistence(\n  documentId: string,\n  {versionedClient}: {versionedClient: SanityClient},\n): Observable<string | undefined> {\n  const draftId = getDraftId(documentId)\n  const publishedId = getPublishedId(documentId)\n  const requestOptions = {\n    uri: versionedClient.getDataUrl('doc', `${draftId},${publishedId}`),\n    json: true,\n    query: {excludeContent: 'true'},\n    tag: 'use-referring-documents.document-existence',\n  }\n  return versionedClient.observable.request<AvailabilityResponse>(requestOptions).pipe(\n    map(({omitted}) => {\n      const nonExistant = omitted.filter((doc) => doc.reason === 'existence')\n      if (nonExistant.length === 2) {\n        // None of the documents exist\n        return undefined\n      }\n\n      if (nonExistant.length === 0) {\n        // Both exist, so use the published one\n        return publishedId\n      }\n\n      // If the draft does not exist, use the published ID, and vice versa\n      return nonExistant.some((doc) => doc.id === draftId) ? publishedId : draftId\n    }),\n  )\n}\n\n/**\n * fetches the cross-dataset references using the client observable.request\n * method (for that requests can be automatically cancelled)\n */\nfunction fetchCrossDatasetReferences(\n  documentId: string,\n  context: {versionedClient: SanityClient},\n): Observable<ReferringDocuments['crossDatasetReferences']> {\n  const {versionedClient} = context\n\n  return getVisiblePoll$().pipe(\n    switchMap(() => getDocumentExistence(documentId, context)),\n    switchMap((checkDocumentId) => {\n      if (!checkDocumentId) {\n        return of({totalCount: 0, references: []})\n      }\n\n      const currentDataset = versionedClient.config().dataset\n\n      return versionedClient.observable\n        .request({\n          url: `/data/references/${currentDataset}/documents/${checkDocumentId}/to?excludeInternalReferences=true&excludePaths=true`,\n          tag: 'use-referring-documents.external',\n        })\n        .pipe(\n          catchError((e) => {\n            // it's possible that referencing document doesn't exist yet so the\n            // API will return a 404. In those cases, we want to catch and return\n            // a response with no references\n            if (isClientError(e) && e.statusCode === 404) {\n              return of({totalCount: 0, references: []})\n            }\n\n            throw e\n          }),\n        )\n    }),\n  )\n}\n\nconst useInternalReferences = createHookFromObservableFactory(\n  ([documentId, documentStore]: [string, DocumentStore]) => {\n    const referencesClause = '*[references($documentId)][0...100]{_id,_type}'\n    const totalClause = 'count(*[references($documentId)])'\n    const fetchQuery = `{\"references\":${referencesClause},\"totalCount\":${totalClause}}`\n    const listenQuery = '*[references($documentId)]'\n\n    return documentStore.listenQuery(\n      {fetch: fetchQuery, listen: listenQuery},\n      {documentId},\n      {tag: 'use-referring-documents', transitions: ['appear', 'disappear'], throttleTime: 5000},\n    ) as Observable<ReferringDocuments['internalReferences']>\n  },\n)\n\nconst useCrossDatasetReferences = createHookFromObservableFactory(\n  ([documentId, versionedClient]: [string, SanityClient]) => {\n    // (documentId: string, versionedClient: SanityClient) => {\n    return getVisiblePoll$().pipe(\n      switchMap(() =>\n        fetchCrossDatasetReferences(documentId, {\n          versionedClient,\n        }),\n      ),\n    )\n  },\n)\n\nexport function useReferringDocuments(documentId: string): ReferringDocuments {\n  const versionedClient = useClient(DEFAULT_STUDIO_CLIENT_OPTIONS)\n\n  const documentStore = useDocumentStore()\n  const publishedId = getPublishedId(documentId)\n\n  const [internalReferences, isInternalReferencesLoading] = useInternalReferences(\n    useMemo(() => [publishedId, documentStore], [documentStore, publishedId]),\n  )\n\n  const [crossDatasetReferences, isCrossDatasetReferencesLoading] = useCrossDatasetReferences(\n    useMemo(() => [publishedId, versionedClient], [publishedId, versionedClient]),\n  )\n\n  const projectIds = useMemo(() => {\n    return Array.from(\n      new Set(\n        crossDatasetReferences?.references\n          .map((crossDatasetReference) => crossDatasetReference.projectId)\n          .filter(Boolean),\n      ),\n    ).sort()\n  }, [crossDatasetReferences?.references])\n\n  const datasetNames = useMemo(() => {\n    return Array.from(\n      new Set<string>(\n        crossDatasetReferences?.references\n          // .filter((name) => typeof name === 'string')\n          .map((crossDatasetReference) => crossDatasetReference?.datasetName || '')\n          .filter((datasetName) => Boolean(datasetName) && datasetName !== ''),\n      ),\n    ).sort()\n  }, [crossDatasetReferences?.references])\n\n  const hasUnknownDatasetNames = useMemo(() => {\n    return Boolean(\n      crossDatasetReferences?.references.some(\n        (crossDatasetReference) => typeof crossDatasetReference.datasetName !== 'string',\n      ),\n    )\n  }, [crossDatasetReferences?.references])\n\n  return {\n    totalCount: (internalReferences?.totalCount || 0) + (crossDatasetReferences?.totalCount || 0),\n    projectIds,\n    datasetNames,\n    hasUnknownDatasetNames,\n    internalReferences,\n    crossDatasetReferences,\n    isLoading: isInternalReferencesLoading || isCrossDatasetReferencesLoading,\n  }\n}\n", "import React from 'react'\nimport {PublishIcon} from '@sanity/icons'\nimport {PreviewValue, SanityDocument} from '@sanity/types'\nimport {Box, Text, Tooltip} from '@sanity/ui'\nimport {TimeAgo} from './TimeAgo'\nimport {TextWithTone} from 'sanity'\n\nexport function PublishedStatus(props: {document?: PreviewValue | Partial<SanityDocument> | null}) {\n  const {document} = props\n  const updatedAt = document && '_updatedAt' in document && document._updatedAt\n  const statusLabel = document ? 'Published' : 'Not published'\n\n  return (\n    <Tooltip\n      portal\n      content={\n        <Box padding={2}>\n          <Text size={1}>\n            {document ? (\n              <>Published {updatedAt && <TimeAgo time={updatedAt} />}</>\n            ) : (\n              <>Not published</>\n            )}\n          </Text>\n        </Box>\n      }\n    >\n      <TextWithTone tone=\"positive\" dimmed={!document} muted={!document} size={1}>\n        <PublishIcon aria-label={statusLabel} />\n      </TextWithTone>\n    </Tooltip>\n  )\n}\n", "import React from 'react'\nimport {EditIcon} from '@sanity/icons'\nimport {PreviewValue, SanityDocument} from '@sanity/types'\nimport {Box, Text, Tooltip} from '@sanity/ui'\nimport {TimeAgo} from './TimeAgo'\nimport {TextWithTone} from 'sanity'\n\nexport function DraftStatus(props: {document?: PreviewValue | Partial<SanityDocument> | null}) {\n  const {document} = props\n  const updatedAt = document && '_updatedAt' in document && document._updatedAt\n\n  return (\n    <Tooltip\n      portal\n      content={\n        <Box padding={2}>\n          <Text size={1}>\n            {document ? (\n              <>Edited {updatedAt && <TimeAgo time={updatedAt} />}</>\n            ) : (\n              <>No unpublished edits</>\n            )}\n          </Text>\n        </Box>\n      }\n    >\n      <TextWithTone tone=\"caution\" dimmed={!document} muted={!document} size={1}>\n        <EditIcon />\n      </TextWithTone>\n    </Tooltip>\n  )\n}\n", "import type {SanityDocument, SchemaType} from '@sanity/types'\nimport React, {isValidElement} from 'react'\nimport {isNumber, isString} from 'lodash'\nimport {Inline} from '@sanity/ui'\nimport {useMemoObservable} from 'react-rx'\nimport {PublishedStatus} from '../PublishedStatus'\nimport {DraftStatus} from '../DraftStatus'\nimport type {PaneItemPreviewState} from './types'\nimport {\n  DocumentPresence,\n  DocumentPreviewPresence,\n  DocumentPreviewStore,\n  GeneralPreviewLayoutKey,\n  getPreviewStateObservable,\n  getPreviewValueWithFallback,\n  SanityDefaultPreview,\n  isRecord,\n} from 'sanity'\n\nexport interface PaneItemPreviewProps {\n  documentPreviewStore: DocumentPreviewStore\n  icon: React.ComponentType | false\n  layout: GeneralPreviewLayoutKey\n  presence?: DocumentPresence[]\n  schemaType: SchemaType\n  value: SanityDocument\n}\n\nexport function PaneItemPreview(props: PaneItemPreviewProps) {\n  const {icon, layout, presence, schemaType, value} = props\n  const title =\n    (isRecord(value.title) && isValidElement(value.title)) ||\n    isString(value.title) ||\n    isNumber(value.title)\n      ? value.title\n      : null\n\n  // NOTE: this emits sync so can never be null\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  const {draft, published, isLoading} = useMemoObservable<PaneItemPreviewState>(\n    () => getPreviewStateObservable(props.documentPreviewStore, schemaType, value._id, title),\n    [props.documentPreviewStore, schemaType, value._id, title],\n  )!\n\n  const status = isLoading ? null : (\n    <Inline space={4}>\n      {presence && presence.length > 0 && <DocumentPreviewPresence presence={presence} />}\n      <PublishedStatus document={published} />\n      <DraftStatus document={draft} />\n    </Inline>\n  )\n\n  return (\n    <SanityDefaultPreview\n      {...getPreviewValueWithFallback({value, draft, published})}\n      isPlaceholder={isLoading}\n      icon={icon}\n      layout={layout}\n      status={status}\n    />\n  )\n}\n", "import {createContext} from 'react'\nimport {PaneRouterContextValue} from './types'\n\nfunction missingContext<T = unknown>(): T {\n  throw new Error('Pane is missing router context')\n}\n\n/**\n *\n * @hidden\n * @beta\n */\nexport const PaneRouterContext = createContext<PaneRouterContextValue>({\n  index: 0,\n  groupIndex: 0,\n  siblingIndex: 0,\n  payload: undefined,\n  params: {},\n  hasGroupSiblings: false,\n  groupLength: 0,\n  routerPanesState: [],\n  BackLink: () => missingContext(),\n  ChildLink: () => missingContext(),\n  ReferenceChildLink: () => missingContext(),\n  handleEditReference: () => missingContext(),\n  ParameterizedLink: () => missingContext(),\n  replaceCurrent: () => missingContext(),\n  closeCurrentAndAfter: () => missingContext(),\n  closeCurrent: () => missingContext(),\n  duplicateCurrent: () => missingContext(),\n  setView: () => missingContext(),\n  setParams: () => missingContext(),\n  setPayload: () => missingContext(),\n  navigateIntent: () => missingContext(),\n})\n", "import React, {forwardRef, useContext, useMemo} from 'react'\nimport {PaneRouterContext} from './PaneRouterContext'\nimport {BackLinkProps} from './types'\nimport {StateLink} from 'sanity/router'\n\n/**\n * @internal\n */\nexport const BackLink = forwardRef(function BackLink(\n  props: BackLinkProps,\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  const {routerPanesState, groupIndex} = useContext(PaneRouterContext)\n  const panes = useMemo(() => routerPanesState.slice(0, groupIndex), [groupIndex, routerPanesState])\n  const state = useMemo(() => ({panes}), [panes])\n\n  return <StateLink {...props} ref={ref} state={state} />\n}) as React.ComponentType<BackLinkProps>\n", "import {createContext} from 'react'\nimport {PaneLayoutContextValue} from './types'\n\n/**\n * @internal\n */\nexport const PaneLayoutContext = createContext<PaneLayoutContextValue | null>(null)\n", "import {useContext} from 'react'\nimport {PaneLayoutContext} from './PaneLayoutContext'\nimport {PaneLayoutContextValue} from './types'\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport function usePaneLayout(): PaneLayoutContextValue {\n  const pane = useContext(PaneLayoutContext)\n\n  if (!pane) {\n    throw new Error('PaneLayout: missing context value')\n  }\n\n  return pane\n}\n", "import React, {forwardRef, useContext} from 'react'\nimport {PaneRouterContext} from './PaneRouterContext'\nimport {ChildLinkProps} from './types'\nimport {StateLink} from 'sanity/router'\n\n/**\n * @internal\n */\nexport const ChildLink = forwardRef(function ChildLink(\n  props: ChildLinkProps,\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  const {childId, childPayload, childParameters, ...rest} = props\n  const {routerPanesState, groupIndex} = useContext(PaneRouterContext)\n\n  return (\n    <StateLink\n      {...rest}\n      ref={ref}\n      state={{\n        panes: [\n          ...routerPanesState.slice(0, groupIndex + 1),\n          [{id: childId, params: childParameters, payload: childPayload}],\n        ],\n      }}\n    />\n  )\n})\n", "import React, {forwardRef} from 'react'\nimport {toString as pathToString} from '@sanity/util/paths'\nimport {ChildLink} from './ChildLink'\nimport {ReferenceChildLinkProps} from './types'\n\nexport const ReferenceChildLink = forwardRef(function ReferenceChildLink(\n  {documentId, documentType, parentRefPath, children, template, ...rest}: ReferenceChildLinkProps,\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  return (\n    <ChildLink\n      {...rest}\n      ref={ref}\n      childId={documentId}\n      childPayload={template?.params}\n      childParameters={{\n        type: documentType,\n        parentRefPath: pathToString(parentRefPath),\n        ...(template && {template: template?.id}),\n      }}\n    >\n      {children}\n    </ChildLink>\n  )\n})\n", "import React, {forwardRef, useContext, useMemo} from 'react'\nimport {PaneRouterContext} from './PaneRouterContext'\nimport {useUnique} from 'sanity'\nimport {StateLink} from 'sanity/router'\n\ninterface ParameterizedLinkProps {\n  params?: Record<string, string>\n  payload?: unknown\n  children?: React.ReactNode\n}\n\n/**\n * @internal\n */\nexport const ParameterizedLink = forwardRef(function ParameterizedLink(\n  props: ParameterizedLinkProps,\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  const {routerPanesState: currentPanes, groupIndex, siblingIndex} = useContext(PaneRouterContext)\n  const {params, payload, ...rest} = props\n  const nextParams = useUnique(params)\n  const nextPayload = useUnique(payload)\n\n  const nextState = useMemo(() => {\n    const currentGroup = currentPanes[groupIndex]\n    const currentSibling = currentGroup[siblingIndex]\n\n    const nextSibling = {\n      ...currentSibling,\n      params: nextParams ?? currentSibling.params,\n      payload: nextPayload ?? currentSibling.payload,\n    }\n\n    const nextGroup = [\n      ...currentGroup.slice(0, siblingIndex),\n      nextSibling,\n      ...currentGroup.slice(siblingIndex + 1),\n    ]\n\n    const nextPanes = [\n      ...currentPanes.slice(0, groupIndex),\n      nextGroup,\n      ...currentPanes.slice(groupIndex + 1),\n    ]\n\n    return {panes: nextPanes}\n  }, [currentPanes, groupIndex, nextParams, nextPayload, siblingIndex])\n\n  return <StateLink ref={ref} {...rest} state={nextState} />\n})\n", "import {useContext} from 'react'\nimport {PaneRouterContext} from './PaneRouterContext'\nimport {PaneRouterContextValue} from './types'\n\n/**\n *\n * @hidden\n * @beta\n */\nexport function usePaneRouter(): PaneRouterContextValue {\n  return useContext(PaneRouterContext)\n}\n", "import React, {useCallback} from 'react'\nimport type {SanityDocument, SchemaType} from '@sanity/types'\nimport {PaneItemPreview} from '../paneItem/PaneItemPreview'\nimport {usePaneRouter} from '../paneRouter'\nimport {\n  FIXME,\n  PreviewCard,\n  getPublishedId,\n  useDocumentPresence,\n  useDocumentPreviewStore,\n} from 'sanity'\n\nconst EMPTY_ARRAY: [] = []\n\ninterface ReferencePreviewLinkProps {\n  onClick?: () => void\n  type: SchemaType & {icon?: any}\n  value: SanityDocument\n}\n\nexport function ReferencePreviewLink(props: ReferencePreviewLinkProps) {\n  const {onClick, type, value} = props\n  const publishedId = getPublishedId(value?._id)\n  const documentPresence = useDocumentPresence(publishedId)\n  const documentPreviewStore = useDocumentPreviewStore()\n  const {ReferenceChildLink} = usePaneRouter()\n\n  const Link = useCallback(\n    function LinkComponent(linkProps: {children: React.ReactNode}) {\n      return (\n        <ReferenceChildLink\n          documentId={value?._id}\n          documentType={type?.name}\n          parentRefPath={EMPTY_ARRAY}\n          {...linkProps}\n        />\n      )\n    },\n    [ReferenceChildLink, type?.name, value?._id],\n  )\n\n  return (\n    <PreviewCard\n      __unstable_focusRing\n      as={Link as FIXME}\n      data-as=\"a\"\n      onClick={onClick}\n      padding={2}\n      radius={2}\n    >\n      <PaneItemPreview\n        documentPreviewStore={documentPreviewStore}\n        icon={type?.icon}\n        layout=\"default\"\n        presence={documentPresence?.length > 0 ? documentPresence : EMPTY_ARRAY}\n        schemaType={type}\n        value={value}\n      />\n    </PreviewCard>\n  )\n}\n", "import React from 'react'\nimport styled from 'styled-components'\nimport {rem, Flex, Text, Box, Tooltip, Container, Inline} from '@sanity/ui'\nimport {InfoOutlineIcon} from '@sanity/icons'\n\nexport const ChevronWrapper = styled(Box)`\n  margin-left: auto;\n`\n\nexport const CrossDatasetReferencesDetails = styled.details`\n  flex: none;\n\n  &[open] ${ChevronWrapper} {\n    transform: rotate(180deg);\n  }\n`\n\nexport const CrossDatasetReferencesSummary = styled.summary`\n  list-style: none;\n\n  &::-webkit-details-marker {\n    display: none;\n  }\n`\n\nexport const Table = styled.table`\n  width: 100%;\n  text-align: left;\n  padding: 0 ${({theme}) => rem(theme.sanity.space[2])};\n  border-collapse: collapse;\n\n  th {\n    padding: ${({theme}) => rem(theme.sanity.space[1])};\n  }\n\n  td {\n    padding: 0 ${({theme}) => rem(theme.sanity.space[1])};\n  }\n\n  tr > *:last-child {\n    text-align: right;\n  }\n`\n\nexport const DocumentIdFlex = styled(Flex)`\n  min-height: 35px;\n`\n\nexport const OtherReferenceCount = (props: {totalCount: number; references: unknown[]}) => {\n  const difference = props.totalCount - props.references.length\n\n  if (!difference) return null\n\n  return (\n    <Inline space={2}>\n      <Text size={1} muted>\n        {difference} other reference{difference === 1 ? '' : 's'} not shown{' '}\n      </Text>\n\n      <Tooltip\n        portal\n        placement=\"top\"\n        content={\n          <Container width={0}>\n            <Box padding={2}>\n              <Text size={1}>\n                We can't show metadata about these references because no token with access to the\n                datasets they are in was found.\n              </Text>\n            </Box>\n          </Container>\n        }\n      >\n        <Text size={1} muted>\n          <InfoOutlineIcon />\n        </Text>\n      </Tooltip>\n    </Inline>\n  )\n}\n", "import React, {useCallback} from 'react'\nimport {\n  WarningOutlineIcon,\n  DocumentsIcon,\n  ClipboardIcon,\n  UnknownIcon,\n  ChevronDownIcon,\n} from '@sanity/icons'\nimport {useToast, Text, Box, Button, Flex, Label, Card, Stack} from '@sanity/ui'\nimport CopyToClipboard from 'react-copy-to-clipboard'\nimport {ReferencePreviewLink} from './ReferencePreviewLink'\nimport {ReferringDocuments} from './useReferringDocuments'\nimport {\n  OtherReferenceCount,\n  CrossDatasetReferencesDetails,\n  CrossDatasetReferencesSummary,\n  Table,\n  ChevronWrapper,\n  DocumentIdFlex,\n} from './ConfirmDeleteDialogBody.styles'\nimport {SanityDefaultPreview, useSchema} from 'sanity'\n\ntype DeletionConfirmationDialogBodyProps = Required<ReferringDocuments> & {\n  documentTitle: React.ReactNode\n  action: string\n  onReferenceLinkClick?: () => void\n}\n\n/**\n * The inner part of the `ConfirmDeleteDialog`. This is ran when both the\n * `crossDatasetReferences` and `internalReferences` are loaded.\n */\nexport function ConfirmDeleteDialogBody({\n  crossDatasetReferences,\n  internalReferences,\n  documentTitle,\n  totalCount,\n  action,\n  datasetNames,\n  hasUnknownDatasetNames,\n  onReferenceLinkClick,\n}: DeletionConfirmationDialogBodyProps) {\n  const schema = useSchema()\n  const toast = useToast()\n\n  const renderPreviewItem = useCallback(\n    (item: any) => {\n      const type = schema.get(item._type)\n      if (type) {\n        return <ReferencePreviewLink type={type} value={item} onClick={onReferenceLinkClick} />\n      }\n\n      return (\n        // Padding added to match the ReferencePreviewLink styling\n        <Box padding={2}>\n          <SanityDefaultPreview\n            icon={UnknownIcon}\n            title=\"Preview Unavailable\"\n            subtitle={`ID: ${item._id}`}\n            layout=\"default\"\n          />\n        </Box>\n      )\n    },\n    [schema, onReferenceLinkClick],\n  )\n\n  if (internalReferences?.totalCount === 0 && crossDatasetReferences?.totalCount === 0) {\n    return (\n      <Text as=\"p\">\n        Are you sure you want to {action} <strong>“{documentTitle}”</strong>?\n      </Text>\n    )\n  }\n\n  const documentCount =\n    crossDatasetReferences.totalCount === 1\n      ? '1 document'\n      : `${crossDatasetReferences.totalCount.toLocaleString()} documents`\n\n  // We do some extra checks to handle cases where you have unavailable dataset\n  // name(s) due to permissions, both alone and in combination with known datasets\n\n  // This normalizes one or more undefined dataset names to the catch-all `unavailable`\n  const normalizedDatasetNames = [\n    ...datasetNames,\n    ...(hasUnknownDatasetNames ? ['unavailable'] : []),\n  ]\n  const datasetsCount =\n    normalizedDatasetNames.length === 1\n      ? 'another dataset'\n      : `${normalizedDatasetNames.length} datasets`\n\n  let datasetNameList = `Dataset${\n    normalizedDatasetNames.length === 1 ? '' : 's'\n  }: ${normalizedDatasetNames.join(', ')}`\n\n  // We only have one dataset, and it is unavailable due to permissions\n  if (hasUnknownDatasetNames && normalizedDatasetNames.length === 1) {\n    datasetNameList = 'Unavailable dataset'\n  }\n\n  return (\n    <Card>\n      <Card padding={3} radius={2} tone=\"caution\" marginBottom={4} flex=\"none\">\n        <Flex>\n          <Text aria-hidden=\"true\" size={1}>\n            <WarningOutlineIcon />\n          </Text>\n          <Box flex={1} marginLeft={3}>\n            <Text size={1}>\n              {totalCount === 1 ? (\n                <>1 document refers to “{documentTitle}”</>\n              ) : (\n                <>\n                  {totalCount.toLocaleString()} documents refer to “{documentTitle}”\n                </>\n              )}\n            </Text>\n          </Box>\n        </Flex>\n      </Card>\n\n      <Box flex=\"none\" marginBottom={4}>\n        <Text>\n          You may not be able to {action} “{documentTitle}” because the following documents refer to\n          it:\n        </Text>\n      </Box>\n\n      <Card radius={2} shadow={1} marginBottom={4} flex=\"auto\">\n        <Flex direction=\"column\">\n          {internalReferences.totalCount > 0 && (\n            <Stack as=\"ul\" padding={2} space={3} data-testid=\"internal-references\">\n              {internalReferences?.references.map((item) => (\n                <Box as=\"li\" key={item._id}>\n                  {renderPreviewItem(item)}\n                </Box>\n              ))}\n\n              {internalReferences.totalCount > internalReferences.references.length && (\n                <Box as=\"li\" padding={3}>\n                  <OtherReferenceCount {...internalReferences} />\n                </Box>\n              )}\n            </Stack>\n          )}\n\n          {crossDatasetReferences.totalCount > 0 && (\n            <CrossDatasetReferencesDetails\n              data-testid=\"cross-dataset-references\"\n              style={{\n                // only add the border if needed\n                borderTop:\n                  internalReferences.totalCount > 0\n                    ? '1px solid var(--card-shadow-outline-color)'\n                    : undefined,\n              }}\n            >\n              <CrossDatasetReferencesSummary>\n                <Card as=\"a\" margin={2} radius={2} shadow={1} paddingY={1}>\n                  <Flex align=\"center\" margin={2}>\n                    <Box marginLeft={3} marginRight={4}>\n                      <Text size={3}>\n                        <DocumentsIcon />\n                      </Text>\n                    </Box>\n                    <Flex marginRight={4} direction=\"column\">\n                      <Box marginBottom={2}>\n                        <Text>\n                          {documentCount} in {datasetsCount}\n                        </Text>\n                      </Box>\n                      <Box>\n                        <Text title={datasetNameList} textOverflow=\"ellipsis\" size={1} muted>\n                          {datasetNameList}\n                        </Text>\n                      </Box>\n                    </Flex>\n                    <ChevronWrapper>\n                      <Text muted>\n                        <ChevronDownIcon />\n                      </Text>\n                    </ChevronWrapper>\n                  </Flex>\n                </Card>\n              </CrossDatasetReferencesSummary>\n\n              <Box overflow=\"auto\" paddingBottom={2} paddingX={2}>\n                <Table>\n                  <thead>\n                    <tr>\n                      <th>\n                        <Label muted size={0} style={{minWidth: '5rem'}}>\n                          Project ID\n                        </Label>\n                      </th>\n                      <th>\n                        <Label muted size={0}>\n                          Dataset\n                        </Label>\n                      </th>\n                      <th>\n                        <Label muted size={0}>\n                          Document ID\n                        </Label>\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {crossDatasetReferences.references\n                      .filter((reference): reference is Required<typeof reference> => {\n                        return 'projectId' in reference\n                      })\n                      .map(({projectId, datasetName, documentId}, index) => (\n                        // eslint-disable-next-line react/no-array-index-key\n                        <tr key={`${documentId}-${index}`}>\n                          <td>\n                            <Text size={1}>{projectId}</Text>\n                          </td>\n                          <td>\n                            <Text size={1}>{datasetName || 'unavailable'}</Text>\n                          </td>\n                          <td>\n                            <DocumentIdFlex align=\"center\" gap={2} justify=\"flex-end\">\n                              <Text textOverflow=\"ellipsis\" size={1}>\n                                {documentId || 'unavailable'}\n                              </Text>\n                              {documentId && (\n                                <CopyToClipboard\n                                  text={documentId}\n                                  // eslint-disable-next-line react/jsx-no-bind\n                                  onCopy={() => {\n                                    // TODO: this isn't visible with the dialog open\n                                    toast.push({\n                                      title: 'Copied document ID to clipboard!',\n                                      status: 'success',\n                                    })\n                                  }}\n                                >\n                                  <Button\n                                    title=\"Copy ID to clipboard\"\n                                    mode=\"bleed\"\n                                    icon={ClipboardIcon}\n                                    fontSize={0}\n                                  />\n                                </CopyToClipboard>\n                              )}\n                            </DocumentIdFlex>\n                          </td>\n                        </tr>\n                      ))}\n                  </tbody>\n                </Table>\n\n                <Box padding={2}>\n                  <OtherReferenceCount {...crossDatasetReferences} />\n                </Box>\n              </Box>\n            </CrossDatasetReferencesDetails>\n          )}\n        </Flex>\n      </Card>\n\n      <Box flex=\"none\">\n        <Text>\n          If you {action} this document, documents that refer to it will no longer be able to access\n          it.\n        </Text>\n      </Box>\n    </Card>\n  )\n}\n", "import React, {useMemo, useId} from 'react'\nimport styled from 'styled-components'\nimport {Box, Dialog, Button, Text, Spinner, Grid, Flex} from '@sanity/ui'\nimport {DocTitle} from '../DocTitle'\nimport {useReferringDocuments} from './useReferringDocuments'\nimport {ConfirmDeleteDialogBody} from './ConfirmDeleteDialogBody'\n\n/** @internal */\nexport const DialogBody = styled(Box).attrs({\n  padding: 4,\n})`\n  box-sizing: border-box;\n`\n\n/** @internal */\nexport const LoadingContainer = styled(Flex).attrs({\n  align: 'center',\n  direction: 'column',\n  justify: 'center',\n})`\n  height: 300px;\n`\n\n/** @internal */\nexport interface ConfirmDeleteDialogProps {\n  /**\n   * Incoming document ID used to find other referencing documents. This\n   * field respects draft IDs (e.g. if you pass in a published ID when one\n   * doesn't exist the document title may not show up).\n   */\n  id: string\n  /**\n   * The schema typename of the incoming document\n   */\n  type: string\n  /**\n   * The name of the action being done. (e.g. the `'unpublish'` action requires\n   * the same document deletion confirmation).\n   */\n  action?: string\n  onCancel: () => void\n  onConfirm: () => void\n}\n\n/**\n * A confirmation dialog used to prevent unwanted document deletes. Loads all\n * the referencing internal and cross-data references prior to showing the\n * delete button.\n *\n * @internal\n */\nexport function ConfirmDeleteDialog({\n  id,\n  type,\n  action = 'delete',\n  onCancel,\n  onConfirm,\n}: ConfirmDeleteDialogProps) {\n  const dialogId = `deletion-confirmation-${useId()}`\n  const {\n    internalReferences,\n    crossDatasetReferences,\n    isLoading,\n    totalCount,\n    projectIds,\n    datasetNames,\n    hasUnknownDatasetNames,\n  } = useReferringDocuments(id)\n  const capitalizedAction = `${action.substring(0, 1).toUpperCase()}${action.substring(1)}`\n\n  const documentTitle = <DocTitle document={useMemo(() => ({_id: id, _type: type}), [id, type])} />\n  const showConfirmButton = !isLoading\n\n  return (\n    <Dialog\n      width={1}\n      id={dialogId}\n      header={`${capitalizedAction} document?`}\n      footer={\n        <Grid columns={showConfirmButton ? 2 : 1} gap={2} paddingX={4} paddingY={3}>\n          <Button mode=\"ghost\" onClick={onCancel} text=\"Cancel\" />\n\n          {showConfirmButton && (\n            <Button\n              data-testid=\"confirm-delete-button\"\n              text={totalCount > 0 ? `${capitalizedAction} anyway` : `${capitalizedAction} now`}\n              tone=\"critical\"\n              onClick={onConfirm}\n            />\n          )}\n        </Grid>\n      }\n      onClose={onCancel}\n      onClickOutside={onCancel}\n    >\n      <DialogBody>\n        {crossDatasetReferences && internalReferences && !isLoading ? (\n          <ConfirmDeleteDialogBody\n            crossDatasetReferences={crossDatasetReferences}\n            internalReferences={internalReferences}\n            documentTitle={documentTitle}\n            isLoading={isLoading}\n            totalCount={totalCount}\n            action={action}\n            projectIds={projectIds}\n            datasetNames={datasetNames}\n            hasUnknownDatasetNames={hasUnknownDatasetNames}\n            onReferenceLinkClick={onCancel}\n          />\n        ) : (\n          <LoadingContainer data-testid=\"loading-container\">\n            <Spinner muted />\n            <Box marginTop={3}>\n              <Text align=\"center\" muted size={1}>\n                Looking for referring documents…\n              </Text>\n            </Box>\n          </LoadingContainer>\n        )}\n      </DialogBody>\n    </Dialog>\n  )\n}\n", "import React, {useCallback, useState, useId} from 'react'\nimport {Box, Flex, Button, Dialog, Text, ErrorBoundary} from '@sanity/ui'\nimport {ConfirmDeleteDialog, ConfirmDeleteDialogProps} from './ConfirmDeleteDialog'\n\nexport type {ConfirmDeleteDialogProps}\n\ntype ArgType<T> = T extends (arg: infer U) => unknown ? U : never\ntype ErrorInfo = ArgType<React.ComponentProps<typeof ErrorBoundary>['onCatch']>\n\n/** @internal */\nfunction ConfirmDeleteDialogContainer(props: ConfirmDeleteDialogProps) {\n  const id = useId()\n  const [error, setError] = useState<ErrorInfo | null>(null)\n  const handleRetry = useCallback(() => setError(null), [])\n\n  return error ? (\n    <Dialog\n      id={`dialog-error-${id}`}\n      data-testid=\"confirm-delete-error-dialog\"\n      header=\"Error\"\n      footer={\n        <Flex paddingX={4} paddingY={3} direction=\"column\">\n          <Button mode=\"ghost\" text=\"Retry\" onClick={handleRetry} />\n        </Flex>\n      }\n      onClose={props.onCancel}\n    >\n      <Box padding={4}>\n        <Text>An error occurred while loading referencing documents.</Text>\n      </Box>\n    </Dialog>\n  ) : (\n    <ErrorBoundary onCatch={setError}>\n      <ConfirmDeleteDialog {...props} />\n    </ErrorBoundary>\n  )\n}\n\nexport {ConfirmDeleteDialogContainer as ConfirmDeleteDialog}\n", "import {CheckmarkIcon} from '@sanity/icons'\nimport {Box, Label, MenuDivider, MenuGroup, MenuItem, PopoverProps, Text} from '@sanity/ui'\nimport React, {useCallback, MouseEvent} from 'react'\nimport {Intent} from '../../structureBuilder'\nimport {_PaneMenuItem, _PaneMenuNode} from './types'\nimport {TooltipOfDisabled} from 'sanity'\nimport {useIntentLink} from 'sanity/router'\n\nconst MENU_GROUP_POPOVER_PROPS: PopoverProps = {\n  constrainSize: true,\n  placement: 'left-start',\n  portal: true,\n}\n\nexport function PaneMenuButtonItem(props: {\n  disabled?: boolean\n  isAfterGroup: boolean\n  node: _PaneMenuNode\n}) {\n  const {disabled, isAfterGroup, node} = props\n\n  if (node.type === 'divider') {\n    return <MenuDivider />\n  }\n\n  if (node.type === 'group') {\n    if (node.children.length === 0) {\n      return null\n    }\n\n    if (node.expanded) {\n      return (\n        <>\n          {isAfterGroup && <MenuDivider />}\n          {node.title && (\n            <Box padding={2} paddingBottom={1}>\n              <Label muted size={0}>\n                {node.title}\n              </Label>\n            </Box>\n          )}\n          {node.children.map((child, childIndex) => (\n            <PaneMenuButtonItem\n              disabled={disabled || Boolean(node.disabled)}\n              isAfterGroup={node.children[childIndex - 1]?.type === 'group'}\n              key={child.key}\n              node={child}\n            />\n          ))}\n        </>\n      )\n    }\n\n    return (\n      <>\n        {isAfterGroup && <MenuDivider />}\n        <MenuGroup\n          disabled={disabled}\n          icon={node.icon}\n          popover={MENU_GROUP_POPOVER_PROPS}\n          text={node.title}\n        >\n          {node.children.map((child, childIndex) => (\n            <PaneMenuButtonItem\n              disabled={disabled || Boolean(node.disabled)}\n              isAfterGroup={node.children[childIndex - 1]?.type === 'group'}\n              key={child.key}\n              node={child}\n            />\n          ))}\n        </MenuGroup>\n      </>\n    )\n  }\n\n  return (\n    <>\n      {isAfterGroup && <MenuDivider />}\n      <PaneContextMenuItemResolver disabled={disabled} node={node} />\n    </>\n  )\n}\n\nfunction PaneContextMenuItemResolver(props: {disabled?: boolean; node: _PaneMenuItem}) {\n  const {node} = props\n\n  if (node.intent) {\n    return <PaneContextIntentMenuItem {...props} intent={node.intent} />\n  }\n\n  return <PaneContextMenuItem {...props} />\n}\n\nfunction PaneContextMenuItem(props: {disabled?: boolean; node: _PaneMenuItem}) {\n  const {disabled, node} = props\n  const tooltipContent = typeof node.disabled === 'object' && (\n    <Text size={1}>{node.disabled.reason}</Text>\n  )\n\n  return (\n    <TooltipOfDisabled content={tooltipContent} placement=\"left\">\n      <MenuItem\n        disabled={disabled || Boolean(node.disabled)}\n        hotkeys={node.hotkey?.split('+')}\n        icon={node.icon}\n        iconRight={node.iconRight || (node.selected && CheckmarkIcon)}\n        // eslint-disable-next-line react/jsx-handler-names\n        onClick={node.onAction}\n        pressed={node.selected}\n        text={node.title}\n        tone={node.tone}\n      />\n    </TooltipOfDisabled>\n  )\n}\n\nfunction PaneContextIntentMenuItem(props: {\n  disabled?: boolean\n  intent: Intent\n  node: _PaneMenuItem\n}) {\n  const {disabled, intent, node} = props\n  const tooltipContent = typeof node.disabled === 'object' && (\n    <Text size={1}>{node.disabled.reason}</Text>\n  )\n  const intentLink = useIntentLink({intent: intent.type, params: intent.params})\n\n  const handleClick = useCallback(\n    (event: MouseEvent<HTMLDivElement>) => {\n      intentLink.onClick(event)\n      node.onAction()\n    },\n    [intentLink, node],\n  )\n\n  return (\n    <TooltipOfDisabled content={tooltipContent} placement=\"left\">\n      <MenuItem\n        as=\"a\"\n        disabled={disabled || Boolean(node.disabled)}\n        hotkeys={node.hotkey?.split('+')}\n        href={intentLink.href}\n        icon={node.icon}\n        iconRight={node.selected ? CheckmarkIcon : undefined}\n        onClick={handleClick}\n        pressed={node.selected}\n        text={node.title}\n        tone={node.tone}\n      />\n    </TooltipOfDisabled>\n  )\n}\n", "import {EllipsisVerticalIcon} from '@sanity/icons'\nimport {Menu, MenuButton, PopoverProps} from '@sanity/ui'\nimport React, {useId} from 'react'\nimport {_PaneMenuItem, _PaneMenuNode} from './types'\nimport {PaneMenuButtonItem} from './PaneMenuButtonItem'\nimport {StatusButton} from 'sanity'\n\ninterface PaneContextMenuButtonProps {\n  nodes: _PaneMenuNode[]\n}\n\nconst CONTEXT_MENU_POPOVER_PROPS: PopoverProps = {\n  constrainSize: true,\n  placement: 'bottom',\n  portal: true,\n}\n\nfunction nodesHasTone(nodes: _PaneMenuNode[], tone: NonNullable<_PaneMenuItem['tone']>): boolean {\n  return nodes.some((node) => {\n    return (\n      (node.type === 'item' && node.tone === tone) ||\n      (node.type === 'group' && nodesHasTone(node.children, tone))\n    )\n  })\n}\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport function PaneContextMenuButton(props: PaneContextMenuButtonProps) {\n  const {nodes} = props\n  const id = useId()\n\n  const hasCritical = nodesHasTone(nodes, 'critical')\n  const hasCaution = nodesHasTone(nodes, 'caution')\n\n  return (\n    <MenuButton\n      button={\n        <StatusButton\n          icon={EllipsisVerticalIcon}\n          mode=\"bleed\"\n          title=\"Show menu\"\n          // eslint-disable-next-line no-nested-ternary\n          tone={hasCritical ? 'critical' : hasCaution ? 'caution' : undefined}\n        />\n      }\n      id={id}\n      menu={\n        <Menu>\n          {nodes.map((node, nodeIndex) => {\n            const isAfterGroup = nodes[nodeIndex - 1]?.type === 'group'\n\n            return <PaneMenuButtonItem isAfterGroup={isAfterGroup} key={node.key} node={node} />\n          })}\n        </Menu>\n      }\n      popover={CONTEXT_MENU_POPOVER_PROPS}\n    />\n  )\n}\n", "/**\n * @internal\n */\nexport const PANE_DEBUG = false\n\n/**\n * @internal\n */\nexport const PANE_COLLAPSED_WIDTH = 51\n\n/**\n * @internal\n */\nexport const PANE_DEFAULT_MIN_WIDTH = PANE_COLLAPSED_WIDTH * 4\n", "import {createContext} from 'react'\nimport {PaneContextValue} from './types'\n\n/**\n * @internal\n */\nexport const PaneContext = createContext<PaneContextValue | null>(null)\n", "import {Layer} from '@sanity/ui'\nimport React, {useCallback, useState} from 'react'\nimport styled from 'styled-components'\nimport {usePaneLayout} from './usePaneLayout'\n\nconst Root = styled(Layer)`\n  position: relative;\n  width: 1px;\n  min-width: 1px;\n\n  &:before {\n    content: '';\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    width: 1px;\n    background-color: var(--card-border-color);\n  }\n\n  &:not([data-disabled]) {\n    cursor: ew-resize;\n    width: 9px;\n    min-width: 9px;\n    margin: 0 -4px;\n\n    &:before {\n      left: 4px;\n    }\n\n    &:after {\n      content: '';\n      display: block;\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 9px;\n      bottom: 0;\n      background-color: var(--card-border-color);\n      opacity: 0;\n      transition: opacity 150ms;\n    }\n\n    &[data-dragging]:after,\n    &:hover:after {\n      opacity: 0.2;\n    }\n  }\n`\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport function PaneDivider({\n  disabled,\n  element,\n}: {\n  disabled?: boolean\n  element: HTMLElement | null\n}) {\n  const {resize} = usePaneLayout()\n  const [dragging, setDragging] = useState(false)\n\n  const handleMouseDown = useCallback(\n    (event: any) => {\n      if (!element) return\n\n      setDragging(true)\n\n      event.preventDefault()\n\n      const startX = event.pageX\n\n      resize('start', element, 0)\n\n      const handleMouseMove = (e: MouseEvent) => {\n        e.preventDefault()\n\n        const deltaX = e.pageX - startX\n\n        resize('move', element, deltaX)\n      }\n\n      const handleMouseUp = (e: MouseEvent) => {\n        e.preventDefault()\n\n        setDragging(false)\n\n        window.removeEventListener('mousemove', handleMouseMove)\n        window.removeEventListener('mouseup', handleMouseUp)\n\n        resize('end', element, 0)\n      }\n\n      window.addEventListener('mousemove', handleMouseMove)\n      window.addEventListener('mouseup', handleMouseUp)\n    },\n    [element, resize],\n  )\n\n  return (\n    <Root\n      data-disabled={disabled ? '' : undefined}\n      data-dragging={dragging ? '' : undefined}\n      onMouseDown={handleMouseDown}\n    />\n  )\n}\n", "import {BoundaryElementProvider, Card, CardProps, Code, Flex, useForwardedRef} from '@sanity/ui'\nimport React, {forwardRef, useMemo, useState, useCallback, useEffect} from 'react'\nimport styled from 'styled-components'\nimport {PANE_COLLAPSED_WIDTH, PANE_DEBUG, PANE_DEFAULT_MIN_WIDTH} from './constants'\nimport {PaneContext} from './PaneContext'\nimport {PaneDivider} from './PaneDivider'\nimport {usePaneLayout} from './usePaneLayout'\nimport {LegacyLayerProvider} from 'sanity'\n\ninterface PaneProps {\n  children?: React.ReactNode\n  currentMinWidth?: number\n  currentMaxWidth?: number\n  flex?: number\n  id: string\n  minWidth?: number\n  maxWidth?: number\n  selected?: boolean\n}\n\nconst Root = styled(Card)`\n  outline: none;\n\n  // NOTE: This will render a border to the right side of each pane\n  // without taking up physical space.\n  box-shadow: 1px 0 0 var(--card-border-color);\n`\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\n// eslint-disable-next-line complexity\nexport const Pane = forwardRef(function Pane(\n  props: PaneProps &\n    Omit<CardProps, 'as' | 'overflow'> &\n    Omit<React.HTMLProps<HTMLDivElement>, 'as' | 'height' | 'hidden' | 'id' | 'style'>,\n  ref: React.ForwardedRef<HTMLDivElement>,\n) {\n  const {\n    children,\n    currentMinWidth: currentMinWidthProp,\n    currentMaxWidth: currentMaxWidthProp,\n    flex: flexProp = 1,\n    id,\n    minWidth: minWidthProp,\n    maxWidth: maxWidthProp,\n    selected = false,\n    ...restProps\n  } = props\n  const [rootElement, setRootElement] = useState<HTMLDivElement | null>(null)\n  const {\n    collapse,\n    collapsed: layoutCollapsed,\n    expand,\n    expandedElement,\n    mount,\n    panes,\n  } = usePaneLayout()\n  const pane = panes.find((p) => p.element === rootElement)\n  const paneIndex = pane && panes.indexOf(pane)\n  const nextPane = typeof paneIndex === 'number' ? panes[paneIndex + 1] : undefined\n  const isLast = paneIndex === panes.length - 1\n  const expanded = expandedElement === rootElement\n  const collapsed = layoutCollapsed ? false : pane?.collapsed || false\n  const nextCollapsed = nextPane?.collapsed || false\n  const forwardedRef = useForwardedRef(ref)\n  const flex = pane?.flex ?? flexProp\n  const currentMinWidth = pane?.currentMinWidth ?? currentMinWidthProp\n  const currentMaxWidth = pane?.currentMaxWidth ?? currentMaxWidthProp\n\n  const setRef = useCallback(\n    (refValue: HTMLDivElement | null) => {\n      setRootElement(refValue)\n      forwardedRef.current = refValue\n    },\n    [forwardedRef],\n  )\n\n  useEffect(() => {\n    if (!rootElement) return undefined\n    return mount(rootElement, {\n      currentMinWidth: currentMinWidthProp,\n      currentMaxWidth: currentMaxWidthProp,\n      flex: flexProp,\n      id,\n      minWidth: minWidthProp,\n      maxWidth: maxWidthProp,\n    })\n  }, [\n    currentMinWidthProp,\n    currentMaxWidthProp,\n    flexProp,\n    id,\n    minWidthProp,\n    maxWidthProp,\n    mount,\n    rootElement,\n  ])\n\n  const handleCollapse = useCallback(() => {\n    if (!rootElement) return\n    collapse(rootElement)\n  }, [collapse, rootElement])\n\n  const handleExpand = useCallback(() => {\n    if (!rootElement) return\n    expand(rootElement)\n  }, [expand, rootElement])\n\n  const contextValue = useMemo(\n    () => ({\n      collapse: handleCollapse,\n      collapsed: layoutCollapsed ? false : collapsed,\n      expand: handleExpand,\n      index: paneIndex,\n      isLast,\n      rootElement,\n    }),\n    [collapsed, handleCollapse, handleExpand, isLast, layoutCollapsed, paneIndex, rootElement],\n  )\n\n  const minWidth = useMemo(() => {\n    if (layoutCollapsed) {\n      return undefined\n    }\n\n    if (collapsed) return PANE_COLLAPSED_WIDTH\n\n    if (currentMinWidth === 0) {\n      return minWidthProp || PANE_DEFAULT_MIN_WIDTH\n    }\n\n    if (isLast) {\n      return minWidthProp || PANE_DEFAULT_MIN_WIDTH\n    }\n\n    return currentMinWidth || minWidthProp || PANE_DEFAULT_MIN_WIDTH\n  }, [collapsed, currentMinWidth, isLast, layoutCollapsed, minWidthProp])\n\n  const maxWidth = useMemo(() => {\n    if (collapsed) return PANE_COLLAPSED_WIDTH\n\n    if (layoutCollapsed && isLast) {\n      return undefined\n    }\n\n    if (isLast) {\n      if (maxWidthProp) {\n        return currentMaxWidth ?? maxWidthProp\n      }\n\n      return undefined\n    }\n\n    return currentMaxWidth ?? maxWidthProp\n  }, [collapsed, currentMaxWidth, isLast, layoutCollapsed, maxWidthProp])\n\n  const hidden = layoutCollapsed && !isLast\n\n  const divider = useMemo(\n    () =>\n      !isLast &&\n      !layoutCollapsed && (\n        <LegacyLayerProvider zOffset=\"paneResizer\">\n          <PaneDivider disabled={collapsed || nextCollapsed} element={rootElement} />\n        </LegacyLayerProvider>\n      ),\n    [collapsed, isLast, layoutCollapsed, nextCollapsed, rootElement],\n  )\n\n  const style = useMemo(\n    () => ({\n      flex,\n      minWidth,\n      maxWidth: maxWidth === Infinity ? undefined : maxWidth,\n    }),\n    [flex, minWidth, maxWidth],\n  )\n\n  return (\n    <>\n      <LegacyLayerProvider zOffset=\"pane\">\n        <PaneContext.Provider value={contextValue}>\n          <Root\n            data-testid=\"pane\"\n            data-ui=\"Pane\"\n            tone=\"inherit\"\n            hidden={hidden}\n            id={id}\n            overflow={layoutCollapsed ? undefined : 'hidden'}\n            {...restProps}\n            data-pane-collapsed={collapsed ? '' : undefined}\n            data-pane-index={paneIndex}\n            data-pane-selected={selected ? '' : undefined}\n            ref={setRef}\n            style={style}\n          >\n            {PANE_DEBUG && (\n              <Card padding={4} tone={expanded ? 'primary' : 'caution'}>\n                <Code size={1}>\n                  {[\n                    `#${paneIndex}`,\n                    `collapsed=${collapsed}`,\n                    `currentMinWidth=${currentMinWidth}`,\n                    `currentMaxWidth=${currentMaxWidth}`,\n                    `flex=${flex}`,\n                    `minWidth=${minWidth}`,\n                    `maxWidth=${maxWidth}`,\n                  ].join('\\n')}\n                </Code>\n              </Card>\n            )}\n\n            <BoundaryElementProvider element={rootElement}>\n              {!hidden && (\n                <Flex direction=\"column\" height=\"fill\">\n                  {children}\n                </Flex>\n              )}\n            </BoundaryElementProvider>\n          </Root>\n        </PaneContext.Provider>\n      </LegacyLayerProvider>\n\n      {divider}\n    </>\n  )\n})\n", "import {useContext} from 'react'\nimport {PaneContext} from './PaneContext'\nimport {PaneContextValue} from './types'\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport function usePane(): PaneContextValue {\n  const pane = useContext(PaneContext)\n\n  if (!pane) {\n    throw new Error('Pane: missing context value')\n  }\n\n  return pane\n}\n", "import {Card} from '@sanity/ui'\nimport styled from 'styled-components'\n\nexport const Root = styled(Card)`\n  position: relative;\n  outline: none;\n`\n\nRoot.displayName = 'PaneContent__root'\n", "import {BoxOverflow} from '@sanity/ui'\nimport React, {forwardRef} from 'react'\nimport {usePane} from './usePane'\nimport {usePaneLayout} from './usePaneLayout'\nimport {Root} from './PaneContent.styles'\n\ninterface PaneContentProps {\n  as?: React.ElementType | keyof JSX.IntrinsicElements\n  overflow?: BoxOverflow\n  padding?: number | number[]\n}\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport const PaneContent = forwardRef(function PaneContent(\n  props: PaneContentProps & Omit<React.HTMLProps<HTMLDivElement>, 'as' | 'height' | 'ref'>,\n  ref: React.ForwardedRef<HTMLDivElement>,\n) {\n  const {as, children, overflow, padding, ...restProps} = props\n  const {collapsed} = usePane()\n  const {collapsed: layoutCollapsed} = usePaneLayout()\n\n  return (\n    <Root\n      data-testid=\"pane-content\"\n      forwardedAs={as}\n      {...restProps}\n      flex={1}\n      hidden={collapsed}\n      overflow={layoutCollapsed ? undefined : overflow}\n      padding={padding}\n      ref={ref}\n      tone=\"inherit\"\n    >\n      {children}\n    </Root>\n  )\n})\n", "import {Card, Layer} from '@sanity/ui'\nimport styled from 'styled-components'\n\nexport const Root = styled(Layer)`\n  position: sticky;\n  bottom: 0;\n\n  &:before {\n    content: '';\n    display: block;\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: -1px;\n    border-bottom: 1px solid var(--card-shadow-outline-color);\n  }\n`\n\nexport const RootCard = styled(Card)`\n  padding-bottom: env(safe-area-inset-bottom);\n`\n", "import {Box} from '@sanity/ui'\nimport React, {forwardRef} from 'react'\nimport {usePane} from './usePane'\nimport {Root, RootCard} from './PaneFooter.styles'\nimport {LegacyLayerProvider} from 'sanity'\n\ninterface PaneFooterProps {\n  children?: React.ReactNode\n  padding?: number | number[]\n}\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport const PaneFooter = forwardRef(function PaneFooter(\n  props: PaneFooterProps,\n  ref: React.ForwardedRef<HTMLDivElement>,\n) {\n  const {children, padding} = props\n  const {collapsed} = usePane()\n\n  return (\n    <LegacyLayerProvider zOffset=\"paneFooter\">\n      <Root data-testid=\"pane-footer\" hidden={collapsed} ref={ref}>\n        <RootCard tone=\"inherit\">\n          <Box padding={padding}>{children}</Box>\n        </RootCard>\n      </Root>\n    </LegacyLayerProvider>\n  )\n})\n", "import {Box, Flex, Layer, rgba, TextSkeleton, Text, Theme, Card} from '@sanity/ui'\nimport styled, {css} from 'styled-components'\n\nexport const Root = styled(Layer)`\n  line-height: 0;\n  position: sticky;\n  top: 0;\n\n  &:not([data-collapsed]):after {\n    content: '';\n    display: block;\n    position: absolute;\n    left: 0;\n    right: 0;\n    bottom: -1px;\n    border-bottom: 1px solid var(--card-shadow-outline-color);\n  }\n`\n\nexport const Layout = styled(Flex)`\n  transform-origin: calc(51px / 2);\n\n  [data-collapsed] > div > & {\n    transform: rotate(90deg);\n  }\n`\n\nexport const TitleCard = styled(Card)(({theme}: {theme: Theme}) => {\n  const {fg, bg} = theme.sanity.color.card.enabled\n\n  // Disable color updates on hover\n  return css`\n    background-color: ${bg};\n\n    [data-ui='Text'] {\n      color: ${fg};\n    }\n  `\n})\n\nexport const TitleTextSkeleton = styled(TextSkeleton)`\n  width: 66%;\n  max-width: 175px;\n`\n\nexport const TitleText = styled(Text)`\n  cursor: default;\n  outline: none;\n`\n\nexport const TabsBox = styled(Box)(({theme}: {theme: Theme}) => {\n  const {color, space} = theme.sanity\n\n  return css`\n    overflow: hidden;\n    overflow: clip;\n    position: relative;\n\n    & > div {\n      white-space: nowrap;\n      overflow: auto;\n      /* Hide scrollbars */\n      scrollbar-width: none;\n      &::-webkit-scrollbar {\n        width: 0;\n        height: 0;\n      }\n    }\n\n    /* right padding */\n    & > div:after {\n      content: '';\n      display: inline-block;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      width: ${space[3]}px;\n      height: 1px;\n    }\n\n    /* Gradient that makes it look like tabs disappear into nothing (looks nicer) */\n    &:after {\n      content: '';\n      display: block;\n      position: absolute;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      background: linear-gradient(to right, ${rgba(color.base.bg, 0)}, var(--card-bg-color));\n      width: ${space[3]}px;\n      pointer-events: none;\n    }\n  `\n})\n", "import {useElementRect, Box, Card, Flex, LayerProvider} from '@sanity/ui'\nimport React, {useMemo, useCallback, forwardRef} from 'react'\nimport {usePane} from './usePane'\nimport {Layout, Root, TabsBox, TitleCard, TitleTextSkeleton, TitleText} from './PaneHeader.styles'\nimport {LegacyLayerProvider} from 'sanity'\n\n/**\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport interface PaneHeaderProps {\n  actions?: React.ReactNode\n  backButton?: React.ReactNode\n  contentAfter?: React.ReactNode\n  loading?: boolean\n  subActions?: React.ReactNode\n  tabIndex?: number\n  tabs?: React.ReactNode\n  title: React.ReactNode\n}\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport const PaneHeader = forwardRef(function PaneHeader(\n  props: PaneHeaderProps,\n  ref: React.ForwardedRef<HTMLDivElement>,\n) {\n  const {actions, backButton, contentAfter, loading, subActions, tabs, tabIndex, title} = props\n  const {collapse, collapsed, expand, rootElement: paneElement} = usePane()\n  const paneRect = useElementRect(paneElement || null)\n\n  const layoutStyle = useMemo(\n    () => ({\n      width: collapsed ? paneRect?.height || window.innerHeight : undefined,\n    }),\n    [collapsed, paneRect],\n  )\n\n  const handleTitleClick = useCallback(() => {\n    if (collapsed) return\n    collapse()\n  }, [collapse, collapsed])\n\n  const handleLayoutClick = useCallback(() => {\n    if (!collapsed) return\n    expand()\n  }, [collapsed, expand])\n\n  const showTabsOrSubActions = Boolean(!collapsed && (tabs || subActions))\n\n  return (\n    <LayerProvider zOffset={100}>\n      <Root data-collapsed={collapsed ? '' : undefined} data-testid=\"pane-header\" ref={ref}>\n        <LegacyLayerProvider zOffset=\"paneHeader\">\n          <Card data-collapsed={collapsed ? '' : undefined} tone=\"inherit\">\n            <Layout onClick={handleLayoutClick} padding={2} sizing=\"border\" style={layoutStyle}>\n              {backButton && (\n                <Box flex=\"none\" padding={1}>\n                  {backButton}\n                </Box>\n              )}\n\n              <TitleCard\n                __unstable_focusRing\n                flex={1}\n                forwardedAs=\"button\"\n                marginRight={actions ? 1 : 0}\n                onClick={handleTitleClick}\n                paddingLeft={backButton ? 1 : 3}\n                paddingY={3}\n                tabIndex={tabIndex}\n              >\n                {loading && <TitleTextSkeleton animated radius={1} />}\n                {!loading && (\n                  <TitleText textOverflow=\"ellipsis\" weight=\"semibold\">\n                    {title}\n                  </TitleText>\n                )}\n              </TitleCard>\n\n              {actions && (\n                <Flex align=\"center\" hidden={collapsed}>\n                  <LegacyLayerProvider zOffset=\"paneHeader\">{actions}</LegacyLayerProvider>\n                </Flex>\n              )}\n            </Layout>\n\n            {showTabsOrSubActions && (\n              <Flex\n                align=\"center\"\n                hidden={collapsed}\n                overflow=\"auto\"\n                paddingBottom={3}\n                paddingX={3}\n                paddingTop={1}\n              >\n                <TabsBox flex={1} marginRight={subActions ? 3 : 0}>\n                  {tabs}\n                </TabsBox>\n\n                {subActions && subActions}\n              </Flex>\n            )}\n\n            {!collapsed && contentAfter && contentAfter}\n          </Card>\n        </LegacyLayerProvider>\n      </Root>\n    </LayerProvider>\n  )\n})\n", "import React, {MouseEvent, useCallback, useId} from 'react'\nimport {ButtonProps, Menu, MenuButton, Text} from '@sanity/ui'\nimport {UnknownIcon} from '@sanity/icons'\nimport {Intent} from '../../structureBuilder'\nimport {_PaneMenuGroup, _PaneMenuItem} from './types'\nimport {PaneMenuButtonItem} from './PaneMenuButtonItem'\nimport {TooltipOfDisabled, StatusButton} from 'sanity'\nimport {useIntentLink} from 'sanity/router'\n\nexport interface PaneHeaderActionButtonProps {\n  node: _PaneMenuItem | _PaneMenuGroup\n  padding?: ButtonProps['padding']\n}\n\nexport function PaneHeaderActionButton(props: PaneHeaderActionButtonProps) {\n  const {node, padding} = props\n\n  if (node.type === 'item') {\n    return <PaneHeaderMenuItemActionButton node={node} padding={padding} />\n  }\n\n  if (node.type === 'group') {\n    return <PaneHeaderMenuGroupActionButton node={node} padding={padding} />\n  }\n\n  console.warn('unknown menu node (expected `type: \"item\" | \"group\"`):', node)\n\n  return null\n}\n\nexport interface PaneHeaderMenuItemActionButtonProps {\n  node: _PaneMenuItem\n  padding?: ButtonProps['padding']\n}\n\nexport function PaneHeaderMenuItemActionButton(props: PaneHeaderMenuItemActionButtonProps) {\n  const {node, padding} = props\n\n  if (node.intent) {\n    return <PaneHeaderActionIntentButton {...props} intent={node.intent} />\n  }\n\n  const disabledTooltipContent = typeof node.disabled === 'object' && (\n    <Text size={1}>{node.disabled.reason}</Text>\n  )\n\n  return (\n    <TooltipOfDisabled content={disabledTooltipContent} placement=\"bottom\">\n      <StatusButton\n        disabled={Boolean(node.disabled)}\n        hotkey={node.hotkey?.split('+')}\n        icon={node.icon}\n        label={disabledTooltipContent ? undefined : node.title}\n        // eslint-disable-next-line react/jsx-handler-names\n        onClick={node.onAction}\n        padding={padding}\n        selected={node.selected}\n        tone={node.tone}\n      />\n    </TooltipOfDisabled>\n  )\n}\n\nfunction PaneHeaderActionIntentButton(props: {\n  intent: Intent\n  node: _PaneMenuItem\n  padding?: ButtonProps['padding']\n}) {\n  const {intent, node, padding} = props\n  const disabledTooltipContent = typeof node.disabled === 'object' && (\n    <Text size={1}>{node.disabled.reason}</Text>\n  )\n  const intentLink = useIntentLink({intent: intent.type, params: intent.params})\n\n  const handleClick = useCallback(\n    (event: MouseEvent<HTMLButtonElement>) => {\n      intentLink.onClick(event)\n      node.onAction()\n    },\n    [intentLink, node],\n  )\n\n  return (\n    <TooltipOfDisabled content={disabledTooltipContent} placement=\"bottom\">\n      <StatusButton\n        as=\"a\"\n        disabled={Boolean(node.disabled)}\n        hotkey={node.hotkey?.split('+')}\n        href={intentLink.href}\n        icon={node.icon}\n        label={disabledTooltipContent ? undefined : node.title}\n        onClick={handleClick}\n        padding={padding}\n        selected={node.selected}\n        tone={node.tone}\n      />\n    </TooltipOfDisabled>\n  )\n}\n\nexport interface PaneHeaderMenuGroupActionButtonProps {\n  node: _PaneMenuGroup\n  padding?: ButtonProps['padding']\n}\n\nfunction PaneHeaderMenuGroupActionButton(props: PaneHeaderMenuGroupActionButtonProps) {\n  const {node, padding} = props\n\n  return (\n    <MenuButton\n      button={\n        <StatusButton\n          disabled={node.disabled}\n          icon={node.icon ?? UnknownIcon}\n          label={node.title}\n          padding={padding}\n        />\n      }\n      id={useId()}\n      menu={\n        <Menu>\n          {node.children.map((child, idx) => {\n            return (\n              <PaneMenuButtonItem\n                disabled={Boolean(node.disabled)}\n                isAfterGroup={node.children[idx - 1]?.type === 'group'}\n                key={child.key}\n                node={child}\n              />\n            )\n          })}\n        </Menu>\n      }\n    />\n  )\n}\n", "import {Card} from '@sanity/ui'\nimport styled from 'styled-components'\n\nexport const Root = styled(Card)`\n  transition: opacity 200ms;\n  position: relative;\n  z-index: 1;\n  padding-left: env(safe-area-inset-left);\n  padding-right: env(safe-area-inset-right);\n  opacity: 0;\n\n  &:not([hidden]) {\n    display: flex;\n  }\n\n  &:not([data-collapsed]) {\n    overflow: auto;\n  }\n\n  &[data-mounted] {\n    opacity: 1;\n  }\n\n  &[data-resizing] {\n    pointer-events: none;\n  }\n`\n", "/* eslint-disable camelcase */\n\nimport {negate} from 'lodash'\nimport {_PaneMenuGroup, _PaneMenuItem, _PaneMenuNode} from './components/pane/types'\nimport {PaneMenuItem, PaneMenuItemGroup} from './types'\nimport {DocumentFieldActionNode} from 'sanity'\n\nexport function isMenuNodeButton(node: _PaneMenuNode): node is _PaneMenuItem | _PaneMenuGroup {\n  return (node.type === 'item' || node.type === 'group') && node.renderAsButton\n}\n\nexport const isNotMenuNodeButton = negate(isMenuNodeButton)\n\nexport function resolveMenuNodes(params: {\n  actionHandler: (item: PaneMenuItem) => void\n  fieldActions?: DocumentFieldActionNode[]\n  menuItems: PaneMenuItem[]\n  menuItemGroups: PaneMenuItemGroup[]\n}): _PaneMenuNode[] {\n  const {fieldActions = [], menuItems, menuItemGroups} = params\n\n  const nodes: _PaneMenuNode[] = []\n\n  let keyOffset = 0\n\n  for (let i = 0; i < fieldActions.length; i += 1) {\n    const a = fieldActions[i]\n\n    nodes.push(mapFieldActionToPaneMenuNode(a, `${i}-${a.type}`))\n  }\n\n  keyOffset += nodes.length\n\n  const groups: _PaneMenuGroup[] = []\n\n  for (const itemGroup of menuItemGroups) {\n    const group = groups.find((g) => g.key === itemGroup.id)\n\n    if (!group) {\n      groups.push({\n        type: 'group',\n        key: itemGroup.id,\n\n        children: [],\n        expanded: true,\n        renderAsButton: false,\n        title: itemGroup.title,\n      })\n    }\n  }\n\n  const ungroupedItems: _PaneMenuItem[] = []\n\n  for (let i = 0; i < menuItems.length; i += 1) {\n    const item = menuItems[i]\n\n    let group = item.group && groups.find((g) => g.key === item.group)\n\n    if (item.group && !group) {\n      group = {\n        type: 'group',\n        key: item.group,\n\n        expanded: true,\n        icon: item.icon,\n        title: item.group,\n        children: [],\n        renderAsButton: false,\n      }\n      groups.push(group)\n    }\n\n    if (group) {\n      group.children.push({\n        type: 'item',\n        key: `${keyOffset + i}-item`,\n\n        hotkey: item.shortcut,\n        icon: item.icon,\n        onAction: () => params.actionHandler(item),\n        renderAsButton: item.showAsAction ?? false,\n        selected: item.selected,\n        title: item.title,\n        tone: item.tone,\n      })\n    } else {\n      ungroupedItems.push({\n        type: 'item',\n        key: `${keyOffset + i}-item`,\n\n        hotkey: item.shortcut,\n        icon: item.icon,\n        onAction: () => params.actionHandler(item),\n        renderAsButton: item.showAsAction ?? false,\n        selected: item.selected,\n        title: item.title,\n        tone: item.tone,\n      })\n    }\n  }\n\n  return [...ungroupedItems, ...groups, ...nodes]\n}\n\nfunction mapFieldActionToPaneMenuNode(a: DocumentFieldActionNode, key: string): _PaneMenuNode {\n  if (a.type === 'divider') {\n    return {\n      type: 'divider',\n      key,\n    }\n  }\n\n  if (a.type === 'group') {\n    return {\n      type: 'group',\n      key,\n\n      children: a.children.map((child, childIdx) =>\n        mapFieldActionToPaneMenuNode(child, `${key}-${childIdx}-${child.type}`),\n      ),\n      disabled: a.disabled,\n      expanded: a.expanded ?? true,\n      icon: a.icon,\n      title: a.title,\n      renderAsButton: a.renderAsButton ?? false,\n    }\n  }\n\n  return {\n    type: 'item',\n    key,\n\n    disabled: a.disabled,\n    icon: a.icon,\n    iconRight: a.iconRight,\n    onAction: a.onAction,\n    renderAsButton: a.renderAsButton ?? false,\n    selected: a.selected,\n    title: a.title,\n    tone: a.tone,\n  }\n}\n", "import {Button} from '@sanity/ui'\nimport React, {forwardRef, useMemo} from 'react'\nimport {PaneMenuItem} from '../types'\nimport {IntentLink} from 'sanity/router'\n\ntype RouterIntent = NonNullable<PaneMenuItem['intent']>\n\nexport const IntentButton = forwardRef(function IntentButton(\n  props: {intent: RouterIntent} & Omit<React.ComponentProps<typeof Button>, 'as' | 'href' | 'type'>,\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  const {intent, ...restProps} = props\n\n  const Link = useMemo(\n    () =>\n      // eslint-disable-next-line @typescript-eslint/no-shadow\n      forwardRef(function Link(\n        linkProps: {children: React.ReactNode},\n        linkRef: React.ForwardedRef<HTMLAnchorElement>,\n      ) {\n        return (\n          <IntentLink {...linkProps} intent={intent.type} params={intent.params} ref={linkRef} />\n        )\n      }),\n    [intent],\n  )\n\n  return props.disabled ? (\n    <Button {...props} as=\"a\" role=\"link\" aria-disabled=\"true\" />\n  ) : (\n    <Button\n      {...restProps}\n      as={Link}\n      data-as=\"a\"\n      ref={ref as React.ForwardedRef<HTMLButtonElement>}\n    />\n  )\n})\n", "import {Tooltip, Text, Box} from '@sanity/ui'\nimport React from 'react'\nimport {useCurrentUser, InsufficientPermissionsMessage} from 'sanity'\n\ninterface InsufficientPermissionsMessageTooltipProps {\n  reveal: boolean\n  loading: boolean\n  children: React.ReactNode\n}\n\nexport function InsufficientPermissionsMessageTooltip({\n  reveal,\n  loading,\n  children,\n}: InsufficientPermissionsMessageTooltipProps) {\n  const currentUser = useCurrentUser()\n\n  if (!reveal) {\n    return <>{children}</>\n  }\n\n  return (\n    <Tooltip\n      content={\n        loading ? (\n          <Box padding={2}>\n            <Text>Loading…</Text>\n          </Box>\n        ) : (\n          <InsufficientPermissionsMessage currentUser={currentUser} />\n        )\n      }\n      portal\n    >\n      {/* this wrapping div is to allow mouse events */}\n      {/* while the child element is disabled */}\n      <div>{children}</div>\n    </Tooltip>\n  )\n}\n", "import {ComposeIcon} from '@sanity/icons'\nimport React, {useMemo, forwardRef} from 'react'\nimport {Box, Button, Label, Menu, MenuButton, MenuItem, PopoverProps} from '@sanity/ui'\nimport {Schema} from '@sanity/types'\nimport {IntentButton} from '../IntentButton'\nimport {InsufficientPermissionsMessageTooltip} from './InsufficientPermissionsMessageTooltip'\nimport {IntentLink} from 'sanity/router'\nimport {\n  useTemplatePermissions,\n  TemplatePermissionsResult,\n  Template,\n  InitialValueTemplateItem,\n  useSchema,\n  useTemplates,\n} from 'sanity'\n\nexport type PaneHeaderIntentProps = React.ComponentProps<typeof IntentButton>['intent']\n\nconst POPOVER_PROPS: PopoverProps = {\n  constrainSize: true,\n  placement: 'bottom',\n  portal: true,\n}\n\nconst getIntent = (\n  schema: Schema,\n  templates: Template[],\n  item: InitialValueTemplateItem,\n): PaneHeaderIntentProps | null => {\n  const typeName = templates.find((t) => t.id === item.templateId)?.schemaType\n  if (!typeName) return null\n\n  const baseParams = {\n    template: item.templateId,\n    type: typeName,\n    id: item.initialDocumentId,\n  }\n\n  return {\n    type: 'create',\n    params: item.parameters ? [baseParams, item.parameters] : baseParams,\n  }\n}\n\ninterface PaneHeaderCreateButtonProps {\n  templateItems: InitialValueTemplateItem[]\n}\n\nexport function PaneHeaderCreateButton({templateItems}: PaneHeaderCreateButtonProps) {\n  const schema = useSchema()\n  const templates = useTemplates()\n\n  const [templatePermissions, isTemplatePermissionsLoading] = useTemplatePermissions({\n    templateItems,\n  })\n\n  const nothingGranted = useMemo(() => {\n    return (\n      !isTemplatePermissionsLoading &&\n      templatePermissions?.every((permission) => !permission.granted)\n    )\n  }, [isTemplatePermissionsLoading, templatePermissions])\n\n  const permissionsById = useMemo(() => {\n    if (!templatePermissions) return {}\n    return templatePermissions.reduce<Record<string, TemplatePermissionsResult | undefined>>(\n      (acc, permission) => {\n        acc[permission.id] = permission\n        return acc\n      },\n      {},\n    )\n  }, [templatePermissions])\n\n  if (nothingGranted) {\n    return (\n      <InsufficientPermissionsMessageTooltip reveal loading={isTemplatePermissionsLoading}>\n        <Button\n          aria-label=\"Insufficient permissions\"\n          icon={ComposeIcon}\n          mode=\"bleed\"\n          disabled\n          data-testid=\"action-intent-button\"\n        />\n      </InsufficientPermissionsMessageTooltip>\n    )\n  }\n\n  if (templateItems.length === 1) {\n    const firstItem = templateItems[0]\n    const permissions = permissionsById[firstItem.id]\n    const disabled = !permissions?.granted\n    const intent = getIntent(schema, templates, firstItem)\n    if (!intent) return null\n\n    return (\n      <InsufficientPermissionsMessageTooltip\n        reveal={disabled}\n        loading={isTemplatePermissionsLoading}\n      >\n        <IntentButton\n          aria-label={firstItem.title}\n          icon={firstItem.icon || ComposeIcon}\n          intent={intent}\n          mode=\"bleed\"\n          disabled={disabled}\n          data-testid=\"action-intent-button\"\n        />\n      </InsufficientPermissionsMessageTooltip>\n    )\n  }\n\n  return (\n    <MenuButton\n      button={<Button icon={ComposeIcon} mode=\"bleed\" data-testid=\"multi-action-intent-button\" />}\n      id=\"create-menu\"\n      menu={\n        <Menu>\n          <Box paddingX={3} paddingTop={3} paddingBottom={2}>\n            <Label muted>Create</Label>\n          </Box>\n\n          {templateItems.map((item, itemIndex) => {\n            const permissions = permissionsById[item.id]\n            const disabled = !permissions?.granted\n            const intent = getIntent(schema, templates, item)\n            const template = templates.find((t) => t.id === item.templateId)\n            if (!template || !intent) return null\n\n            const Link = forwardRef((linkProps, linkRef: React.ForwardedRef<never>) =>\n              disabled ? (\n                <button type=\"button\" disabled {...linkProps} ref={linkRef} />\n              ) : (\n                <IntentLink\n                  {...linkProps}\n                  intent={intent.type}\n                  params={intent.params}\n                  ref={linkRef}\n                />\n              ),\n            )\n\n            Link.displayName = 'Link'\n\n            return (\n              <InsufficientPermissionsMessageTooltip\n                key={item.id}\n                reveal={disabled}\n                loading={isTemplatePermissionsLoading}\n              >\n                <MenuItem\n                  as={Link}\n                  data-as={disabled ? 'button' : 'a'}\n                  text={item.title || template.title}\n                  aria-label={disabled ? 'Insufficient permissions' : item.title || template.title}\n                  disabled={disabled}\n                  data-testid={`action-intent-button-${itemIndex}`}\n                />\n              </InsufficientPermissionsMessageTooltip>\n            )\n          })}\n        </Menu>\n      }\n      popover={POPOVER_PROPS}\n    />\n  )\n}\n", "import {Flex} from '@sanity/ui'\nimport {uniqBy} from 'lodash'\nimport React, {memo, useCallback, useMemo} from 'react'\nimport {isMenuNodeButton, isNotMenuNodeButton, resolveMenuNodes} from '../../menuNodes'\nimport {DeskToolPaneActionHandler, PaneMenuItem, PaneMenuItemGroup} from '../../types'\nimport {PaneContextMenuButton} from '../pane/PaneContextMenuButton'\nimport {PaneHeaderActionButton} from '../pane/PaneHeaderActionButton'\nimport {PaneHeaderCreateButton} from './PaneHeaderCreateButton'\nimport {useTemplates, InitialValueTemplateItem, EMPTY_ARRAY, EMPTY_OBJECT} from 'sanity'\n\nfunction isNonNullable<T>(value: T): value is NonNullable<T> {\n  return value !== null && value !== undefined\n}\n\n/**\n * hashes an object to a string where the order of the keys don't matter\n */\nconst hashObject = (value: unknown) => {\n  const sortObject = (v: unknown): unknown => {\n    if (typeof v !== 'object' || !v) return v\n    if (Array.isArray(v)) return v.map(sortObject)\n    return Object.entries(v).sort(([keyA], [keyB]) => keyA.localeCompare(keyB, 'en'))\n  }\n\n  const normalize = (v: unknown) => JSON.parse(JSON.stringify(v))\n\n  return JSON.stringify(sortObject(normalize(value)))\n}\n\ninterface PaneHeaderActionsProps {\n  initialValueTemplateItems?: InitialValueTemplateItem[]\n  menuItems?: PaneMenuItem[]\n  menuItemGroups?: PaneMenuItemGroup[]\n  actionHandlers?: Record<string, DeskToolPaneActionHandler>\n}\n\nexport const PaneHeaderActions = memo(function PaneHeaderActions(props: PaneHeaderActionsProps) {\n  const {\n    initialValueTemplateItems: initialValueTemplateItemsFromStructure = EMPTY_ARRAY,\n    menuItems = EMPTY_ARRAY,\n    menuItemGroups = EMPTY_ARRAY,\n    actionHandlers = EMPTY_OBJECT as Record<string, DeskToolPaneActionHandler>,\n  } = props\n\n  const templates = useTemplates()\n\n  const handleAction = useCallback(\n    (item: PaneMenuItem) => {\n      if (typeof item.action === 'string' && !(item.action in actionHandlers)) {\n        console.warn('No handler for action:', item.action)\n        return false\n      }\n\n      const handler =\n        // eslint-disable-next-line no-nested-ternary\n        typeof item.action === 'function'\n          ? item.action\n          : typeof item.action === 'string'\n          ? actionHandlers[item.action]\n          : null\n\n      if (handler) {\n        handler(item.params as Record<string, string>)\n        return true\n      }\n\n      return false\n    },\n    [actionHandlers],\n  )\n\n  const menuNodes = useMemo(\n    () =>\n      resolveMenuNodes({\n        actionHandler: handleAction,\n        menuItemGroups,\n        menuItems: menuItems\n          // remove items with `create` intents because those will get combined\n          // into one action button (see `initialValueTemplateItemFromMenuItems`)\n          .filter((item) => item.intent?.type !== 'create'),\n      }),\n    [handleAction, menuItemGroups, menuItems],\n  )\n\n  const actionNodes = useMemo(() => menuNodes.filter(isMenuNodeButton), [menuNodes])\n  const contextMenuNodes = useMemo(() => menuNodes.filter(isNotMenuNodeButton), [menuNodes])\n\n  const initialValueTemplateItemFromMenuItems = useMemo(() => {\n    return menuItems\n      .map((item, menuItemIndex) => {\n        if (item.intent?.type !== 'create') return null\n\n        const {params} = item.intent\n        if (!params) return null\n\n        const intentParams = Array.isArray(params) ? params[0] : params\n        const templateParams = Array.isArray(params) ? params[1] : undefined\n\n        // fallback to the schema type name as the template ID.\n        // by default, the initial template values are populated from every\n        // document type in the schema\n        const templateId = intentParams.template || intentParams.type\n        if (!templateId) return null\n\n        // eslint-disable-next-line max-nested-callbacks\n        const template = templates.find((t) => t.id === templateId)\n        // the template doesn't exist then the action might be disabled\n        if (!template) return null\n\n        const initialDocumentId = intentParams.id\n\n        return {\n          item,\n          template,\n          templateParams,\n          menuItemIndex,\n          initialDocumentId,\n        }\n      })\n      .filter(isNonNullable)\n      .map(({initialDocumentId, item, template, menuItemIndex, templateParams}) => {\n        const initialValueTemplateItem: InitialValueTemplateItem = {\n          id: `menuItem${menuItemIndex}`,\n          initialDocumentId,\n          templateId: template.id,\n          type: 'initialValueTemplateItem',\n          title: item.title || template.title,\n          icon: item.icon as InitialValueTemplateItem['icon'],\n          description: template.description,\n          parameters: templateParams,\n          schemaType: template.schemaType,\n        }\n\n        return initialValueTemplateItem\n      })\n  }, [menuItems, templates])\n\n  const combinedInitialValueTemplates = useMemo(() => {\n    // this de-dupes create actions\n    return uniqBy(\n      [...initialValueTemplateItemFromMenuItems, ...initialValueTemplateItemsFromStructure],\n      (item) => hashObject([item.initialDocumentId, item.templateId, item.parameters]),\n    )\n  }, [initialValueTemplateItemFromMenuItems, initialValueTemplateItemsFromStructure])\n\n  return (\n    <Flex gap={1}>\n      {combinedInitialValueTemplates.length > 0 && (\n        <PaneHeaderCreateButton templateItems={combinedInitialValueTemplates} />\n      )}\n\n      {actionNodes.map((node) => (\n        <PaneHeaderActionButton key={node.key} node={node} />\n      ))}\n\n      {contextMenuNodes.length > 0 && <PaneContextMenuButton nodes={contextMenuNodes} />}\n    </Flex>\n  )\n})\n", "import {\n  ValidationMarker,\n  Path,\n  SanityDocument,\n  ObjectSchemaType,\n  SanityDocumentLike,\n} from '@sanity/types'\nimport {createContext} from 'react'\nimport {View} from '../../structureBuilder'\nimport {PaneMenuItem, PaneMenuItemGroup} from '../../types'\nimport {TimelineMode} from './types'\nimport {\n  DocumentActionComponent,\n  DocumentBadgeComponent,\n  DocumentFieldAction,\n  DocumentFormNode,\n  DocumentInspector,\n  DocumentLanguageFilterComponent,\n  DocumentPermission,\n  EditStateFor,\n  PatchEvent,\n  PermissionCheckResult,\n  StateTree,\n  TimelineStore,\n} from 'sanity'\n\n/** @internal */\nexport interface DocumentPaneContextValue {\n  actions: DocumentActionComponent[] | null\n  activeViewId: string | null\n  badges: DocumentBadgeComponent[] | null\n  changesOpen: boolean\n  closeInspector: (inspectorName?: string) => void\n  collapsedFieldSets: StateTree<boolean> | undefined\n  collapsedPaths: StateTree<boolean> | undefined\n  compareValue: Partial<SanityDocument> | null\n  connectionState: 'connecting' | 'reconnecting' | 'connected'\n  displayed: Partial<SanityDocument> | null\n  documentId: string\n  documentIdRaw: string\n  documentType: string\n  editState: EditStateFor | null\n  fieldActions: DocumentFieldAction[]\n  focusPath: Path\n  index: number\n  inspectOpen: boolean\n  inspector: DocumentInspector | null\n  inspectors: DocumentInspector[]\n  menuItemGroups: PaneMenuItemGroup[]\n  menuItems: PaneMenuItem[]\n  onBlur: (blurredPath: Path) => void\n  onChange: (event: PatchEvent) => void\n  onFocus: (pathOrEvent: Path) => void\n  onHistoryClose: () => void\n  onHistoryOpen: () => void\n  onInspectClose: () => void\n  onKeyUp: (event: React.KeyboardEvent<HTMLDivElement>) => void\n  onMenuAction: (item: PaneMenuItem) => void\n  onPaneClose: () => void\n  onPaneSplit?: () => void\n  onPathOpen: (path: Path) => void\n  onSetActiveFieldGroup: (path: Path, groupName: string) => void\n  onSetCollapsedPath: (path: Path, expanded: boolean) => void\n  onSetCollapsedFieldSet: (path: Path, expanded: boolean) => void\n  openInspector: (inspectorName: string, paneParams?: Record<string, string>) => void\n  paneKey: string\n  previewUrl?: string | null\n  ready: boolean\n  schemaType: ObjectSchemaType\n  setTimelineMode: (mode: TimelineMode) => void\n  setTimelineRange(since: string | null, rev: string | null): void\n  setIsDeleting: (state: boolean) => void\n  source?: string\n  timelineError: Error | null\n  timelineMode: TimelineMode\n  timelineStore: TimelineStore\n  title: string | null\n  validation: ValidationMarker[]\n  value: SanityDocumentLike\n  views: View[]\n  formState: DocumentFormNode | null\n  permissions?: PermissionCheckResult | null\n  isDeleting: boolean\n  isDeleted: boolean\n  isPermissionsLoading: boolean\n  unstable_languageFilter: DocumentLanguageFilterComponent[]\n}\n\n/** @internal */\nexport const DocumentPaneContext = createContext<DocumentPaneContextValue | null>(null)\n", "import {useContext} from 'react'\nimport {DocumentPaneContext, DocumentPaneContextValue} from './DocumentPaneContext'\n\n/** @internal */\nexport function useDocumentPane(): DocumentPaneContextValue {\n  const documentPane = useContext(DocumentPaneContext)\n\n  if (!documentPane) {\n    throw new Error('DocumentPane: missing context value')\n  }\n\n  return documentPane\n}\n", "/* eslint-disable import/no-extraneous-dependencies */\n\nimport {TrashIcon} from '@sanity/icons'\nimport React, {useCallback, useState} from 'react'\nimport {ConfirmDeleteDialog} from '../components'\nimport {\n  DocumentActionComponent,\n  InsufficientPermissionsMessage,\n  useCurrentUser,\n  useDocumentOperation,\n  useDocumentPairPermissions,\n} from 'sanity'\nimport {useDocumentPane} from '../panes/document/useDocumentPane'\n\nconst DISABLED_REASON_TITLE = {\n  NOTHING_TO_DELETE: 'This document doesn’t yet exist or is already deleted',\n}\n\n/** @internal */\nexport const DeleteAction: DocumentActionComponent = ({id, type, draft, onComplete}) => {\n  const {setIsDeleting: paneSetIsDeleting} = useDocumentPane()\n  const {delete: deleteOp} = useDocumentOperation(id, type)\n  const [isDeleting, setIsDeleting] = useState(false)\n  const [isConfirmDialogOpen, setConfirmDialogOpen] = useState(false)\n\n  const handleCancel = useCallback(() => {\n    setConfirmDialogOpen(false)\n    onComplete()\n  }, [onComplete])\n\n  const handleConfirm = useCallback(() => {\n    setIsDeleting(true)\n    setConfirmDialogOpen(false)\n    paneSetIsDeleting(true)\n    deleteOp.execute()\n    onComplete()\n  }, [deleteOp, onComplete, paneSetIsDeleting])\n\n  const handle = useCallback(() => {\n    setConfirmDialogOpen(true)\n  }, [])\n\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'delete',\n  })\n\n  const currentUser = useCurrentUser()\n\n  if (!isPermissionsLoading && !permissions?.granted) {\n    return {\n      tone: 'critical',\n      icon: TrashIcon,\n      disabled: true,\n      label: 'Delete',\n      title: (\n        <InsufficientPermissionsMessage\n          operationLabel=\"delete this document\"\n          currentUser={currentUser}\n        />\n      ),\n    }\n  }\n\n  return {\n    tone: 'critical',\n    icon: TrashIcon,\n    disabled: isDeleting || Boolean(deleteOp.disabled) || isPermissionsLoading,\n    title:\n      (deleteOp.disabled &&\n        DISABLED_REASON_TITLE[deleteOp.disabled as keyof typeof DISABLED_REASON_TITLE]) ||\n      '',\n    label: isDeleting ? 'Deleting…' : 'Delete',\n    shortcut: 'Ctrl+Alt+D',\n    onHandle: handle,\n    dialog: isConfirmDialogOpen && {\n      type: 'custom',\n      component: (\n        <ConfirmDeleteDialog\n          action=\"delete\"\n          id={draft?._id || id}\n          type={type}\n          onCancel={handleCancel}\n          onConfirm={handleConfirm}\n        />\n      ),\n    },\n  }\n}\n\nDeleteAction.action = 'delete'\n", "/* eslint-disable import/no-extraneous-dependencies */\n\nimport {ResetIcon} from '@sanity/icons'\nimport React, {useCallback, useMemo, useState} from 'react'\nimport {\n  DocumentActionComponent,\n  DocumentActionDialogProps,\n  InsufficientPermissionsMessage,\n  useCurrentUser,\n  useDocumentOperation,\n  useDocumentPairPermissions,\n} from 'sanity'\n\nconst DISABLED_REASON_TITLE = {\n  NO_CHANGES: 'This document has no unpublished changes',\n  NOT_PUBLISHED: 'This document is not published',\n}\n\n/** @internal */\nexport const DiscardChangesAction: DocumentActionComponent = ({\n  id,\n  type,\n  published,\n  liveEdit,\n  onComplete,\n}) => {\n  const {discardChanges} = useDocumentOperation(id, type)\n  const [isConfirmDialogOpen, setConfirmDialogOpen] = useState(false)\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'discardDraft',\n  })\n  const currentUser = useCurrentUser()\n\n  const handleConfirm = useCallback(() => {\n    discardChanges.execute()\n    onComplete()\n  }, [discardChanges, onComplete])\n\n  const handle = useCallback(() => {\n    setConfirmDialogOpen(true)\n  }, [])\n\n  const dialog: DocumentActionDialogProps | false = useMemo(\n    () =>\n      isConfirmDialogOpen && {\n        type: 'confirm',\n        tone: 'critical',\n        onCancel: onComplete,\n        onConfirm: handleConfirm,\n        message: <>Are you sure you want to discard all changes since last published?</>,\n      },\n    [handleConfirm, isConfirmDialogOpen, onComplete],\n  )\n\n  if (!published || liveEdit) {\n    return null\n  }\n\n  if (!isPermissionsLoading && !permissions?.granted) {\n    return {\n      tone: 'critical',\n      icon: ResetIcon,\n      disabled: true,\n      label: 'Discard changes',\n      title: (\n        <InsufficientPermissionsMessage\n          operationLabel=\"discard changes in this document\"\n          currentUser={currentUser}\n        />\n      ),\n    }\n  }\n\n  return {\n    tone: 'critical',\n    icon: ResetIcon,\n    disabled: Boolean(discardChanges.disabled) || isPermissionsLoading,\n    title:\n      (discardChanges.disabled &&\n        DISABLED_REASON_TITLE[discardChanges.disabled as keyof typeof DISABLED_REASON_TITLE]) ||\n      '',\n    label: 'Discard changes',\n    onHandle: handle,\n    dialog,\n  }\n}\n\nDiscardChangesAction.action = 'discardChanges'\n", "import {CopyIcon} from '@sanity/icons'\nimport {uuid} from '@sanity/uuid'\nimport React, {useCallback, useState} from 'react'\nimport {useRouter} from 'sanity/router'\nimport {\n  DocumentActionComponent,\n  InsufficientPermissionsMessage,\n  useDocumentPairPermissions,\n  useDocumentOperation,\n  useCurrentUser,\n} from 'sanity'\n\nconst DISABLED_REASON_TITLE = {\n  NOTHING_TO_DUPLICATE: 'This document doesn’t yet exist so there‘s nothing to duplicate',\n}\n\n/** @internal */\nexport const DuplicateAction: DocumentActionComponent = ({id, type, onComplete}) => {\n  const {duplicate} = useDocumentOperation(id, type)\n  const {navigateIntent} = useRouter()\n  const [isDuplicating, setDuplicating] = useState(false)\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'duplicate',\n  })\n\n  const currentUser = useCurrentUser()\n\n  const handle = useCallback(() => {\n    const dupeId = uuid()\n\n    setDuplicating(true)\n    duplicate.execute(dupeId)\n    navigateIntent('edit', {id: dupeId, type})\n    onComplete()\n  }, [duplicate, navigateIntent, onComplete, type])\n\n  if (!isPermissionsLoading && !permissions?.granted) {\n    return {\n      icon: CopyIcon,\n      disabled: true,\n      label: 'Duplicate',\n      title: (\n        <InsufficientPermissionsMessage\n          operationLabel=\"duplicate this document\"\n          currentUser={currentUser}\n        />\n      ),\n    }\n  }\n\n  return {\n    icon: CopyIcon,\n    disabled: isDuplicating || Boolean(duplicate.disabled) || isPermissionsLoading,\n    label: isDuplicating ? 'Duplicating…' : 'Duplicate',\n    title:\n      (duplicate.disabled &&\n        DISABLED_REASON_TITLE[duplicate.disabled as keyof typeof DISABLED_REASON_TITLE]) ||\n      '',\n    onHandle: handle,\n  }\n}\n\nDuplicateAction.action = 'duplicate'\n", "import {RestoreIcon} from '@sanity/icons'\nimport React, {useCallback, useEffect, useMemo, useRef, useState} from 'react'\nimport {\n  DocumentActionComponent,\n  DocumentActionDialogProps,\n  useDocumentOperation,\n  useDocumentOperationEvent,\n} from 'sanity'\nimport {useRouter} from 'sanity/router'\n\n/** @internal */\nexport const HistoryRestoreAction: DocumentActionComponent = ({id, type, revision, onComplete}) => {\n  const {restore} = useDocumentOperation(id, type)\n  const event = useDocumentOperationEvent(id, type)\n  const {navigateIntent} = useRouter()\n  const prevEvent = useRef(event)\n  const [isConfirmDialogOpen, setConfirmDialogOpen] = useState(false)\n\n  const handleConfirm = useCallback(() => {\n    restore.execute(revision!)\n    onComplete()\n  }, [restore, revision, onComplete])\n\n  /**\n   * If the restore operation is successful, navigate to the document edit view\n   */\n  useEffect(() => {\n    if (!event || event === prevEvent.current) return\n\n    if (event.type === 'success' && event.op === 'restore') {\n      navigateIntent('edit', {id, type})\n    }\n\n    prevEvent.current = event\n  }, [event, id, navigateIntent, type])\n\n  const handle = useCallback(() => {\n    setConfirmDialogOpen(true)\n  }, [])\n\n  const dialog: DocumentActionDialogProps | null = useMemo(() => {\n    if (isConfirmDialogOpen) {\n      return {\n        type: 'confirm',\n        tone: 'critical',\n        onCancel: onComplete,\n        onConfirm: handleConfirm,\n        message: <>Are you sure you want to restore this document?</>,\n      }\n    }\n\n    return null\n  }, [handleConfirm, isConfirmDialogOpen, onComplete])\n\n  const isRevisionInitialVersion = revision === '@initial'\n  const isRevisionLatestVersion = revision === undefined // undefined means latest version\n\n  if (isRevisionLatestVersion) {\n    return null\n  }\n\n  return {\n    label: 'Restore',\n    color: 'primary',\n    onHandle: handle,\n    title: isRevisionInitialVersion\n      ? \"You can't restore to the initial version\"\n      : 'Restore to this version',\n    icon: RestoreIcon,\n    dialog,\n    disabled: isRevisionInitialVersion,\n  }\n}\n\nHistoryRestoreAction.action = 'restore'\n", "import {CheckmarkIcon, PublishIcon} from '@sanity/icons'\nimport {isValidationErrorMarker} from '@sanity/types'\nimport React, {useCallback, useEffect, useState} from 'react'\nimport {TimeAgo} from '../components'\nimport {useDocumentPane} from '../panes/document/useDocumentPane'\nimport {\n  DocumentActionComponent,\n  InsufficientPermissionsMessage,\n  useCurrentUser,\n  useDocumentOperation,\n  useDocumentPairPermissions,\n  useEditState,\n  useSyncState,\n  useValidationStatus,\n} from 'sanity'\n\nconst DISABLED_REASON_TITLE = {\n  LIVE_EDIT_ENABLED: 'Cannot publish since liveEdit is enabled for this document type',\n  ALREADY_PUBLISHED: 'Already published',\n  NO_CHANGES: 'No unpublished changes',\n  NOT_READY: 'Operation not ready',\n}\n\nfunction getDisabledReason(\n  reason: keyof typeof DISABLED_REASON_TITLE,\n  publishedAt: string | undefined,\n) {\n  if (reason === 'ALREADY_PUBLISHED' && publishedAt) {\n    return (\n      <>\n        <span>\n          Published <TimeAgo time={publishedAt} />\n        </span>\n      </>\n    )\n  }\n  return DISABLED_REASON_TITLE[reason]\n}\n\n/** @internal */\n// eslint-disable-next-line complexity\nexport const PublishAction: DocumentActionComponent = (props) => {\n  const {id, type, liveEdit, draft, published} = props\n  const [publishState, setPublishState] = useState<'publishing' | 'published' | null>(null)\n  const {publish} = useDocumentOperation(id, type)\n  const validationStatus = useValidationStatus(id, type)\n  const syncState = useSyncState(id, type)\n  const {changesOpen, onHistoryOpen, documentId, documentType} = useDocumentPane()\n  const editState = useEditState(documentId, documentType)\n\n  const revision = (editState?.draft || editState?.published || {})._rev\n\n  const hasValidationErrors = validationStatus.validation.some(isValidationErrorMarker)\n  // we use this to \"schedule\" publish after pending tasks (e.g. validation and sync) has completed\n  const [publishScheduled, setPublishScheduled] = useState<boolean>(false)\n  const isSyncing = syncState.isSyncing\n  const isValidating = validationStatus.isValidating\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'publish',\n  })\n\n  const currentUser = useCurrentUser()\n\n  // eslint-disable-next-line no-nested-ternary\n  const title = publish.disabled\n    ? getDisabledReason(publish.disabled, (published || {})._updatedAt) || ''\n    : hasValidationErrors\n    ? 'There are validation errors that need to be fixed before this document can be published'\n    : ''\n\n  const hasDraft = Boolean(draft)\n\n  const doPublish = useCallback(() => {\n    publish.execute()\n    setPublishState('publishing')\n  }, [publish])\n\n  useEffect(() => {\n    // make sure the validation status is about the current revision and not an earlier one\n    const validationComplete =\n      validationStatus.isValidating === false && validationStatus.revision !== revision\n\n    if (!publishScheduled || isSyncing || !validationComplete) {\n      return\n    }\n\n    if (!hasValidationErrors) {\n      doPublish()\n    }\n    setPublishScheduled(false)\n  }, [\n    isSyncing,\n    doPublish,\n    hasValidationErrors,\n    publishScheduled,\n    validationStatus.revision,\n    revision,\n    isValidating,\n    validationStatus.isValidating,\n  ])\n\n  useEffect(() => {\n    const didPublish = publishState === 'publishing' && !hasDraft\n    if (didPublish) {\n      if (changesOpen) {\n        // Re-open the panel\n        onHistoryOpen()\n      }\n    }\n    const nextState = didPublish ? 'published' : null\n    const delay = didPublish ? 200 : 4000\n    const timer = setTimeout(() => {\n      setPublishState(nextState)\n    }, delay)\n    return () => clearTimeout(timer)\n  }, [changesOpen, publishState, hasDraft, onHistoryOpen])\n\n  const handle = useCallback(() => {\n    if (\n      syncState.isSyncing ||\n      validationStatus.isValidating ||\n      validationStatus.revision !== revision\n    ) {\n      setPublishScheduled(true)\n    } else {\n      doPublish()\n    }\n  }, [\n    syncState.isSyncing,\n    validationStatus.isValidating,\n    validationStatus.revision,\n    revision,\n    doPublish,\n  ])\n\n  if (liveEdit) {\n    return {\n      tone: 'positive',\n      label: 'Publish',\n      title:\n        'Live Edit is enabled for this content type and publishing happens automatically as you make changes',\n      disabled: true,\n    }\n  }\n\n  if (!isPermissionsLoading && !permissions?.granted) {\n    return {\n      tone: 'positive',\n      label: 'Publish',\n      title: (\n        <InsufficientPermissionsMessage\n          operationLabel=\"publish this document\"\n          currentUser={currentUser}\n        />\n      ),\n      disabled: true,\n    }\n  }\n\n  const disabled = Boolean(\n    publishScheduled ||\n      editState?.transactionSyncLock?.enabled ||\n      publishState === 'publishing' ||\n      publishState === 'published' ||\n      hasValidationErrors ||\n      publish.disabled,\n  )\n\n  return {\n    disabled: disabled || isPermissionsLoading,\n    tone: 'positive',\n    label:\n      // eslint-disable-next-line no-nested-ternary\n      publishState === 'published'\n        ? 'Published'\n        : publishScheduled || publishState === 'publishing'\n        ? 'Publishing…'\n        : 'Publish',\n    // @todo: Implement loading state, to show a `<Button loading />` state\n    // loading: publishScheduled || publishState === 'publishing',\n    icon: publishState === 'published' ? CheckmarkIcon : PublishIcon,\n    // eslint-disable-next-line no-nested-ternary\n    title: publishScheduled\n      ? 'Waiting for tasks to finish before publishing'\n      : publishState === 'published' || publishState === 'publishing'\n      ? null\n      : title,\n    shortcut: disabled || publishScheduled ? null : 'Ctrl+Alt+P',\n    onHandle: handle,\n  }\n}\n\nPublishAction.action = 'publish'\n", "import {UnpublishIcon} from '@sanity/icons'\nimport React, {useCallback, useMemo, useState} from 'react'\nimport {ConfirmDeleteDialog} from '../components'\nimport {\n  DocumentActionComponent,\n  InsufficientPermissionsMessage,\n  useDocumentPairPermissions,\n  useCurrentUser,\n  useDocumentOperation,\n  DocumentActionModalDialogProps,\n} from 'sanity'\n\nconst DISABLED_REASON_TITLE = {\n  NOT_PUBLISHED: 'This document is not published',\n}\n\n/** @internal */\nexport const UnpublishAction: DocumentActionComponent = ({\n  id,\n  type,\n  draft,\n  onComplete,\n  liveEdit,\n}) => {\n  const {unpublish} = useDocumentOperation(id, type)\n  const [isConfirmDialogOpen, setConfirmDialogOpen] = useState(false)\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'unpublish',\n  })\n  const currentUser = useCurrentUser()\n\n  const handleCancel = useCallback(() => {\n    setConfirmDialogOpen(false)\n    onComplete()\n  }, [onComplete])\n\n  const handleConfirm = useCallback(() => {\n    setConfirmDialogOpen(false)\n    unpublish.execute()\n    onComplete()\n  }, [onComplete, unpublish])\n\n  const dialog: DocumentActionModalDialogProps | null = useMemo(() => {\n    if (isConfirmDialogOpen) {\n      return {\n        type: 'dialog',\n        onClose: onComplete,\n        content: (\n          <ConfirmDeleteDialog\n            id={draft?._id || id}\n            type={type}\n            action=\"unpublish\"\n            onCancel={handleCancel}\n            onConfirm={handleConfirm}\n          />\n        ),\n      }\n    }\n\n    return null\n  }, [draft, id, handleCancel, handleConfirm, isConfirmDialogOpen, onComplete, type])\n\n  if (liveEdit) {\n    return null\n  }\n\n  if (!isPermissionsLoading && !permissions?.granted) {\n    return {\n      tone: 'critical',\n      icon: UnpublishIcon,\n      label: 'Unpublish',\n      title: (\n        <InsufficientPermissionsMessage\n          operationLabel=\"unpublish this document\"\n          currentUser={currentUser}\n        />\n      ),\n      disabled: true,\n    }\n  }\n\n  return {\n    tone: 'critical',\n    icon: UnpublishIcon,\n    disabled: Boolean(unpublish.disabled) || isPermissionsLoading,\n    label: 'Unpublish',\n    title: unpublish.disabled\n      ? DISABLED_REASON_TITLE[unpublish.disabled as keyof typeof DISABLED_REASON_TITLE]\n      : '',\n    onHandle: () => setConfirmDialogOpen(true),\n    dialog,\n  }\n}\n\nUnpublishAction.action = 'unpublish'\n", "import {DocumentBadgeComponent} from 'sanity'\n\n/** @internal */\nexport const LiveEditBadge: DocumentBadgeComponent = (props) => {\n  const {liveEdit} = props\n\n  if (liveEdit) {\n    return {\n      label: 'Live',\n      color: 'danger',\n    }\n  }\n\n  return null\n}\n", "/**\n * @internal\n */\nexport const _DEBUG = false\n\nexport const EMPTY_PARAMS = {}\nexport const LOADING_PANE = Symbol('LOADING_PANE')\n\nexport const DOCUMENT_PANEL_PORTAL_ELEMENT = 'documentPanelPortalElement'\n", "import {uuid} from '@sanity/uuid'\nimport {PaneNode, RouterPanes} from './types'\nimport {EMPTY_PARAMS, LOADING_PANE} from './constants'\n\nconst state: {\n  activePanes: Array<PaneNode | typeof LOADING_PANE>\n} = {activePanes: []}\n\nexport function setActivePanes(panes: Array<PaneNode | typeof LOADING_PANE>): void {\n  state.activePanes = panes\n}\n\n/**\n * This function looks at the _active panes_ to resolve an intent. this type of\n * intent resolution is faster and does not cause the panes to reset\n *\n * @internal\n */\nexport function getIntentState(\n  intent: string,\n  params: Record<string, string>,\n  routerState: {panes?: RouterPanes} | undefined,\n  payload: unknown,\n): {panes: RouterPanes} | {intent: string; params: Record<string, string>; payload: unknown} {\n  const panes = routerState?.panes || []\n  const activePanes = state.activePanes || []\n  const editDocumentId = params.id || uuid()\n  const isTemplate = intent === 'create' && params.template\n\n  // Loop through open panes and see if any of them can handle the intent\n  for (let i = activePanes.length - 1; i >= 0; i--) {\n    const pane = activePanes[i]\n\n    if (typeof pane !== 'object') continue\n\n    // NOTE: if you update this logic, please also update the similar handler in\n    // `resolveIntent.ts`\n    if (\n      pane.canHandleIntent?.(intent, params, {\n        pane,\n        index: i,\n      }) ||\n      // see `resolveIntent.ts` for more info\n      (pane.type === 'documentList' &&\n        pane.schemaTypeName === params.type &&\n        pane.options.filter === '_type == $type')\n    ) {\n      const paneParams = isTemplate ? {template: params.template} : EMPTY_PARAMS\n\n      return {\n        panes: panes\n          .slice(0, i)\n          .concat([[{id: editDocumentId, params: paneParams, payload}]]) as RouterPanes,\n      }\n    }\n  }\n\n  return {intent: intent, params, payload}\n}\n", "import {omit} from 'lodash'\nimport {RouterPanes, RouterPaneGroup, RouterPaneSibling} from './types'\nimport {route} from 'sanity/router'\n\nconst EMPTY_PARAMS = {}\n\n/**\n * @internal\n */\nexport function legacyEditParamsToState(params: string): Record<string, unknown> {\n  try {\n    return JSON.parse(decodeURIComponent(params))\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.warn('Failed to parse JSON parameters')\n    return {}\n  }\n}\n\nexport function encodePanesSegment(panes: RouterPanes): string {\n  return (panes || [])\n    .map((group) => group.map(encodeChunks).join('|'))\n    .map(encodeURIComponent)\n    .join(';')\n}\n\n/**\n * @internal\n */\nexport function legacyEditParamsToPath(params: Record<string, unknown>): string {\n  return JSON.stringify(params)\n}\n\n// http://localhost:3333/intent/create/template=book-by-author;type=book/eyJhdXRob3JJZCI6Imdycm0ifQ==\n\n/**\n * @internal\n */\nexport function toState(pathSegment: string): RouterPaneGroup[] {\n  return parsePanesSegment(decodeURIComponent(pathSegment))\n}\n\n/**\n * @internal\n */\nexport function toPath(panes: RouterPaneGroup[]): string {\n  return encodePanesSegment(panes)\n}\n\nexport const router = route.create('/', [\n  // \"Asynchronous intent resolving\" route\n  route.intents('/intent'),\n\n  // Legacy fallback route, will be redirected to new format\n  route.create('/edit/:type/:editDocumentId', [\n    route.create({\n      path: '/:params',\n      transform: {params: {toState: legacyEditParamsToState, toPath: legacyEditParamsToPath}},\n    }),\n  ]),\n\n  // The regular path - when the intent can be resolved to a specific pane\n  route.create({\n    path: '/:panes',\n    // Legacy URLs, used to handle redirects\n    children: [route.create('/:action', route.create('/:legacyEditDocumentId'))],\n    transform: {\n      panes: {toState, toPath},\n    },\n  }),\n])\n\n// old: authors;knut,{\"template\":\"diaryEntry\"}\n// new: authors;knut,view=diff,eyJyZXYxIjoiYWJjMTIzIiwicmV2MiI6ImRlZjQ1NiJ9|latest-posts\n\nconst panePattern = /^([.a-z0-9_-]+),?({.*?})?(?:(;|$))/i\nconst isParam = (str: string) => /^[a-z0-9]+=[^=]+/i.test(str)\nconst isPayload = (str: string) =>\n  /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(str)\nconst exclusiveParams = ['view', 'since', 'rev', 'inspect']\n\ntype Truthy<T> = T extends false\n  ? never\n  : T extends ''\n  ? never\n  : T extends 0\n  ? never\n  : T extends 0n\n  ? never\n  : T extends null | undefined\n  ? NonNullable<T>\n  : T\nconst isTruthy = Boolean as (t: unknown) => boolean as <T>(t: T) => t is Truthy<T>\n\nfunction parseChunks(chunks: string[], initial: RouterPaneSibling): RouterPaneSibling {\n  return chunks.reduce(\n    (pane, chunk) => {\n      if (isParam(chunk)) {\n        const key = chunk.slice(0, chunk.indexOf('='))\n        const value = chunk.slice(key.length + 1)\n        pane.params = {...pane.params, [decodeURIComponent(key)]: decodeURIComponent(value)}\n      } else if (isPayload(chunk)) {\n        pane.payload = tryParseBase64Payload(chunk)\n      } else {\n        // eslint-disable-next-line no-console\n        console.warn('Unknown pane segment: %s - skipping', chunk)\n      }\n\n      return pane\n    },\n    {...initial, params: EMPTY_PARAMS, payload: undefined},\n  )\n}\n\nfunction encodeChunks(pane: RouterPaneSibling, index: number, group: RouterPaneGroup): string {\n  const {payload, params = {}, id} = pane\n  const [firstSibling] = group\n  const paneIsFirstSibling = pane === firstSibling\n  const sameAsFirst = index !== 0 && id === firstSibling.id\n  const encodedPayload = typeof payload === 'undefined' ? undefined : btoa(JSON.stringify(payload))\n\n  const encodedParams = Object.entries(params)\n    .filter((entry): entry is [string, string] => {\n      const [key, value] = entry\n      if (!value) return false\n      if (paneIsFirstSibling) return true\n\n      // omit the value if it's the same as the value from the first sibling\n      const valueFromFirstSibling = firstSibling.params?.[key]\n      if (value === valueFromFirstSibling && !exclusiveParams.includes(key)) return false\n      return true\n    })\n    .map(([key, value]) => `${encodeURIComponent(key)}=${encodeURIComponent(value)}`)\n\n  return (\n    [sameAsFirst ? '' : id]\n      .concat([encodedParams.length > 0 && encodedParams, encodedPayload].filter(isTruthy).flat())\n      .join(',') || ','\n  )\n}\n\nexport function parsePanesSegment(str: string): RouterPanes {\n  if (str.indexOf(',{') !== -1) {\n    return parseOldPanesSegment(str)\n  }\n\n  return str\n    .split(';')\n    .map((group) => {\n      const [firstSibling, ...restOfSiblings] = group.split('|').map((segment) => {\n        const [id, ...chunks] = segment.split(',')\n        return parseChunks(chunks, {id})\n      })\n\n      return [\n        firstSibling,\n        ...restOfSiblings.map((sibling) => ({\n          ...firstSibling,\n          ...sibling,\n          id: sibling.id || firstSibling.id,\n          params: {...omit(firstSibling.params, exclusiveParams), ...sibling.params},\n          payload: sibling.payload || firstSibling.payload,\n        })),\n      ]\n    })\n    .filter((group) => group.length > 0)\n}\n\nfunction parseOldPanesSegment(str: string): RouterPanes {\n  const chunks: RouterPaneGroup = []\n\n  let buffer = str\n  while (buffer.length) {\n    const [match, id, payloadChunk] = buffer.match(panePattern) || []\n    if (!match) {\n      buffer = buffer.slice(1)\n      continue\n    }\n\n    const payload = payloadChunk && tryParsePayload(payloadChunk)\n    chunks.push({id, payload})\n\n    buffer = buffer.slice(match.length)\n  }\n\n  return [chunks]\n}\n\nfunction tryParsePayload(json: string) {\n  try {\n    return JSON.parse(json)\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.warn(`Failed to parse parameters: ${err.message}`)\n    return undefined\n  }\n}\n\nfunction tryParseBase64Payload(data: string) {\n  return data ? tryParsePayload(atob(data)) : undefined\n}\n", "import {PaneRouterContextValue} from '../../components'\nimport {PaneMenuItemGroup} from '../../types'\n\nexport const DOCUMENT_PANEL_MIN_WIDTH = 320\nexport const DOCUMENT_PANEL_INITIAL_MIN_WIDTH = 600\n\nexport const DOCUMENT_INSPECTOR_MIN_WIDTH = 320\nexport const DOCUMENT_INSPECTOR_MAX_WIDTH = 540\n\nexport const EMPTY_PARAMS: NonNullable<PaneRouterContextValue['params']> = {}\n\nexport const INSPECT_ACTION_PREFIX = 'inspect:'\n\nexport const DEFAULT_MENU_ITEM_GROUPS: PaneMenuItemGroup[] = [{id: 'inspectors'}, {id: 'links'}]\n\n// inspectors\nexport const HISTORY_INSPECTOR_NAME = 'sanity/desk/history'\nexport const VALIDATION_INSPECTOR_NAME = 'sanity/desk/validation'\n", "import {CloseIcon} from '@sanity/icons'\nimport {Box, Button, Card, CardProps, Flex, Text} from '@sanity/ui'\nimport React, {HTMLProps, ReactNode} from 'react'\nimport styled from 'styled-components'\n\nexport interface DocumentInspectorHeaderProps {\n  as?: CardProps['as']\n  closeButtonLabel: string\n  flex?: CardProps['flex']\n  onClose: () => void\n  title: ReactNode\n}\n\nconst Root = styled(Card)({\n  position: 'relative',\n  zIndex: 1,\n  lineHeight: 0,\n\n  '&:after': {\n    content: '\"\"',\n    display: 'block',\n    position: 'absolute',\n    left: 0,\n    bottom: -1,\n    right: 0,\n    borderBottom: '1px solid var(--card-border-color)',\n    opacity: 0.5,\n  },\n})\n\n/** @internal */\nexport function DocumentInspectorHeader(\n  props: DocumentInspectorHeaderProps & Omit<HTMLProps<HTMLDivElement>, 'as' | 'height' | 'ref'>,\n) {\n  const {as: forwardedAs, children, closeButtonLabel, onClose, title, ...restProps} = props\n\n  return (\n    <Root {...restProps} as={forwardedAs}>\n      <Flex padding={2}>\n        <Box flex={1} padding={3}>\n          <Text as=\"h1\" size={1} weight=\"semibold\">\n            {title}\n          </Text>\n        </Box>\n        <Box flex=\"none\" padding={1}>\n          <Button\n            aria-label={closeButtonLabel}\n            fontSize={1}\n            icon={CloseIcon}\n            mode=\"bleed\"\n            onClick={onClose}\n            padding={2}\n          />\n        </Box>\n      </Flex>\n      {children}\n    </Root>\n  )\n}\n", "import {createContext} from 'react'\nimport {DeskToolContextValue} from './types'\n\nexport const DeskToolContext = createContext<DeskToolContextValue | null>(null)\n", "import {useContext} from 'react'\nimport {DeskToolContext} from './DeskToolContext'\nimport {DeskToolContextValue} from './types'\n\n/** @internal */\nexport function useDeskTool(): DeskToolContextValue {\n  const deskTool = useContext(DeskToolContext)\n\n  if (!deskTool) throw new Error(`DeskTool: missing context value`)\n\n  return deskTool\n}\n", "import React, {useCallback, useRef} from 'react'\nimport styled from 'styled-components'\n\nconst Root = styled.div`\n  position: absolute;\n  top: 0;\n  left: -4px;\n  bottom: 0;\n  width: 9px;\n  z-index: 201;\n  cursor: ew-resize;\n\n  /* Border */\n  & > span:nth-child(1) {\n    display: block;\n    border-left: 1px solid var(--card-border-color);\n    position: absolute;\n    top: 0;\n    left: 4px;\n    bottom: 0;\n    transition: opacity 200ms;\n    opacity: 0.5;\n  }\n\n  /* Hover effect */\n  & > span:nth-child(2) {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 9px;\n    bottom: 0;\n    background-color: var(--card-border-color);\n    opacity: 0;\n    transition: opacity 150ms;\n  }\n\n  @media (hover: hover) {\n    &:hover > span:nth-child(2) {\n      opacity: 0.2;\n    }\n  }\n`\n\nexport function Resizer(props: {onResize: (delta: number) => void; onResizeStart: () => void}) {\n  const {onResize, onResizeStart} = props\n\n  const mouseXRef = useRef(0)\n\n  const handleMouseDown = useCallback(\n    (event: React.MouseEvent) => {\n      event.preventDefault()\n\n      mouseXRef.current = event.pageX\n\n      onResizeStart()\n\n      const handleMouseMove = (e: MouseEvent) => {\n        e.preventDefault()\n        onResize(e.pageX - mouseXRef.current)\n      }\n\n      const handleMouseUp = () => {\n        window.removeEventListener('mousemove', handleMouseMove)\n        window.removeEventListener('mouseup', handleMouseUp)\n      }\n\n      window.addEventListener('mousemove', handleMouseMove)\n      window.addEventListener('mouseup', handleMouseUp)\n    },\n    [onResize, onResizeStart],\n  )\n\n  return (\n    <Root onMouseDown={handleMouseDown}>\n      {/* Hover effect */}\n      <span />\n\n      {/* Border */}\n      <span />\n    </Root>\n  )\n}\n", "import React, {HTMLProps, useCallback, useMemo, useRef, useState} from 'react'\nimport styled from 'styled-components'\nimport {Box, BoxProps} from '@sanity/ui'\nimport {Resizer} from './Resizer'\n\nexport interface ResizableProps {\n  minWidth: number\n  maxWidth: number\n}\n\nconst Root = styled(Box)`\n  position: relative;\n  flex: 1;\n  padding-left: 1px;\n`\n\nexport function Resizable(\n  props: ResizableProps & BoxProps & Omit<HTMLProps<HTMLDivElement>, 'as'>,\n) {\n  const {as: forwardedAs, children, minWidth, maxWidth, ...restProps} = props\n  const [element, setElement] = useState<HTMLDivElement | null>(null)\n  const elementWidthRef = useRef<number>()\n  const [targetWidth, setTargetWidth] = useState<number>()\n\n  const handleResizeStart = useCallback(() => {\n    elementWidthRef.current = element?.offsetWidth\n  }, [element])\n\n  const handleResize = useCallback(\n    (deltaX: number) => {\n      const w = elementWidthRef.current\n\n      if (!w) return\n\n      setTargetWidth(Math.min(Math.max(w - deltaX, minWidth), maxWidth))\n    },\n    [minWidth, maxWidth],\n  )\n\n  const style = useMemo(\n    () => (targetWidth ? {flex: 'none', width: targetWidth} : {minWidth, maxWidth}),\n    [minWidth, maxWidth, targetWidth],\n  )\n\n  return (\n    <Root as={forwardedAs} {...restProps} ref={setElement} style={style}>\n      {children}\n      <Resizer onResize={handleResize} onResizeStart={handleResizeStart} />\n    </Root>\n  )\n}\n", "/* eslint-disable no-loop-func */\n\nimport {Path, SanityDocument, SchemaType} from '@sanity/types'\nimport {isArray, isRecord} from 'sanity'\n\nexport function getPathTypes(options: {\n  path: Path\n  schemaType: SchemaType\n  value: Partial<SanityDocument> | null\n}): SchemaType[] {\n  const {path, schemaType, value} = options\n  const result: SchemaType[] = []\n\n  let s = schemaType\n  let v: unknown = value\n\n  for (const segment of path) {\n    // field name\n    if (typeof segment === 'string') {\n      if (!isRecord(v) && v !== undefined) {\n        throw new Error(`Parent value is not an object, cannot get path segment: .${segment}`)\n      }\n\n      if (s.jsonType !== 'object') {\n        throw new Error(\n          `Parent type is not an object schema type, cannot get path segment: .${segment}`,\n        )\n      }\n\n      v = v?.[segment]\n\n      const field = s.fields.find((f) => f.name === segment)\n\n      if (!field) {\n        throw new Error(`Field type not found: .${segment}`)\n      }\n\n      s = field.type\n\n      result.push(s)\n\n      continue\n    }\n\n    // array item index\n    if (typeof segment === 'number') {\n      if (!isArray(v) && v !== undefined) {\n        throw new Error(`Parent value is not an array, cannot get path segment: [${segment}]`)\n      }\n\n      if (s.jsonType !== 'array') {\n        throw new Error(\n          `Parent type is not an array schema type, cannot get path segment: [${segment}]`,\n        )\n      }\n\n      v = v?.[segment]\n\n      const itemType = s.of.find((ofType) => {\n        if (typeof v === 'string') {\n          return ofType.jsonType === 'string'\n        }\n\n        if (typeof v === 'number') {\n          return ofType.jsonType === 'number'\n        }\n\n        if (typeof v === 'boolean') {\n          return ofType.jsonType === 'boolean'\n        }\n\n        if (isRecord(v)) {\n          return ofType.name === v?._type\n        }\n\n        return false\n      })\n\n      if (!itemType) {\n        throw new Error(`Item type not found: [${segment}]`)\n      }\n\n      s = itemType\n\n      result.push(s)\n\n      continue\n    }\n\n    // array item key\n    if (isRecord(segment) && segment._key) {\n      if (!isArray(v)) {\n        throw new Error(\n          `Parent value is not an anrray, cannot get path segment: [_key == ${segment}]`,\n        )\n      }\n\n      if (s.jsonType !== 'array') {\n        throw new Error(\n          `Parent type is not an array schema type, cannot get path segment: .${segment}`,\n        )\n      }\n\n      const values = v ?? []\n\n      v = values.find((i) => isRecord(i) && i._key === segment._key)\n\n      if (!isRecord(v)) {\n        throw new Error(`Array item not found: [_key == ${segment._key}]`)\n      }\n\n      const ofType = s.of.find((i) => isRecord(v) && i.name === v?._type)\n\n      if (!ofType) {\n        throw new Error(`Array item type not found: .${v?._type}`)\n      }\n\n      s = ofType\n\n      result.push(s)\n\n      continue\n    }\n\n    throw new Error(`Invalid path segment: ${JSON.stringify(segment)}`)\n  }\n\n  return result\n}\n", "import {ErrorOutlineIcon, IconComponent, InfoOutlineIcon, WarningOutlineIcon} from '@sanity/icons'\nimport {Box, Card, CardTone, ErrorBoundary, Flex, Stack, Text} from '@sanity/ui'\nimport {ObjectSchemaType, Path, SanityDocument, SchemaType, ValidationMarker} from '@sanity/types'\nimport React, {ErrorInfo, Fragment, createElement, useCallback, useMemo, useState} from 'react'\nimport {useDocumentPane} from '../../useDocumentPane'\nimport {DocumentInspectorHeader} from '../../documentInspector'\nimport {getPathTypes} from './getPathTypes'\nimport {DocumentInspectorProps, pathToString} from 'sanity'\n\nconst MARKER_ICON: Record<'error' | 'warning' | 'info', IconComponent> = {\n  error: ErrorOutlineIcon,\n  warning: WarningOutlineIcon,\n  info: InfoOutlineIcon,\n}\n\nconst MARKER_TONE: Record<'error' | 'warning' | 'info', CardTone> = {\n  error: 'critical',\n  warning: 'caution',\n  info: 'primary',\n}\n\nexport function ValidationInspector(props: DocumentInspectorProps) {\n  const {onClose} = props\n  const {onFocus, onPathOpen, schemaType, validation, value} = useDocumentPane()\n\n  const handleOpen = useCallback(\n    (path: Path) => {\n      onPathOpen(path)\n      onFocus(path)\n    },\n    [onFocus, onPathOpen],\n  )\n\n  return (\n    <Flex direction=\"column\" height=\"fill\" overflow=\"hidden\">\n      <DocumentInspectorHeader\n        as=\"header\"\n        closeButtonLabel=\"Close validation\"\n        flex=\"none\"\n        onClose={onClose}\n        title=\"Validation\"\n      />\n\n      <Card flex={1} overflow=\"auto\" padding={3}>\n        {validation.length === 0 && (\n          <Box padding={2}>\n            <Text muted size={1}>\n              No validation errors\n            </Text>\n          </Box>\n        )}\n\n        {validation.length > 0 && (\n          <Stack space={2}>\n            {validation.map((marker, i) => (\n              <ValidationCard\n                key={i}\n                marker={marker}\n                onOpen={handleOpen}\n                schemaType={schemaType}\n                value={value}\n              />\n            ))}\n          </Stack>\n        )}\n      </Card>\n    </Flex>\n  )\n}\n\nfunction ValidationCard(props: {\n  marker: ValidationMarker\n  onOpen: (path: Path) => void\n  schemaType: ObjectSchemaType\n  value: Partial<SanityDocument> | null\n}) {\n  const {marker, onOpen, schemaType, value} = props\n  const handleOpen = useCallback(() => onOpen(marker.path), [marker, onOpen])\n  const [errorInfo, setErrorInfo] = useState<{error: Error; info: ErrorInfo} | null>(null)\n\n  return (\n    <ErrorBoundary onCatch={setErrorInfo}>\n      {errorInfo && (\n        <Card padding={3} radius={2} tone=\"critical\">\n          <Text size={1}>ERROR: {errorInfo.error.message}</Text>\n        </Card>\n      )}\n\n      {!errorInfo && (\n        <Card\n          __unstable_focusRing\n          as=\"button\"\n          onClick={handleOpen}\n          padding={3}\n          radius={2}\n          tone={MARKER_TONE[marker.level]}\n        >\n          <Flex align=\"flex-start\" gap={3}>\n            <Box flex=\"none\">\n              <Text size={1}>{createElement(MARKER_ICON[marker.level])}</Text>\n            </Box>\n\n            <Stack flex={1} space={2}>\n              <DocumentNodePathBreadcrumbs\n                path={marker.path}\n                schemaType={schemaType}\n                value={value}\n              />\n\n              <Text muted size={1}>\n                {marker.item.message}\n              </Text>\n            </Stack>\n          </Flex>\n        </Card>\n      )}\n    </ErrorBoundary>\n  )\n}\n\nfunction DocumentNodePathBreadcrumbs(props: {\n  path: Path\n  schemaType: SchemaType\n  value: Partial<SanityDocument> | null\n}) {\n  const {path, schemaType, value} = props\n\n  const pathTypes = useMemo(\n    () => getPathTypes({path, schemaType, value}),\n    [path, schemaType, value],\n  )\n\n  return (\n    <Text size={1}>\n      {pathTypes.map((t, i) => (\n        <Fragment key={i}>\n          {i > 0 && <span style={{color: 'var(--card-muted-fg-color)', opacity: 0.5}}> / </span>}\n          <span style={{fontWeight: 500}}>{t.title || t.name}</span>\n        </Fragment>\n      ))}\n    </Text>\n  )\n}\n", "import {CheckmarkCircleIcon, ErrorOutlineIcon, WarningOutlineIcon} from '@sanity/icons'\nimport {useMemo} from 'react'\nimport {VALIDATION_INSPECTOR_NAME} from '../../constants'\nimport {ValidationInspector} from './ValidationInspector'\nimport {\n  DocumentInspector,\n  DocumentInspectorMenuItem,\n  DocumentInspectorUseMenuItemProps,\n  FormNodeValidation,\n  isValidationError,\n  isValidationWarning,\n  useValidationStatus,\n} from 'sanity'\n\nfunction useMenuItem(props: DocumentInspectorUseMenuItemProps): DocumentInspectorMenuItem {\n  const {documentId, documentType} = props\n  const {validation: validationMarkers} = useValidationStatus(documentId, documentType)\n\n  const validation: FormNodeValidation[] = useMemo(\n    () =>\n      validationMarkers.map((item) => ({\n        level: item.level,\n        message: item.item.message,\n        path: item.path,\n      })),\n    [validationMarkers],\n  )\n\n  const hasErrors = validation.some(isValidationError)\n  const hasWarnings = validation.some(isValidationWarning)\n\n  const icon = useMemo(() => {\n    if (hasErrors) return ErrorOutlineIcon\n    if (hasWarnings) return WarningOutlineIcon\n    return CheckmarkCircleIcon\n  }, [hasErrors, hasWarnings])\n\n  const tone = useMemo(() => {\n    if (hasErrors) return 'critical'\n    if (hasWarnings) return 'caution'\n    return 'positive'\n  }, [hasErrors, hasWarnings])\n\n  return {\n    hidden: validation.length === 0,\n    icon,\n    title: 'Validation',\n    tone,\n    showAsAction: true,\n  }\n}\n\nexport const validationInspector: DocumentInspector = {\n  name: VALIDATION_INSPECTOR_NAME,\n  component: ValidationInspector,\n  useMenuItem,\n}\n", "import {\n  TrashIcon,\n  EditIcon,\n  IconComponent,\n  PublishIcon,\n  UnpublishIcon,\n  CloseIcon,\n  AddCircleIcon,\n} from '@sanity/icons'\n\nexport const TIMELINE_LABELS: {[key: string]: string | undefined} = {\n  create: 'created',\n  delete: 'deleted',\n  discardDraft: 'discarded draft',\n  initial: 'created',\n  editDraft: 'edited',\n  editLive: 'live edited',\n  publish: 'published',\n  unpublish: 'unpublished',\n}\n\nexport const TIMELINE_ICON_COMPONENTS: {[key: string]: IconComponent | undefined} = {\n  create: AddCircleIcon,\n  delete: TrashIcon,\n  discardDraft: CloseIcon,\n  initial: AddCircleIcon,\n  editDraft: EditIcon,\n  editLive: EditIcon,\n  publish: PublishIcon,\n  unpublish: UnpublishIcon,\n}\n", "import {IconComponent} from '@sanity/icons'\nimport {TIMELINE_ICON_COMPONENTS, TIMELINE_LABELS} from './constants'\nimport {ChunkType} from 'sanity'\n\nexport function formatTimelineEventLabel(type: ChunkType): string | undefined {\n  return TIMELINE_LABELS[type]\n}\n\nexport function getTimelineEventIconComponent(type: ChunkType): IconComponent | undefined {\n  return TIMELINE_ICON_COMPONENTS[type]\n}\n", "import React from 'react'\nimport {AvatarStack} from '@sanity/ui'\nimport {UserAvatar} from 'sanity'\n\ninterface UserAvatarStackProps {\n  maxLength?: number\n  userIds: string[]\n}\n\nexport function UserAvatarStack({maxLength, userIds}: UserAvatarStackProps) {\n  return (\n    <AvatarStack maxLength={maxLength}>\n      {userIds.map((userId) => (\n        <UserAvatar key={userId} user={userId} withTooltip />\n      ))}\n    </AvatarStack>\n  )\n}\n", "import {Text, Box, Button, Theme, Flex, rem} from '@sanity/ui'\nimport styled, {css} from 'styled-components'\n\nexport interface IconWrapperProps {\n  theme: Theme\n}\n\nexport const IconWrapper = styled(Flex)(({theme}: IconWrapperProps) => {\n  const borderColor = theme.sanity.color.base.skeleton?.from\n\n  return css`\n    --timeline-hairline-width: 1px;\n    position: relative;\n    z-index: 2;\n    margin: 0;\n    padding: 0;\n\n    &::before {\n      position: absolute;\n      content: '';\n      height: 100%;\n      width: var(--timeline-hairline-width);\n      background: ${borderColor};\n      top: 0;\n      left: calc((100% - var(--timeline-hairline-width)) / 2);\n      z-index: 1;\n    }\n  `\n})\n\nexport const Root = styled(Button)(({\n  $selected,\n  $disabled,\n}: {\n  $selected: boolean\n  $disabled: boolean\n}) => {\n  return css`\n    position: relative;\n    width: 100%;\n\n    /* Line styling */\n    &[data-first] ${IconWrapper}::before {\n      height: 50%;\n      top: unset;\n      bottom: 0;\n    }\n\n    &[data-last] ${IconWrapper}::before {\n      height: 50%;\n    }\n\n    ${$selected &&\n    css`\n      ${IconWrapper}::before {\n        background: transparent;\n      }\n    `}\n\n    ${$disabled &&\n    css`\n      cursor: not-allowed;\n    `}\n  `\n})\n\nexport const IconBox = styled(Box)`\n  background: var(--card-bg-color);\n  border-radius: 50px;\n  position: relative;\n  z-index: 2;\n`\n\nexport const EventLabel = styled(Text)`\n  text-transform: capitalize;\n`\n\nexport const TimestampBox = styled(Box)`\n  min-width: 1rem;\n  margin-left: ${({theme}) => `-${rem(theme.sanity.space[1])}`};\n`\n", "import React, {useCallback, createElement, useMemo} from 'react'\nimport {Box, ButtonTone, Card, Flex, Label, Stack, Text} from '@sanity/ui'\nimport {format} from 'date-fns'\nimport {formatTimelineEventLabel, getTimelineEventIconComponent} from './helpers'\nimport {UserAvatarStack} from './userAvatarStack'\nimport {EventLabel, IconBox, IconWrapper, Root, TimestampBox} from './timelineItem.styled'\nimport {ChunkType, Chunk} from 'sanity'\n\nconst TIMELINE_ITEM_EVENT_TONE: Record<ChunkType | 'withinSelection', ButtonTone> = {\n  initial: 'primary',\n  create: 'primary',\n  publish: 'positive',\n  editLive: 'caution',\n  editDraft: 'caution',\n  unpublish: 'critical',\n  discardDraft: 'critical',\n  delete: 'critical',\n  withinSelection: 'primary',\n}\n\ninterface TimelineItemProps {\n  chunk: Chunk\n  isFirst: boolean\n  isLast: boolean\n  isLatest: boolean\n  isSelected: boolean\n  onSelect: (chunk: Chunk) => void\n  timestamp: string\n  type: ChunkType\n}\n\nexport function TimelineItem({\n  chunk,\n  isFirst,\n  isLast,\n  isLatest,\n  isSelected,\n  onSelect,\n  timestamp,\n  type,\n}: TimelineItemProps) {\n  const iconComponent = getTimelineEventIconComponent(type)\n  const authorUserIds = Array.from(chunk.authors)\n  const isSelectable = type !== 'delete'\n  const formattedTimestamp = useMemo(() => {\n    const parsedDate = new Date(timestamp)\n    const formattedDate = format(parsedDate, 'MMM d, yyyy, hh:mm a')\n\n    return formattedDate\n  }, [timestamp])\n\n  const handleClick = useCallback(\n    (evt: React.MouseEvent<HTMLButtonElement>) => {\n      evt.preventDefault()\n      evt.stopPropagation()\n\n      if (isSelectable) {\n        onSelect(chunk)\n      }\n    },\n    [onSelect, chunk, isSelectable],\n  )\n\n  return (\n    <Root\n      $selected={isSelected}\n      $disabled={!isSelectable}\n      data-chunk-id={chunk.id}\n      data-first={isFirst ? true : undefined}\n      data-last={isLast ? true : undefined}\n      data-ui=\"timelineItem\"\n      mode={isSelected ? 'default' : 'bleed'}\n      onClick={handleClick}\n      padding={0}\n      radius={2}\n      tone={isSelected ? 'primary' : TIMELINE_ITEM_EVENT_TONE[chunk.type]}\n    >\n      <Box paddingX={2}>\n        <Flex align=\"stretch\">\n          <IconWrapper align=\"center\">\n            <IconBox padding={2}>\n              <Text size={2}>{iconComponent && createElement(iconComponent)}</Text>\n            </IconBox>\n          </IconWrapper>\n\n          <Stack space={2} margin={2}>\n            {isLatest && (\n              <Flex>\n                <Card\n                  padding={1}\n                  radius={2}\n                  shadow={1}\n                  tone={isSelected ? 'primary' : TIMELINE_ITEM_EVENT_TONE[chunk.type]}\n                >\n                  <Label muted size={0}>\n                    Latest\n                  </Label>\n                </Card>\n              </Flex>\n            )}\n            <Box>\n              <EventLabel size={1} weight=\"medium\">\n                {formatTimelineEventLabel(type) || <code>{type}</code>}\n              </EventLabel>\n            </Box>\n            <TimestampBox paddingX={1}>\n              <Text size={0} muted>\n                {formattedTimestamp}\n              </Text>\n            </TimestampBox>\n          </Stack>\n          <Flex flex={1} justify=\"flex-end\" align=\"center\">\n            <UserAvatarStack maxLength={3} userIds={authorUserIds} />\n          </Flex>\n        </Flex>\n      </Box>\n    </Root>\n  )\n}\n", "import {Box, Flex, Stack} from '@sanity/ui'\nimport styled, {css} from 'styled-components'\n\nexport const StackWrapper = styled(Stack)`\n  max-width: 200px;\n`\n\nexport const ListWrapper = styled(Flex)`\n  max-height: calc(100vh - 198px);\n  min-width: 244px;\n`\n\nexport const Root = styled(Box)(({$visible}: {$visible?: boolean}) => {\n  return css`\n    opacity: 0;\n    pointer-events: none;\n\n    ${$visible &&\n    css`\n      opacity: 1;\n      pointer-events: auto;\n    `}\n  `\n})\n", "import React, {useCallback, useEffect, useMemo, useState} from 'react'\nimport {Box, Flex, Spinner, Text} from '@sanity/ui'\nimport {TimelineItem} from './timelineItem'\nimport {ListWrapper, Root, StackWrapper} from './timeline.styled'\nimport {Chunk, CommandList, CommandListRenderItemCallback} from 'sanity'\n\ninterface TimelineProps {\n  chunks: Chunk[]\n  disabledBeforeFirstChunk?: boolean\n  firstChunk?: Chunk | null\n  hasMoreChunks: boolean | null\n  lastChunk?: Chunk | null\n  onLoadMore: () => void\n  onSelect: (chunk: Chunk) => void\n}\n\nexport const Timeline = ({\n  chunks,\n  disabledBeforeFirstChunk,\n  hasMoreChunks,\n  lastChunk,\n  onLoadMore,\n  onSelect,\n  firstChunk,\n}: TimelineProps) => {\n  const [mounted, setMounted] = useState(false)\n\n  const filteredChunks = useMemo(() => {\n    return chunks.filter((c) => {\n      if (disabledBeforeFirstChunk && firstChunk) {\n        return c.index < firstChunk.index\n      }\n      return true\n    })\n  }, [chunks, disabledBeforeFirstChunk, firstChunk])\n\n  const selectedIndex = useMemo(\n    () => (lastChunk?.id ? filteredChunks.findIndex((c) => c.id === lastChunk.id) : -1),\n    [lastChunk?.id, filteredChunks],\n  )\n\n  const renderItem = useCallback<CommandListRenderItemCallback<Chunk>>(\n    (chunk, {activeIndex}) => {\n      const isFirst = activeIndex === 0\n      const isLast = (filteredChunks && activeIndex === filteredChunks.length - 1) || false\n      return (\n        <Box paddingBottom={isLast ? 1 : 0} paddingTop={isFirst ? 1 : 0} paddingX={1}>\n          <TimelineItem\n            chunk={chunk}\n            isFirst={isFirst}\n            isLast={isLast}\n            isLatest={activeIndex === 0 && !disabledBeforeFirstChunk}\n            isSelected={activeIndex === selectedIndex}\n            onSelect={onSelect}\n            timestamp={chunk.endTimestamp}\n            type={chunk.type}\n          />\n          {activeIndex === filteredChunks.length - 1 && hasMoreChunks && (\n            <Flex align=\"center\" justify=\"center\" padding={4}>\n              <Spinner muted />\n            </Flex>\n          )}\n        </Box>\n      )\n    },\n    [disabledBeforeFirstChunk, filteredChunks, hasMoreChunks, onSelect, selectedIndex],\n  )\n\n  useEffect(() => setMounted(true), [])\n\n  return (\n    <Root\n      /**\n       * We delay initial rendering if `selectedIndex` is present.\n       * This is a _temporary_ workaround to allow the virtual <CommandList>\n       * to scroll to a specific index prior to being displayed.\n       *\n       * Without this, there'll be a noticeable 'flash' where the virtual list\n       * will render with its child items at the top and then scroll into position.\n       */\n      $visible={!selectedIndex || mounted}\n      data-ui=\"timeline\"\n    >\n      {filteredChunks.length === 0 && (\n        <StackWrapper padding={3} space={3}>\n          <Text size={1} weight=\"semibold\">\n            No document history\n          </Text>\n          <Text muted size={1}>\n            When changing the content of the document, the document versions will appear in this\n            menu.\n          </Text>\n        </StackWrapper>\n      )}\n\n      {filteredChunks.length > 0 && (\n        <ListWrapper direction=\"column\">\n          <CommandList\n            activeItemDataAttr=\"data-hovered\"\n            ariaLabel=\"Document revisions\"\n            autoFocus=\"list\"\n            initialIndex={selectedIndex}\n            initialScrollAlign=\"center\"\n            itemHeight={40}\n            items={filteredChunks}\n            onEndReached={onLoadMore}\n            onEndReachedIndexOffset={20}\n            overscan={5}\n            renderItem={renderItem}\n            wrapAround={false}\n          />\n        </ListWrapper>\n      )}\n    </Root>\n  )\n}\n\nTimeline.displayName = 'Timeline'\n", "import {ErrorOutlineIcon} from '@sanity/icons'\nimport {Flex, Stack} from '@sanity/ui'\nimport React from 'react'\nimport {TextWithTone} from 'sanity'\n\nexport function TimelineError() {\n  return (\n    <Flex align=\"flex-start\" gap={3} padding={4}>\n      <TextWithTone tone=\"critical\">\n        <ErrorOutlineIcon />\n      </TextWithTone>\n      <Stack space={4}>\n        <TextWithTone size={1} tone=\"critical\" weight=\"semibold\">\n          An error occurred whilst retrieving document changes.\n        </TextWithTone>\n        <TextWithTone size={1} tone=\"critical\">\n          Document history transactions have not been affected.\n        </TextWithTone>\n      </Stack>\n    </Flex>\n  )\n}\n", "import {SelectIcon} from '@sanity/icons'\nimport {Button, Placement, Popover, useClickOutside, useGlobalKeyDown, useToast} from '@sanity/ui'\nimport {format} from 'date-fns'\nimport {upperFirst} from 'lodash'\nimport React, {useCallback, useMemo, useState} from 'react'\nimport styled from 'styled-components'\nimport {useDocumentPane} from '../useDocumentPane'\nimport {TimelineError} from './TimelineError'\nimport {formatTimelineEventLabel} from './helpers'\nimport {Timeline} from './timeline'\nimport {Chunk, useTimelineSelector} from 'sanity'\n\ninterface TimelineMenuProps {\n  chunk: Chunk | null\n  mode: 'rev' | 'since'\n  placement?: Placement\n}\n\nconst Root = styled(Popover)`\n  overflow: hidden;\n  overflow: clip;\n`\n\nexport function TimelineMenu({chunk, mode, placement}: TimelineMenuProps) {\n  const {setTimelineRange, setTimelineMode, timelineError, ready, timelineStore, isDeleted} =\n    useDocumentPane()\n  const [open, setOpen] = useState(false)\n  const [button, setButton] = useState<HTMLButtonElement | null>(null)\n  const [popover, setPopover] = useState<HTMLElement | null>(null)\n  const toast = useToast()\n\n  const chunks = useTimelineSelector(timelineStore, (state) => state.chunks)\n  const loading = useTimelineSelector(timelineStore, (state) => state.isLoading)\n  const hasMoreChunks = useTimelineSelector(timelineStore, (state) => state.hasMoreChunks)\n  const realRevChunk = useTimelineSelector(timelineStore, (state) => state.realRevChunk)\n  const sinceTime = useTimelineSelector(timelineStore, (state) => state.sinceTime)\n\n  const handleOpen = useCallback(() => {\n    setTimelineMode(mode)\n    setOpen(true)\n  }, [mode, setTimelineMode])\n\n  const handleClose = useCallback(() => {\n    setTimelineMode('closed')\n    setOpen(false)\n  }, [setTimelineMode])\n\n  const handleClickOutside = useCallback(() => {\n    if (open) {\n      handleClose()\n    }\n  }, [handleClose, open])\n\n  const handleGlobalKeyDown = useCallback(\n    (event: KeyboardEvent) => {\n      if (open && (event.key === 'Escape' || event.key === 'Tab')) {\n        handleClose()\n        button?.focus()\n      }\n    },\n    [button, handleClose, open],\n  )\n\n  useClickOutside(handleClickOutside, [button, popover])\n  useGlobalKeyDown(handleGlobalKeyDown)\n\n  const selectRev = useCallback(\n    (revChunk: Chunk) => {\n      try {\n        const [sinceId, revId] = timelineStore.findRangeForRev(revChunk)\n        setTimelineMode('closed')\n        setTimelineRange(sinceId, revId)\n      } catch (err) {\n        toast.push({\n          closable: true,\n          description: err.message,\n          status: 'error',\n          title: 'Unable to load revision',\n        })\n      }\n    },\n    [setTimelineMode, setTimelineRange, timelineStore, toast],\n  )\n\n  const selectSince = useCallback(\n    (sinceChunk: Chunk) => {\n      try {\n        const [sinceId, revId] = timelineStore.findRangeForSince(sinceChunk)\n        setTimelineMode('closed')\n        setTimelineRange(sinceId, revId)\n      } catch (err) {\n        toast.push({\n          closable: true,\n          description: err.message,\n          status: 'error',\n          title: 'Unable to load revision',\n        })\n      }\n    },\n    [setTimelineMode, setTimelineRange, timelineStore, toast],\n  )\n\n  const handleLoadMore = useCallback(() => {\n    if (!loading) {\n      timelineStore.loadMore()\n    }\n  }, [loading, timelineStore])\n\n  const content = timelineError ? (\n    <TimelineError />\n  ) : (\n    <>\n      {mode === 'rev' && (\n        <Timeline\n          chunks={chunks}\n          firstChunk={realRevChunk}\n          hasMoreChunks={hasMoreChunks}\n          lastChunk={realRevChunk}\n          onLoadMore={handleLoadMore}\n          onSelect={selectRev}\n        />\n      )}\n      {mode === 'since' && (\n        <Timeline\n          chunks={chunks}\n          disabledBeforeFirstChunk\n          firstChunk={realRevChunk}\n          hasMoreChunks={hasMoreChunks}\n          lastChunk={sinceTime}\n          onLoadMore={handleLoadMore}\n          onSelect={selectSince}\n        />\n      )}\n    </>\n  )\n\n  const timeLabel = useFormattedTimestamp(chunk?.endTimestamp || '')\n\n  const revLabel = chunk\n    ? `${upperFirst(formatTimelineEventLabel(chunk.type))}: ${timeLabel}`\n    : 'Latest version'\n\n  const sinceLabel = chunk ? `Since: ${timeLabel}` : 'Since: unknown version'\n\n  const buttonLabel = mode === 'rev' ? revLabel : sinceLabel\n\n  return (\n    <Root\n      constrainSize\n      content={open && content}\n      data-ui=\"versionMenu\"\n      open={open}\n      placement={placement}\n      portal\n      ref={setPopover}\n    >\n      <Button\n        disabled={!ready}\n        mode=\"bleed\"\n        fontSize={1}\n        padding={2}\n        iconRight={SelectIcon}\n        onClick={open ? handleClose : handleOpen}\n        ref={setButton}\n        selected={open}\n        style={{maxWidth: '100%'}}\n        text={ready ? buttonLabel : 'Loading history'}\n      />\n    </Root>\n  )\n}\n\nexport function useFormattedTimestamp(time: string): string {\n  const formatted = useMemo(() => {\n    const parsedDate = time ? new Date(time) : new Date()\n    const formattedDate = format(parsedDate, 'MMM d, yyyy, hh:mm a')\n    return formattedDate\n  }, [time])\n\n  return formatted\n}\n", "import React from 'react'\nimport {Box, Flex, Spinner, Text} from '@sanity/ui'\nimport {Delay} from '../../../../components'\n\nexport function LoadingContent() {\n  return (\n    <Delay ms={300}>\n      <Flex align=\"center\" direction=\"column\" height=\"fill\" justify=\"center\" paddingTop={3}>\n        <Spinner muted />\n        <Box marginTop={3}>\n          <Text align=\"center\" muted size={1}>\n            Loading changes\n          </Text>\n        </Box>\n      </Flex>\n    </Delay>\n  )\n}\n", "import {AnnotationDetails, visitDiff, Diff} from 'sanity'\n\nexport function collectLatestAuthorAnnotations(diff: Diff): AnnotationDetails[] {\n  const authorMap = new Map<string, AnnotationDetails>()\n  visitDiff(diff, (child) => {\n    if (child.action === 'unchanged' || !('annotation' in child) || !child.annotation) {\n      return true\n    }\n\n    const {author, timestamp} = child.annotation\n    const previous = authorMap.get(author)\n    if (!previous || previous.timestamp < timestamp) {\n      authorMap.set(author, child.annotation)\n    }\n\n    return true\n  })\n\n  return Array.from(authorMap.values()).sort((a, b) => (a.timestamp < b.timestamp ? 1 : -1))\n}\n", "import {ObjectDiff} from '@sanity/diff'\nimport {AvatarStack, BoundaryElementProvider, Box, Card, Flex} from '@sanity/ui'\nimport React, {ReactElement, useRef} from 'react'\nimport styled from 'styled-components'\nimport {TimelineMenu} from '../../timeline'\nimport {useDocumentPane} from '../../useDocumentPane'\nimport {DocumentInspectorHeader} from '../../documentInspector'\nimport {LoadingContent} from './LoadingContent'\nimport {collectLatestAuthorAnnotations} from './helpers'\nimport {\n  ChangeFieldWrapper,\n  ChangeList,\n  DiffTooltip,\n  DocumentChangeContext,\n  DocumentChangeContextInstance,\n  DocumentInspectorProps,\n  NoChanges,\n  ObjectSchemaType,\n  ScrollContainer,\n  UserAvatar,\n  useTimelineSelector,\n} from 'sanity'\n\nconst Scroller = styled(ScrollContainer)`\n  height: 100%;\n  overflow: auto;\n  position: relative;\n  scroll-behavior: smooth;\n`\n\nexport function ChangesInspector(props: DocumentInspectorProps): ReactElement {\n  const {onClose} = props\n  const {documentId, schemaType, timelineError, timelineStore, value} = useDocumentPane()\n  const scrollRef = useRef<HTMLDivElement | null>(null)\n\n  // Subscribe to external timeline state changes\n  const diff = useTimelineSelector(timelineStore, (state) => state.diff)\n  const onOlderRevision = useTimelineSelector(timelineStore, (state) => state.onOlderRevision)\n  const selectionState = useTimelineSelector(timelineStore, (state) => state.selectionState)\n  const sinceTime = useTimelineSelector(timelineStore, (state) => state.sinceTime)\n  const loading = selectionState === 'loading'\n  const isComparingCurrent = !onOlderRevision\n\n  const documentContext: DocumentChangeContextInstance = React.useMemo(\n    () => ({\n      documentId,\n      schemaType,\n      FieldWrapper: ChangeFieldWrapper,\n      rootDiff: diff,\n      isComparingCurrent,\n      value,\n    }),\n    [documentId, diff, isComparingCurrent, schemaType, value],\n  )\n\n  const changeAnnotations = React.useMemo(\n    () => (diff ? collectLatestAuthorAnnotations(diff) : []),\n    [diff],\n  )\n\n  return (\n    <Flex data-testid=\"review-changes-pane\" direction=\"column\" height=\"fill\" overflow=\"hidden\">\n      <DocumentInspectorHeader\n        as=\"header\"\n        closeButtonLabel=\"Close review changes\"\n        flex=\"none\"\n        onClose={onClose}\n        title=\"Review changes\"\n      >\n        <Flex gap={1} padding={3} paddingTop={0} paddingBottom={2}>\n          <Box flex={1}>\n            <TimelineMenu mode=\"since\" chunk={sinceTime} placement=\"bottom-start\" />\n          </Box>\n\n          <Box flex=\"none\">\n            <DiffTooltip annotations={changeAnnotations} description=\"Changes by\" portal>\n              <AvatarStack maxLength={4} aria-label=\"Changes by\">\n                {changeAnnotations.map(({author}) => (\n                  <UserAvatar key={author} user={author} />\n                ))}\n              </AvatarStack>\n            </DiffTooltip>\n          </Box>\n        </Flex>\n      </DocumentInspectorHeader>\n\n      <Card flex={1}>\n        <BoundaryElementProvider element={scrollRef.current}>\n          <Scroller data-ui=\"Scroller\" ref={scrollRef}>\n            <Box flex={1} padding={4}>\n              <Content\n                diff={diff}\n                documentContext={documentContext}\n                error={timelineError}\n                loading={loading}\n                schemaType={schemaType}\n              />\n            </Box>\n          </Scroller>\n        </BoundaryElementProvider>\n      </Card>\n    </Flex>\n  )\n}\n\nfunction Content({\n  error,\n  diff,\n  documentContext,\n  loading,\n  schemaType,\n}: {\n  error?: Error | null\n  diff: ObjectDiff<any> | null\n  documentContext: DocumentChangeContextInstance\n  loading: boolean\n  schemaType: ObjectSchemaType\n}) {\n  if (error) {\n    return <NoChanges />\n  }\n\n  if (loading) {\n    return <LoadingContent />\n  }\n\n  if (!diff) {\n    return <NoChanges />\n  }\n\n  return (\n    <DocumentChangeContext.Provider value={documentContext}>\n      <ChangeList diff={diff} schemaType={schemaType} />\n    </DocumentChangeContext.Provider>\n  )\n}\n", "import {RestoreIcon} from '@sanity/icons'\nimport {HISTORY_INSPECTOR_NAME} from '../../constants'\nimport {useDeskTool} from '../../../../useDeskTool'\nimport {ChangesInspector} from './ChangesInspector'\nimport {DocumentInspector} from 'sanity'\n\nexport const changesInspector: DocumentInspector = {\n  name: HISTORY_INSPECTOR_NAME,\n  useMenuItem: () => {\n    const {features} = useDeskTool()\n\n    return {\n      hidden: !features.reviewChanges,\n      icon: RestoreIcon,\n      title: 'Review changes',\n    }\n  },\n  component: ChangesInspector,\n  onClose: ({params}) => ({params: {...params, since: undefined}}),\n  onOpen: ({params}) => ({params: {...params, since: '@lastPublished'}}),\n}\n", "import {MasterDetailIcon} from '@sanity/icons'\nimport {lazy} from 'react'\nimport {\n  DeleteAction,\n  DiscardChangesAction,\n  DuplicateAction,\n  HistoryRestoreAction,\n  PublishAction,\n  UnpublishAction,\n} from './documentActions'\nimport {LiveEditBadge} from './documentBadges'\nimport {getIntentState} from './getIntentState'\nimport {router} from './router'\nimport {DeskToolOptions} from './types'\nimport {validationInspector} from './panes/document/inspectors/validation'\nimport {changesInspector} from './panes/document/inspectors/changes'\nimport {definePlugin} from 'sanity'\n\nconst documentActions = [\n  PublishAction,\n  UnpublishAction,\n  DiscardChangesAction,\n  DuplicateAction,\n  DeleteAction,\n  HistoryRestoreAction,\n]\n\nconst documentBadges = [LiveEditBadge]\n\nconst inspectors = [validationInspector, changesInspector]\n\n/**\n * The deskTool is a studio plugin which adds the “desk tool” – a tool within Sanity Studio in which\n * content editors can drill down to specific documents to edit them.\n * You can configure your Studio's desk tool(s).\n *\n * @public\n * @param options - Options for the desk tool. See {@link DeskToolOptions}\n * @example Minimal example\n * ```ts\n * // sanity.config.ts\n * import { defineConfig } from 'sanity'\n * import { deskTool } from 'sanity/desk'\n *\n * export default defineConfig((\n *  // ...\n *  plugins: [\n *    deskTool() // use defaults\n *  ]\n * })\n * ```\n *\n * @example To customise your desk tool\n * ```ts\n * // sanity.config.ts\n * import { defineConfig } from 'sanity'\n * import { deskTool } from 'sanity/desk'\n * import { FaCar } from 'react-icons'\n\n * export default defineConfig((\n *\t // ...\n *   plugins: [\n *    deskTool({\n *      name: 'cars',\n *      title: 'Cars',\n *      icon: FaCar,\n *      structure: (S) => S.documentTypeList('car'),\n *      defaultDocumentNode: (S) =>\n *        S.document().views([\n *          S.view.form(),\n *          S.view.component(Preview).title('Preview')\n *        ])\n *    })\n *  ]\n * })\n * ```\n * */\nexport const deskTool = definePlugin<DeskToolOptions | void>((options) => ({\n  name: '@sanity/desk-tool',\n  document: {\n    actions: (prevActions) => {\n      // NOTE: since it's possible to have several desk tools in one Studio,\n      // we need to check whether the document actions already exist in the Studio config\n      return Array.from(new Set([...prevActions, ...documentActions]))\n    },\n    badges: (prevBadges) => {\n      // NOTE: since it's possible to have several desk tools in one Studio,\n      // we need to check whether the document badges already exist in the Studio config\n      return Array.from(new Set([...prevBadges, ...documentBadges]))\n    },\n    inspectors: (prevInspectors) => {\n      // NOTE: since it's possible to have several desk tools in one Studio,\n      // we need to check whether the inspectors already exist in the Studio config\n      return Array.from(new Set([...prevInspectors, ...inspectors]))\n    },\n  },\n  tools: [\n    {\n      name: options?.name || 'desk',\n      title: options?.title || 'Desk',\n      icon: options?.icon || MasterDetailIcon,\n      component: lazy(() => import('./components/deskTool')),\n      canHandleIntent: (intent, params) => {\n        return Boolean(\n          (intent === 'edit' && params.id) ||\n            (intent === 'create' && params.type) ||\n            (intent === 'create' && params.template),\n        )\n      },\n      // Controlled by sanity/src/desk/components/deskTool/DeskTitle.tsx\n      controlsDocumentTitle: true,\n      getIntentState,\n      options,\n      router,\n    },\n  ],\n}))\n", "import {BinaryDocumentIcon, EarthAmericasIcon} from '@sanity/icons'\nimport {DeskToolFeatures, PaneMenuItem} from '../../types'\nimport {INSPECT_ACTION_PREFIX} from './constants'\nimport {DocumentInspector, DocumentInspectorMenuItem, ValidationMarker} from 'sanity'\n\ninterface GetMenuItemsParams {\n  currentInspector?: DocumentInspector\n  features: DeskToolFeatures\n  hasValue: boolean\n  inspectors: DocumentInspector[]\n  previewUrl?: string | null\n  inspectorMenuItems: DocumentInspectorMenuItem[]\n}\n\nfunction getInspectorItems({\n  currentInspector,\n  hasValue,\n  inspectors,\n  inspectorMenuItems,\n}: GetMenuItemsParams): PaneMenuItem[] {\n  return inspectors\n    .map((inspector, index) => {\n      const menuItem = inspectorMenuItems[index]\n\n      if (!menuItem || menuItem.hidden) return null\n\n      return {\n        action: `${INSPECT_ACTION_PREFIX}${inspector.name}`,\n        group: menuItem.showAsAction ? undefined : 'inspectors',\n        icon: menuItem.icon,\n        isDisabled: !hasValue,\n        selected: currentInspector?.name === inspector.name,\n        shortcut: menuItem.hotkeys?.join('+'),\n        showAsAction: menuItem.showAsAction,\n        title: menuItem.title,\n        tone: menuItem.tone,\n      }\n    })\n    .filter(Boolean) as PaneMenuItem[]\n}\n\nfunction getInspectItem({hasValue}: GetMenuItemsParams): PaneMenuItem {\n  return {\n    action: 'inspect',\n    group: 'inspectors',\n    title: 'Inspect',\n    icon: BinaryDocumentIcon,\n    isDisabled: !hasValue,\n    shortcut: 'Ctrl+Alt+I',\n  }\n}\n\nexport function getProductionPreviewItem({previewUrl}: GetMenuItemsParams): PaneMenuItem | null {\n  if (!previewUrl) return null\n\n  return {\n    action: 'production-preview',\n    group: 'links',\n    title: 'Open preview',\n    icon: EarthAmericasIcon,\n    shortcut: 'Ctrl+Alt+O',\n  }\n}\n\nexport function getMenuItems(params: GetMenuItemsParams): PaneMenuItem[] {\n  const inspectorItems = getInspectorItems(params)\n  const items = [\n    // Get production preview item\n    getProductionPreviewItem(params),\n  ].filter(Boolean) as PaneMenuItem[]\n\n  return [\n    ...inspectorItems,\n\n    // TODO: convert to inspector or document view?\n    getInspectItem(params),\n\n    ...items,\n  ]\n}\n", "import {useEffect, useState} from 'react'\nimport {SanityDocument} from '@sanity/types'\nimport {useAsObservable} from 'react-rx'\nimport {debounceTime, switchMap, catchError} from 'rxjs/operators'\nimport {from, of} from 'rxjs'\nimport {useSource, isRecord} from 'sanity'\n\nconst isSanityDocument = (value: unknown): value is SanityDocument =>\n  isRecord(value) && typeof value._id === 'string' && typeof value._type === 'string'\n\nexport function usePreviewUrl(value: Partial<SanityDocument> | undefined): string | undefined {\n  const [previewUrl, setPreviewUrl] = useState<string | undefined>(undefined)\n  const [error, setError] = useState<unknown>(null)\n  const {resolveProductionUrl} = useSource().document\n  // @todo refactor out of useAsObservable, and instead use `of() + useMemoObservable` like we did for `useLoadableFromCreateLoadable`\n  const value$ = useAsObservable(value)\n\n  if (error) throw error\n\n  useEffect(() => {\n    value$\n      .pipe(\n        // this so that the preview URL isn't fetched on every keystroke\n        debounceTime(500),\n        switchMap((document) =>\n          isSanityDocument(document) ? from(resolveProductionUrl({document})) : of(undefined),\n        ),\n        catchError((e) => {\n          const message = isRecord(e) && typeof e.message === 'string' ? e.message : 'Unknown error'\n          throw new Error(`An error was thrown while trying to get your preview url: ${message}`)\n        }),\n      )\n      .subscribe({\n        next: setPreviewUrl,\n        error: setError,\n      })\n  }, [resolveProductionUrl, value$])\n\n  return previewUrl\n}\n", "import {Template} from 'sanity'\n\ninterface InitialValueOptions {\n  documentType: string\n  panePayload?: unknown\n  templateName?: string\n  templateParams?: Record<string, unknown>\n  urlTemplate?: string\n}\n\n/**\n * @internal\n */\nexport function getInitialValueTemplateOpts(\n  templates: Template[],\n  opts: InitialValueOptions,\n): {templateName: string; templateParams: Record<string, unknown>} {\n  const payload = opts.panePayload || {}\n  const structureNodeTemplate = opts.templateName\n\n  if (opts.urlTemplate && structureNodeTemplate && structureNodeTemplate !== opts.urlTemplate) {\n    // eslint-disable-next-line no-console\n    console.warn(\n      `Conflicting templates: URL says \"${opts.urlTemplate}\", structure node says \"${structureNodeTemplate}\". Using \"${structureNodeTemplate}\".`,\n    )\n  }\n\n  const template = structureNodeTemplate || opts.urlTemplate\n  const typeTemplates = templates.filter((t) => t.schemaType === opts.documentType)\n\n  const templateParams = {\n    ...opts.templateParams,\n    ...(typeof payload === 'object' ? payload || {} : {}),\n  }\n\n  let templateName = template\n\n  // If we have not specified a specific template, and we only have a single\n  // template available for a schema type, use it\n  if (!template && typeTemplates.length === 1) {\n    templateName = typeTemplates[0].id\n  }\n\n  return {templateName: templateName!, templateParams}\n}\n", "import React, {memo, useCallback, useEffect, useRef, useState} from 'react'\nimport {DocumentInspector, DocumentInspectorMenuItem, useUnique} from 'sanity'\n\ninterface InspectorMenuItemProps {\n  documentId: string\n  documentType: string\n  index: number\n  setMenuItem: (index: number, node: DocumentInspectorMenuItem) => void\n  useMenuItem: NonNullable<DocumentInspector['useMenuItem']>\n}\n\nconst InspectorMenuItem = memo(function InspectorMenuItem(props: InspectorMenuItemProps) {\n  const {documentId, documentType, index, setMenuItem, useMenuItem} = props\n\n  const node = useUnique(\n    useMenuItem({\n      documentId,\n      documentType,\n    }),\n  )\n\n  useEffect(() => {\n    setMenuItem(index, node)\n  }, [index, node, setMenuItem])\n\n  return <></>\n})\n\ninterface DocumentInspectorMenuItemsResolverProps {\n  documentId: string\n  documentType: string\n  inspectors: DocumentInspector[]\n  onMenuItems: (items: DocumentInspectorMenuItem[]) => void\n}\n\n// The menu item in a document inspector are resolved in a React hook (`useMenuItem`).\n// This means that the menu item needs to be resolved in a React component (in accordance with the rules of hooks).\n// In this component, we map over the configured inspectors and render a `InspectorMenuItem` for each.\n// The `InspectorMenuItem` will resolve the menu item in a React hook and call the `setMenuItem` callback\n// with the resolved menu item and the index of the inspector.\n// Finally, we call the `onMenuItems` callback with the resolved menu items.\nexport function DocumentInspectorMenuItemsResolver(props: DocumentInspectorMenuItemsResolverProps) {\n  const {documentId, documentType, inspectors, onMenuItems} = props\n\n  const len = inspectors.length\n  const lenRef = useRef(len)\n\n  const [menuItems, setMenuItems] = useState<DocumentInspectorMenuItem[]>(() =>\n    Array.from(new Array(len)),\n  )\n\n  const menuItemsRef = useRef(menuItems)\n\n  useEffect(() => {\n    if (lenRef.current !== len) {\n      const newFieldActions = Array.from(new Array(len))\n\n      for (let i = 0; i < len; i++) {\n        newFieldActions[i] = menuItemsRef.current[i]\n      }\n\n      lenRef.current = len\n\n      setMenuItems(() => {\n        menuItemsRef.current = newFieldActions\n        return newFieldActions\n      })\n    }\n  }, [len])\n\n  const setMenuItem = useCallback((index: number, node: DocumentInspectorMenuItem) => {\n    setMenuItems((prev) => {\n      const next = [...prev]\n      next[index] = node\n      menuItemsRef.current = next\n      return next\n    })\n  }, [])\n\n  useEffect(() => {\n    onMenuItems(menuItems.filter(Boolean))\n  }, [menuItems, onMenuItems])\n\n  return (\n    <>\n      {inspectors.map(\n        (inspector, inspectorIndex) =>\n          inspector.useMenuItem && (\n            <InspectorMenuItem\n              documentId={documentId}\n              documentType={documentType}\n              index={inspectorIndex}\n              key={inspector.name}\n              setMenuItem={setMenuItem}\n              useMenuItem={inspector.useMenuItem}\n            />\n          ),\n      )}\n    </>\n  )\n}\n", "import React, {memo, useCallback, useEffect, useMemo, useRef, useState} from 'react'\nimport {ObjectSchemaType, Path, SanityDocument, SanityDocumentLike} from '@sanity/types'\nimport {omit, set} from 'lodash'\nimport {useToast} from '@sanity/ui'\nimport {fromString as pathFromString, resolveKeyedPath} from '@sanity/util/paths'\nimport isHotkey from 'is-hotkey'\nimport {isActionEnabled} from '@sanity/schema/_internal'\nimport {usePaneRouter} from '../../components'\nimport {PaneMenuItem} from '../../types'\nimport {useDeskTool} from '../../useDeskTool'\nimport {DocumentPaneContext, DocumentPaneContextValue} from './DocumentPaneContext'\nimport {getMenuItems} from './menuItems'\nimport {DocumentPaneProviderProps} from './types'\nimport {usePreviewUrl} from './usePreviewUrl'\nimport {getInitialValueTemplateOpts} from './getInitialValueTemplateOpts'\nimport {\n  DEFAULT_MENU_ITEM_GROUPS,\n  EMPTY_PARAMS,\n  HISTORY_INSPECTOR_NAME,\n  INSPECT_ACTION_PREFIX,\n} from './constants'\nimport {DocumentInspectorMenuItemsResolver} from './DocumentInspectorMenuItemsResolver'\nimport {\n  DocumentInspector,\n  DocumentPresence,\n  PatchEvent,\n  StateTree,\n  toMutationPatches,\n  getExpandOperations,\n  getPublishedId,\n  setAtPath,\n  useConnectionState,\n  useDocumentOperation,\n  useEditState,\n  useFormState,\n  useInitialValue,\n  usePresenceStore,\n  useSchema,\n  useSource,\n  useTemplates,\n  useUnique,\n  useValidationStatus,\n  getDraftId,\n  useDocumentValuePermissions,\n  useTimelineStore,\n  useTimelineSelector,\n  DocumentFieldAction,\n  DocumentInspectorMenuItem,\n  FieldActionsResolver,\n  EMPTY_ARRAY,\n  DocumentFieldActionNode,\n  FieldActionsProvider,\n} from 'sanity'\n\n/**\n * @internal\n */\n// eslint-disable-next-line complexity, max-statements\nexport const DocumentPaneProvider = memo((props: DocumentPaneProviderProps) => {\n  const {children, index, pane, paneKey} = props\n  const schema = useSchema()\n  const templates = useTemplates()\n  const {\n    actions: documentActions,\n    badges: documentBadges,\n    unstable_fieldActions: fieldActionsResolver,\n    unstable_languageFilter: languageFilterResolver,\n    inspectors: inspectorsResolver,\n  } = useSource().document\n  const presenceStore = usePresenceStore()\n  const paneRouter = usePaneRouter()\n  const setPaneParams = paneRouter.setParams\n  const {features} = useDeskTool()\n  const {push: pushToast} = useToast()\n  const {\n    options,\n    menuItemGroups = DEFAULT_MENU_ITEM_GROUPS,\n    title = null,\n    views: viewsProp = [],\n  } = pane\n  const paneOptions = useUnique(options)\n  const documentIdRaw = paneOptions.id\n  const documentId = getPublishedId(documentIdRaw)\n  const documentType = options.type\n  const params = useUnique(paneRouter.params) || EMPTY_PARAMS\n  const panePayload = useUnique(paneRouter.payload)\n  const {templateName, templateParams} = useMemo(\n    () =>\n      getInitialValueTemplateOpts(templates, {\n        documentType,\n        templateName: paneOptions.template,\n        templateParams: paneOptions.templateParameters,\n        panePayload,\n        urlTemplate: params.template,\n      }),\n    [documentType, paneOptions, params, panePayload, templates],\n  )\n  const initialValueRaw = useInitialValue({\n    documentId,\n    documentType,\n    templateName,\n    templateParams,\n  })\n  const initialValue = useUnique(initialValueRaw)\n  const {patch} = useDocumentOperation(documentId, documentType)\n  const editState = useEditState(documentId, documentType)\n  const {validation: validationRaw} = useValidationStatus(documentId, documentType)\n  const connectionState = useConnectionState(documentId, documentType)\n  const schemaType = schema.get(documentType) as ObjectSchemaType | undefined\n  const value: SanityDocumentLike = editState?.draft || editState?.published || initialValue.value\n  const [isDeleting, setIsDeleting] = useState(false)\n\n  const [inspectorMenuItems, setInspectorMenuItems] = useState<DocumentInspectorMenuItem[]>([])\n\n  // Resolve document actions\n  const actions = useMemo(\n    () => documentActions({schemaType: documentType, documentId}),\n    [documentActions, documentId, documentType],\n  )\n\n  // Resolve document badges\n  const badges = useMemo(\n    () => documentBadges({schemaType: documentType, documentId}),\n    [documentBadges, documentId, documentType],\n  )\n\n  // Resolve document language filter\n  const languageFilter = useMemo(\n    () => languageFilterResolver({schemaType: documentType, documentId}),\n    [documentId, documentType, languageFilterResolver],\n  )\n\n  const validation = useUnique(validationRaw)\n  const views = useUnique(viewsProp)\n\n  const [focusPath, setFocusPath] = useState<Path>(() =>\n    params.path ? pathFromString(params.path) : [],\n  )\n  const activeViewId = params.view || (views[0] && views[0].id) || null\n  const [timelineMode, setTimelineMode] = useState<'since' | 'rev' | 'closed'>('closed')\n\n  const [timelineError, setTimelineError] = useState<Error | null>(null)\n  /**\n   * Create an intermediate store which handles document Timeline + TimelineController\n   * creation, and also fetches pre-requsite document snapshots. Compatible with `useSyncExternalStore`\n   * and made available to child components via DocumentPaneContext.\n   */\n  const timelineStore = useTimelineStore({\n    documentId,\n    documentType,\n    onError: setTimelineError,\n    rev: params.rev,\n    since: params.since,\n  })\n\n  // Subscribe to external timeline state changes\n  const onOlderRevision = useTimelineSelector(timelineStore, (state) => state.onOlderRevision)\n  const revTime = useTimelineSelector(timelineStore, (state) => state.revTime)\n  const sinceAttributes = useTimelineSelector(timelineStore, (state) => state.sinceAttributes)\n  const timelineDisplayed = useTimelineSelector(timelineStore, (state) => state.timelineDisplayed)\n  const timelineReady = useTimelineSelector(timelineStore, (state) => state.timelineReady)\n  const isPristine = useTimelineSelector(timelineStore, (state) => state.isPristine)\n\n  /**\n   * Determine if the current document is deleted.\n   *\n   * When the timeline is available – we check for the absence of an editable document pair\n   * (both draft + published versions) as well as a non 'pristine' timeline (i.e. a timeline that consists\n   * of at least one chunk).\n   *\n   * In the _very rare_ case where the timeline cannot be loaded – we skip this check and always assume\n   * the document is NOT deleted. Since we can't accurately determine document deleted status without history,\n   * skipping this check means that in these cases, users will at least be able to create new documents\n   * without them being incorrectly marked as deleted.\n   */\n  const isDeleted = useMemo(() => {\n    if (!timelineReady) {\n      return false\n    }\n    return Boolean(!editState?.draft && !editState?.published) && !isPristine\n  }, [editState?.draft, editState?.published, isPristine, timelineReady])\n\n  // TODO: this may cause a lot of churn. May be a good idea to prevent these\n  // requests unless the menu is open somehow\n  const previewUrl = usePreviewUrl(value)\n\n  const [presence, setPresence] = useState<DocumentPresence[]>([])\n  useEffect(() => {\n    const subscription = presenceStore.documentPresence(documentId).subscribe((nextPresence) => {\n      setPresence(nextPresence)\n    })\n    return () => {\n      subscription.unsubscribe()\n    }\n  }, [documentId, presenceStore])\n\n  const inspectors: DocumentInspector[] = useMemo(\n    () => inspectorsResolver({documentId, documentType}),\n    [documentId, documentType, inspectorsResolver],\n  )\n\n  const [inspectorName, setInspectorName] = useState<string | null>(() => params.inspect || null)\n\n  // Handle inspector name changes from URL\n  const inspectParamRef = useRef<string | undefined>(params.inspect)\n  useEffect(() => {\n    if (inspectParamRef.current !== params.inspect) {\n      inspectParamRef.current = params.inspect\n      setInspectorName(params.inspect || null)\n    }\n  }, [params.inspect])\n\n  const currentInspector = inspectors?.find((i) => i.name === inspectorName)\n  const resolvedChangesInspector = inspectors.find((i) => i.name === HISTORY_INSPECTOR_NAME)\n\n  const changesOpen = currentInspector?.name === HISTORY_INSPECTOR_NAME\n\n  const hasValue = Boolean(value)\n  const menuItems = useMemo(\n    () =>\n      getMenuItems({\n        currentInspector,\n        features,\n        hasValue,\n        inspectorMenuItems,\n        inspectors,\n        previewUrl,\n      }),\n    [currentInspector, features, hasValue, inspectorMenuItems, inspectors, previewUrl],\n  )\n  const inspectOpen = params.inspect === 'on'\n  const compareValue: Partial<SanityDocument> | null = changesOpen\n    ? sinceAttributes\n    : editState?.published || null\n\n  const fieldActions: DocumentFieldAction[] = useMemo(\n    () => (schemaType ? fieldActionsResolver({documentId, documentType, schemaType}) : []),\n    [documentId, documentType, fieldActionsResolver, schemaType],\n  )\n\n  /**\n   * Note that in addition to connection and edit state, we also wait for a valid document timeline\n   * range to be loaded. This means if we're loading an older revision, the full transaction range must\n   * be loaded in full prior to the document being displayed.\n   *\n   * Previously, visiting studio URLs with timeline params would display the 'current' document and then\n   * 'snap' in the older revision, which was disorienting and could happen mid-edit.\n   *\n   * In the event that the timeline cannot be loaded due to TimelineController errors or blocked requests,\n   * we skip this readiness check to ensure that users aren't locked out of editing. Trying to select\n   * a timeline revision in this instance will display an error localized to the popover itself.\n   */\n  const ready =\n    connectionState === 'connected' && editState.ready && (timelineReady || !!timelineError)\n\n  const displayed: Partial<SanityDocument> | undefined = useMemo(\n    () => (onOlderRevision ? timelineDisplayed || {_id: value._id, _type: value._type} : value),\n    [onOlderRevision, timelineDisplayed, value],\n  )\n\n  const setTimelineRange = useCallback(\n    (newSince: string, newRev: string | null) => {\n      setPaneParams({\n        ...params,\n        since: newSince,\n        rev: newRev || undefined,\n      })\n    },\n    [params, setPaneParams],\n  )\n\n  const handleFocus = useCallback(\n    (nextFocusPath: Path) => {\n      setFocusPath(nextFocusPath)\n      presenceStore.setLocation([\n        {\n          type: 'document',\n          documentId,\n          path: nextFocusPath,\n          lastActiveAt: new Date().toISOString(),\n        },\n      ])\n    },\n    [documentId, presenceStore, setFocusPath],\n  )\n\n  const handleBlur = useCallback(\n    (blurredPath: Path) => {\n      setFocusPath([])\n      // note: we're deliberately not syncing presence here since it would make the user avatar disappear when a\n      // user clicks outside a field without focusing another one\n    },\n    [setFocusPath],\n  )\n\n  const patchRef = useRef<(event: PatchEvent) => void>(() => {\n    throw new Error('Nope')\n  })\n\n  patchRef.current = (event: PatchEvent) => {\n    patch.execute(toMutationPatches(event.patches), initialValue.value)\n  }\n\n  const handleChange = useCallback((event: PatchEvent) => patchRef.current(event), [])\n\n  const closeInspector = useCallback(\n    (closeInspectorName?: string) => {\n      // inspector?: DocumentInspector\n      const inspector = closeInspectorName && inspectors.find((i) => i.name === closeInspectorName)\n\n      if (closeInspectorName && !inspector) {\n        console.warn(`No inspector named \"${closeInspectorName}\"`)\n        return\n      }\n\n      if (!currentInspector) {\n        return\n      }\n\n      if (inspector) {\n        const result = inspector.onClose?.({params}) ?? {params}\n\n        setInspectorName(null)\n        inspectParamRef.current = undefined\n\n        setPaneParams({...result.params, inspect: undefined})\n\n        return\n      }\n\n      if (currentInspector) {\n        const result = currentInspector.onClose?.({params}) ?? {params}\n\n        setInspectorName(null)\n        inspectParamRef.current = undefined\n\n        setPaneParams({...result.params, inspect: undefined})\n      }\n    },\n    [currentInspector, inspectors, params, setPaneParams],\n  )\n\n  const openInspector = useCallback(\n    (nextInspectorName: string, paneParams?: Record<string, string>) => {\n      const nextInspector = inspectors.find((i) => i.name === nextInspectorName)\n\n      if (!nextInspector) {\n        console.warn(`No inspector named \"${nextInspectorName}\"`)\n        return\n      }\n\n      // if the inspector is already open, only update params\n      if (currentInspector?.name === nextInspector.name) {\n        setPaneParams({...params, ...paneParams, inspect: nextInspector.name})\n        return\n      }\n\n      let currentParams = params\n\n      if (currentInspector) {\n        const closeResult = nextInspector.onClose?.({params: currentParams}) ?? {\n          params: currentParams,\n        }\n\n        currentParams = closeResult.params\n      }\n\n      const result = nextInspector.onOpen?.({params: currentParams}) ?? {params: currentParams}\n\n      setInspectorName(nextInspector.name)\n      inspectParamRef.current = nextInspector.name\n\n      setPaneParams({...result.params, ...paneParams, inspect: nextInspector.name})\n    },\n    [currentInspector, inspectors, params, setPaneParams],\n  )\n\n  const handleHistoryClose = useCallback(() => {\n    if (resolvedChangesInspector) {\n      closeInspector(resolvedChangesInspector.name)\n    }\n  }, [closeInspector, resolvedChangesInspector])\n\n  const handleHistoryOpen = useCallback(() => {\n    if (!features.reviewChanges) {\n      return\n    }\n\n    if (resolvedChangesInspector) {\n      openInspector(resolvedChangesInspector.name)\n    }\n  }, [features.reviewChanges, openInspector, resolvedChangesInspector])\n\n  const handlePaneClose = useCallback(() => paneRouter.closeCurrent(), [paneRouter])\n\n  const handlePaneSplit = useCallback(() => paneRouter.duplicateCurrent(), [paneRouter])\n\n  const toggleLegacyInspect = useCallback(\n    (toggle = !inspectOpen) => {\n      if (toggle) {\n        setPaneParams({...params, inspect: 'on'})\n      } else {\n        setPaneParams(omit(params, 'inspect'))\n      }\n    },\n    [inspectOpen, params, setPaneParams],\n  )\n\n  const handleMenuAction = useCallback(\n    (item: PaneMenuItem) => {\n      if (item.action === 'production-preview' && previewUrl) {\n        window.open(previewUrl)\n        return true\n      }\n\n      if (item.action === 'inspect') {\n        toggleLegacyInspect(true)\n        return true\n      }\n\n      if (item.action === 'reviewChanges') {\n        handleHistoryOpen()\n        return true\n      }\n\n      if (typeof item.action === 'string' && item.action.startsWith(INSPECT_ACTION_PREFIX)) {\n        const nextInspectorName = item.action.slice(INSPECT_ACTION_PREFIX.length)\n        const nextInspector = inspectors.find((i) => i.name === nextInspectorName)\n\n        if (nextInspector) {\n          if (nextInspector.name === inspectorName) {\n            closeInspector(nextInspector.name)\n          } else {\n            openInspector(nextInspector.name)\n          }\n          return true\n        }\n      }\n\n      return false\n    },\n    [\n      closeInspector,\n      handleHistoryOpen,\n      inspectorName,\n      inspectors,\n      openInspector,\n      previewUrl,\n      toggleLegacyInspect,\n    ],\n  )\n\n  const handleKeyUp = useCallback(\n    (event: React.KeyboardEvent<HTMLDivElement>) => {\n      for (const item of menuItems) {\n        if (item.shortcut) {\n          if (isHotkey(item.shortcut, event)) {\n            event.preventDefault()\n            event.stopPropagation()\n            handleMenuAction(item)\n            return\n          }\n        }\n      }\n    },\n    [handleMenuAction, menuItems],\n  )\n\n  const handleLegacyInspectClose = useCallback(\n    () => toggleLegacyInspect(false),\n    [toggleLegacyInspect],\n  )\n\n  const [openPath, onSetOpenPath] = useState<Path>([])\n  const [fieldGroupState, onSetFieldGroupState] = useState<StateTree<string>>()\n  const [collapsedPaths, onSetCollapsedPath] = useState<StateTree<boolean>>()\n  const [collapsedFieldSets, onSetCollapsedFieldSets] = useState<StateTree<boolean>>()\n\n  const handleOnSetCollapsedPath = useCallback((path: Path, collapsed: boolean) => {\n    onSetCollapsedPath((prevState) => setAtPath(prevState, path, collapsed))\n  }, [])\n\n  const handleOnSetCollapsedFieldSet = useCallback((path: Path, collapsed: boolean) => {\n    onSetCollapsedFieldSets((prevState) => setAtPath(prevState, path, collapsed))\n  }, [])\n\n  const handleSetActiveFieldGroup = useCallback(\n    (path: Path, groupName: string) =>\n      onSetFieldGroupState((prevState) => setAtPath(prevState, path, groupName)),\n    [],\n  )\n\n  const requiredPermission = value._createdAt ? 'update' : 'create'\n  const liveEdit = Boolean(schemaType?.liveEdit)\n  const docId = value._id ? value._id : 'dummy-id'\n  const docPermissionsInput = useMemo(() => {\n    return {\n      ...value,\n      _id: liveEdit ? getPublishedId(docId) : getDraftId(docId),\n    }\n  }, [liveEdit, value, docId])\n\n  const [permissions, isPermissionsLoading] = useDocumentValuePermissions({\n    document: docPermissionsInput,\n    permission: requiredPermission,\n  })\n\n  const isNonExistent = !value?._id\n\n  const readOnly = useMemo(() => {\n    const hasNoPermission = !isPermissionsLoading && !permissions?.granted\n    const updateActionDisabled = !isActionEnabled(schemaType!, 'update')\n    const createActionDisabled = isNonExistent && !isActionEnabled(schemaType!, 'create')\n    const reconnecting = connectionState === 'reconnecting'\n    const isLocked = editState.transactionSyncLock?.enabled\n\n    return (\n      !ready ||\n      revTime !== null ||\n      hasNoPermission ||\n      updateActionDisabled ||\n      createActionDisabled ||\n      reconnecting ||\n      isLocked ||\n      isDeleting ||\n      isDeleted\n    )\n  }, [\n    connectionState,\n    editState.transactionSyncLock,\n    isNonExistent,\n    isDeleted,\n    isDeleting,\n    isPermissionsLoading,\n    permissions?.granted,\n    ready,\n    revTime,\n    schemaType,\n  ])\n\n  const formState = useFormState(schemaType!, {\n    value: displayed,\n    readOnly,\n    comparisonValue: compareValue,\n    focusPath,\n    openPath,\n    collapsedPaths,\n    presence,\n    validation,\n    collapsedFieldSets,\n    fieldGroupState,\n    changesOpen,\n  })\n\n  const formStateRef = useRef(formState)\n  formStateRef.current = formState\n\n  const setOpenPath = useCallback(\n    (path: Path) => {\n      const ops = getExpandOperations(formStateRef.current!, path)\n      ops.forEach((op) => {\n        if (op.type === 'expandPath') {\n          onSetCollapsedPath((prevState) => setAtPath(prevState, op.path, false))\n        }\n        if (op.type === 'expandFieldSet') {\n          onSetCollapsedFieldSets((prevState) => setAtPath(prevState, op.path, false))\n        }\n        if (op.type === 'setSelectedGroup') {\n          onSetFieldGroupState((prevState) => setAtPath(prevState, op.path, op.groupName))\n        }\n      })\n      onSetOpenPath(path)\n    },\n    [formStateRef],\n  )\n\n  const documentPane: DocumentPaneContextValue = {\n    actions,\n    activeViewId,\n    badges,\n    changesOpen,\n    closeInspector,\n    collapsedFieldSets,\n    collapsedPaths,\n    compareValue,\n    connectionState,\n    displayed,\n    documentId,\n    documentIdRaw,\n    documentType,\n    editState,\n    fieldActions,\n    focusPath,\n    inspector: currentInspector || null,\n    inspectors,\n    menuItems,\n    onBlur: handleBlur,\n    onChange: handleChange,\n    onFocus: handleFocus,\n    onPathOpen: setOpenPath,\n    onHistoryClose: handleHistoryClose,\n    onHistoryOpen: handleHistoryOpen,\n    onInspectClose: handleLegacyInspectClose,\n    onKeyUp: handleKeyUp,\n    onMenuAction: handleMenuAction,\n    onPaneClose: handlePaneClose,\n    onPaneSplit: handlePaneSplit,\n    onSetActiveFieldGroup: handleSetActiveFieldGroup,\n    onSetCollapsedPath: handleOnSetCollapsedPath,\n    onSetCollapsedFieldSet: handleOnSetCollapsedFieldSet,\n    openInspector,\n    index,\n    inspectOpen,\n    validation,\n    menuItemGroups: menuItemGroups || [],\n    paneKey,\n    previewUrl,\n    ready,\n    schemaType: schemaType!,\n    isPermissionsLoading,\n    permissions,\n    setTimelineMode,\n    setTimelineRange,\n    setIsDeleting,\n    isDeleting,\n    isDeleted,\n    timelineError,\n    timelineMode,\n    timelineStore,\n    title,\n    value,\n    views,\n    formState,\n    unstable_languageFilter: languageFilter,\n  }\n\n  useEffect(() => {\n    if (connectionState === 'reconnecting') {\n      pushToast({\n        id: 'sanity/desk/reconnecting',\n        status: 'warning',\n        title: <>Connection lost. Reconnecting…</>,\n      })\n    }\n  }, [connectionState, pushToast])\n\n  // Reset `focusPath` when `documentId` or `params.path` changes\n  useEffect(() => {\n    if (ready && params.path) {\n      const {path, ...restParams} = params\n      const pathFromUrl = resolveKeyedPath(formStateRef.current?.value, pathFromString(path))\n      // Reset focus path when url params path changes\n      setFocusPath(pathFromUrl)\n      setOpenPath(pathFromUrl)\n      // remove the `path`-param from url after we have consumed it as the initial focus path\n      paneRouter.setParams(restParams)\n    }\n  }, [params, documentId, setOpenPath, ready, paneRouter])\n\n  const [rootFieldActionNodes, setRootFieldActionNodes] = useState<DocumentFieldActionNode[]>([])\n\n  return (\n    <DocumentPaneContext.Provider value={documentPane}>\n      {inspectors.length > 0 && (\n        <DocumentInspectorMenuItemsResolver\n          documentId={documentId}\n          documentType={documentType}\n          inspectors={inspectors}\n          onMenuItems={setInspectorMenuItems}\n        />\n      )}\n\n      {/* Resolve root-level field actions */}\n      {fieldActions.length > 0 && schemaType && (\n        <FieldActionsResolver\n          actions={fieldActions}\n          documentId={documentId}\n          documentType={documentType}\n          onActions={setRootFieldActionNodes}\n          path={EMPTY_ARRAY}\n          schemaType={schemaType}\n        />\n      )}\n\n      <FieldActionsProvider actions={rootFieldActionNodes} path={EMPTY_ARRAY}>\n        {children}\n      </FieldActionsProvider>\n    </DocumentPaneContext.Provider>\n  )\n})\n\nDocumentPaneProvider.displayName = 'DocumentPaneProvider'\n", "import {SerializePath} from './StructureNodes'\n\n/** @internal */\nexport class SerializeError extends Error {\n  public readonly path: SerializePath\n  public helpId?: HELP_URL\n\n  constructor(\n    message: string,\n    parentPath: SerializePath,\n    pathSegment: string | number | undefined,\n    hint?: string,\n  ) {\n    super(message)\n    const segment = typeof pathSegment === 'undefined' ? '<unknown>' : `${pathSegment}`\n    this.path = (parentPath || []).concat(hint ? `${segment} (${hint})` : segment)\n  }\n\n  withHelpUrl(id: HELP_URL): SerializeError {\n    this.helpId = id\n    return this\n  }\n}\n\n/** @internal */\nexport enum HELP_URL {\n  ID_REQUIRED = 'structure-node-id-required',\n  TITLE_REQUIRED = 'structure-title-required',\n  FILTER_REQUIRED = 'structure-filter-required',\n  INVALID_LIST_ITEM = 'structure-invalid-list-item',\n  COMPONENT_REQUIRED = 'structure-view-component-required',\n  DOCUMENT_ID_REQUIRED = 'structure-document-id-required',\n  DOCUMENT_TYPE_REQUIRED = 'structure-document-type-required',\n  SCHEMA_TYPE_REQUIRED = 'structure-schema-type-required',\n  SCHEMA_TYPE_NOT_FOUND = 'structure-schema-type-not-found',\n  LIST_ITEMS_MUST_BE_ARRAY = 'structure-list-items-must-be-array',\n  QUERY_PROVIDED_FOR_FILTER = 'structure-query-provided-for-filter',\n  ACTION_OR_INTENT_REQUIRED = 'structure-action-or-intent-required',\n  LIST_ITEM_IDS_MUST_BE_UNIQUE = 'structure-list-item-ids-must-be-unique',\n  ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE = 'structure-action-and-intent-mutually-exclusive',\n  API_VERSION_REQUIRED_FOR_CUSTOM_FILTER = 'structure-api-version-required-for-custom-filter',\n}\n", "import {SchemaType, SortOrderingItem} from '@sanity/types'\n\nconst IMPLICIT_FIELDS = ['_id', '_type', '_createdAt', '_updatedAt', '_rev']\n\n// Takes a path array and a schema type and builds a GROQ join every time it enters a reference field\nfunction joinReferences(schemaType: SchemaType, path: string[]): string {\n  const [head, ...tail] = path\n\n  if (!('fields' in schemaType)) {\n    return ''\n  }\n\n  const schemaField = schemaType.fields.find((field) => field.name === head)\n  if (!schemaField) {\n    if (!IMPLICIT_FIELDS.includes(head)) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        'The current ordering config targeted the nonexistent field \"%s\" on schema type \"%s\". It should be one of %o',\n        head,\n        schemaType.name,\n        schemaType.fields.map((field) => field.name),\n      )\n    }\n    return ''\n  }\n\n  if ('to' in schemaField.type && schemaField.type.name === 'reference') {\n    const refTypes = schemaField.type.to\n    return `${head}->{${refTypes.map((refType) => joinReferences(refType, tail)).join(',')}}`\n  }\n\n  const tailFields = tail.length > 0 && joinReferences(schemaField.type, tail)\n  const tailWrapper = tailFields ? `{${tailFields}}` : ''\n  return tail.length > 0 ? `${head}${tailWrapper}` : head\n}\n\nexport function getExtendedProjection(schemaType: SchemaType, orderBy: SortOrderingItem[]): string {\n  return orderBy.map((ordering) => joinReferences(schemaType, ordering.field.split('.'))).join(', ')\n}\n", "import {SortOrdering} from '@sanity/types'\n\nexport const ORDER_BY_UPDATED_AT: SortOrdering = {\n  title: 'Last edited',\n  name: 'lastEditedDesc',\n  by: [{field: '_updatedAt', direction: 'desc'}],\n}\n\nexport const ORDER_BY_CREATED_AT: SortOrdering = {\n  title: 'Created',\n  name: 'lastCreatedDesc',\n  by: [{field: '_createdAt', direction: 'desc'}],\n}\n\nexport const DEFAULT_SELECTED_ORDERING_OPTION = ORDER_BY_UPDATED_AT\n\nexport const DEFAULT_ORDERING_OPTIONS: SortOrdering[] = [\n  ORDER_BY_UPDATED_AT, // _updatedAt\n  ORDER_BY_CREATED_AT, // _createdAt\n]\n", "import {SchemaType, SortOrdering, SortOrderingItem} from '@sanity/types'\nimport {SortIcon} from '@sanity/icons'\nimport {getExtendedProjection} from './util/getExtendedProjection'\nimport {Intent} from './Intent'\nimport {DEFAULT_ORDERING_OPTIONS} from './Sort'\nimport {SerializeOptions, Serializable, SerializePath} from './StructureNodes'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {StructureContext} from './types'\n\n/** @internal */\nexport function maybeSerializeMenuItem(\n  item: MenuItem | MenuItemBuilder,\n  index: number,\n  path: SerializePath,\n): MenuItem {\n  return item instanceof MenuItemBuilder ? item.serialize({path, index}) : item\n}\n\n/**\n * Menu item action type\n * @public */\nexport type MenuItemActionType =\n  | string\n  | ((params: Record<string, string> | undefined, scope?: any) => void)\n\n/**\n * Menu items parameters\n *\n * @public */\nexport type MenuItemParamsType = Record<string, string | unknown | undefined>\n\n/**\n * Interface for menu items\n *\n * @public */\nexport interface MenuItem {\n  /** Menu Item title */\n  title: string\n  /** Menu Item action */\n  action?: MenuItemActionType\n  /** Menu Item intent */\n  intent?: Intent\n  /** Menu Item group */\n  group?: string\n  // TODO: align these with TemplateItem['icon']\n  /** Menu Item icon */\n  icon?: React.ComponentType | React.ReactNode\n  /** Menu Item parameters. See {@link MenuItemParamsType} */\n  params?: MenuItemParamsType\n  /** Determine if it will show the MenuItem as action */\n  showAsAction?: boolean\n}\n\n/**\n * Partial menu items\n * @public\n */\nexport type PartialMenuItem = Partial<MenuItem>\n\n/**\n * Class for building menu items.\n *\n * @public */\nexport class MenuItemBuilder implements Serializable<MenuItem> {\n  /** menu item option object. See {@link PartialMenuItem} */\n  protected spec: PartialMenuItem\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: MenuItem,\n  ) {\n    this.spec = spec ? spec : {}\n  }\n\n  /**\n   * Set menu item action\n   * @param action - menu item action. See {@link MenuItemActionType}\n   * @returns menu item builder based on action provided. See {@link MenuItemBuilder}\n   */\n  action(action: MenuItemActionType): MenuItemBuilder {\n    return this.clone({action})\n  }\n\n  /**\n   * Get menu item action\n   * @returns menu item builder action. See {@link PartialMenuItem}\n   */\n  getAction(): PartialMenuItem['action'] {\n    return this.spec.action\n  }\n\n  /**\n   * Set menu item intent\n   * @param intent - menu item intent. See {@link Intent}\n   * @returns menu item builder based on intent provided. See {@link MenuItemBuilder}\n   */\n  intent(intent: Intent): MenuItemBuilder {\n    return this.clone({intent})\n  }\n\n  /**\n   * Get menu item intent\n   * @returns menu item intent. See {@link PartialMenuItem}\n   */\n  getIntent(): PartialMenuItem['intent'] {\n    return this.spec.intent\n  }\n\n  /**\n   * Set menu item title\n   * @param title - menu item title\n   * @returns menu item builder based on title provided. See {@link MenuItemBuilder}\n   */\n  title(title: string): MenuItemBuilder {\n    return this.clone({title})\n  }\n\n  /**\n   * Get menu item title\n   * @returns menu item title\n   */\n  getTitle(): string | undefined {\n    return this.spec.title\n  }\n\n  /**\n   * Set menu item group\n   * @param group - menu item group\n   * @returns menu item builder based on group provided. See {@link MenuItemBuilder}\n   */\n  group(group: string): MenuItemBuilder {\n    return this.clone({group})\n  }\n\n  /**\n   * Get menu item group\n   * @returns menu item group. See {@link PartialMenuItem}\n   */\n  getGroup(): PartialMenuItem['group'] {\n    return this.spec.group\n  }\n\n  /**\n   * Set menu item icon\n   * @param icon - menu item icon\n   * @returns menu item builder based on icon provided. See {@link MenuItemBuilder}\n   */\n  icon(icon: React.ComponentType | React.ReactNode): MenuItemBuilder {\n    return this.clone({icon})\n  }\n\n  /**\n   * Get menu item icon\n   * @returns menu item icon. See {@link PartialMenuItem}\n   */\n  getIcon(): PartialMenuItem['icon'] {\n    return this.spec.icon\n  }\n\n  /**\n   * Set menu item parameters\n   * @param params - menu item parameters. See {@link MenuItemParamsType}\n   * @returns menu item builder based on parameters provided. See {@link MenuItemBuilder}\n   */\n  params(params: MenuItemParamsType): MenuItemBuilder {\n    return this.clone({params})\n  }\n\n  /**\n   * Get meny item parameters\n   * @returns menu item parameters. See {@link PartialMenuItem}\n   */\n  getParams(): PartialMenuItem['params'] {\n    return this.spec.params\n  }\n\n  /**\n   * Set menu item to show as action\n   * @param showAsAction - determine if menu item should show as action\n   * @returns menu item builder based on if it should show as action. See {@link MenuItemBuilder}\n   */\n  showAsAction(showAsAction = true): MenuItemBuilder {\n    return this.clone({showAsAction: Boolean(showAsAction)})\n  }\n\n  /**\n   * Check if menu item should show as action\n   * @returns true if menu item should show as action, false if not. See {@link PartialMenuItem}\n   */\n  getShowAsAction(): PartialMenuItem['showAsAction'] {\n    return this.spec.showAsAction\n  }\n\n  /** Serialize menu item builder\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns menu item node based on path provided in options. See {@link MenuItem}\n   */\n  serialize(options: SerializeOptions = {path: []}): MenuItem {\n    const {title, action, intent} = this.spec\n    if (!title) {\n      const hint = typeof action === 'string' ? `action: \"${action}\"` : undefined\n      throw new SerializeError(\n        '`title` is required for menu item',\n        options.path,\n        options.index,\n        hint,\n      ).withHelpUrl(HELP_URL.TITLE_REQUIRED)\n    }\n\n    if (!action && !intent) {\n      throw new SerializeError(\n        `\\`action\\` or \\`intent\\` required for menu item with title ${this.spec.title}`,\n        options.path,\n        options.index,\n        `\"${title}\"`,\n      ).withHelpUrl(HELP_URL.ACTION_OR_INTENT_REQUIRED)\n    }\n\n    if (intent && action) {\n      throw new SerializeError(\n        'cannot set both `action` AND `intent`',\n        options.path,\n        options.index,\n        `\"${title}\"`,\n      ).withHelpUrl(HELP_URL.ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE)\n    }\n\n    return {...this.spec, title}\n  }\n\n  /** Clone menu item builder\n   * @param withSpec - menu item options. See {@link PartialMenuItem}\n   * @returns menu item builder based on context and spec provided. See {@link MenuItemBuilder}\n   */\n  clone(withSpec?: PartialMenuItem): MenuItemBuilder {\n    const builder = new MenuItemBuilder(this._context)\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n\n/** @internal */\nexport interface SortMenuItem extends MenuItem {\n  params: {\n    by: SortOrderingItem[]\n  }\n}\n\n/** @internal */\nexport function getOrderingMenuItem(\n  context: StructureContext,\n  ordering: SortOrdering,\n  extendedProjection?: string,\n): MenuItemBuilder {\n  return new MenuItemBuilder(context)\n    .group('sorting')\n    .title(`Sort by ${ordering.title}`)\n    .icon(SortIcon)\n    .action('setSortOrder')\n    .params({by: ordering.by, extendedProjection})\n}\n\n/** @internal */\nexport function getOrderingMenuItemsForSchemaType(\n  context: StructureContext,\n  typeName: SchemaType | string,\n): MenuItemBuilder[] {\n  const {schema} = context\n  const type = typeof typeName === 'string' ? schema.get(typeName) : typeName\n  if (!type || !('orderings' in type)) {\n    return []\n  }\n\n  return (\n    type.orderings ? type.orderings.concat(DEFAULT_ORDERING_OPTIONS) : DEFAULT_ORDERING_OPTIONS\n  ).map((ordering: SortOrdering) =>\n    getOrderingMenuItem(context, ordering, getExtendedProjection(type, ordering.by)),\n  )\n}\n", "import {SerializeOptions, Serializable, SerializePath} from './StructureNodes'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {StructureContext} from './types'\n\n/** @internal */\nexport function maybeSerializeMenuItemGroup(\n  item: MenuItemGroup | MenuItemGroupBuilder,\n  index: number,\n  path: SerializePath,\n): MenuItemGroup {\n  return item instanceof MenuItemGroupBuilder ? item.serialize({path, index}) : item\n}\n\n/**\n * Interface for menu item groups\n * @public\n */\nexport interface MenuItemGroup {\n  /** Menu group Id */\n  id: string\n  /** Menu group title */\n  title: string\n}\n\n/**\n * Class for building menu item groups.\n *\n * @public\n */\nexport class MenuItemGroupBuilder implements Serializable<MenuItemGroup> {\n  /** Menu item group ID */\n  protected _id: string\n  /** Menu item group title */\n  protected _title: string\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: MenuItemGroup,\n  ) {\n    this._id = spec ? spec.id : ''\n    this._title = spec ? spec.title : ''\n  }\n\n  /**\n   * Set menu item group ID\n   * @param id - menu item group ID\n   * @returns menu item group builder based on ID provided. See {@link MenuItemGroupBuilder}\n   */\n  id(id: string): MenuItemGroupBuilder {\n    return new MenuItemGroupBuilder(this._context, {id, title: this._title})\n  }\n\n  /**\n   * Get menu item group ID\n   * @returns menu item group ID\n   */\n  getId(): string {\n    return this._id\n  }\n\n  /**\n   * Set menu item group title\n   * @param title - menu item group title\n   * @returns menu item group builder based on title provided. See {@link MenuItemGroupBuilder}\n   */\n  title(title: string): MenuItemGroupBuilder {\n    return new MenuItemGroupBuilder(this._context, {id: this._id, title})\n  }\n\n  /**\n   * Get menu item group title\n   * @returns menu item group title\n   */\n  getTitle(): string {\n    return this._title\n  }\n\n  /**\n   * Serialize menu item group builder\n   * @param options - serialization options (path). See {@link SerializeOptions}\n   * @returns menu item group based on path provided in options. See {@link MenuItemGroup}\n   */\n  serialize(options: SerializeOptions = {path: []}): MenuItemGroup {\n    const {_id, _title} = this\n    if (!_id) {\n      throw new SerializeError(\n        '`id` is required for a menu item group',\n        options.path,\n        options.index,\n        _title,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!_title) {\n      throw new SerializeError(\n        '`title` is required for a menu item group',\n        options.path,\n        _id,\n      ).withHelpUrl(HELP_URL.TITLE_REQUIRED)\n    }\n\n    return {\n      id: _id,\n      title: _title,\n    }\n  }\n}\n", "import {SerializeError} from '../SerializeError'\nimport {SerializePath} from '../StructureNodes'\n\nexport const disallowedPattern = /([^A-Za-z0-9-_.])/\n\nexport function validateId(\n  id: string,\n  parentPath: SerializePath,\n  pathSegment: string | number | undefined,\n): string {\n  if (typeof id !== 'string') {\n    throw new SerializeError(\n      `Structure node id must be of type string, got ${typeof id}`,\n      parentPath,\n      pathSegment,\n    )\n  }\n\n  const [disallowedChar] = id.match(disallowedPattern) || []\n  if (disallowedChar) {\n    throw new SerializeError(\n      `Structure node id cannot contain character \"${disallowedChar}\"`,\n      parentPath,\n      pathSegment,\n    )\n  }\n\n  if (id.startsWith('__edit__')) {\n    throw new SerializeError(\n      `Structure node id cannot start with __edit__`,\n      parentPath,\n      pathSegment,\n    )\n  }\n\n  return id\n}\n", "import {camelCase} from 'lodash'\nimport getSlug from 'speakingurl'\nimport {disallowedPattern} from './validateId'\n\nexport function getStructureNodeId(title: string, id?: string): string {\n  if (id) {\n    return id\n  }\n\n  const camelCased = camelCase(title)\n\n  return disallowedPattern.test(camelCased) ? camelCase(getSlug(title)) : camelCased\n}\n", "import {SerializeOptions, StructureNode, Serializable, Child} from './StructureNodes'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {MenuItem, MenuItemBuilder, maybeSerializeMenuItem} from './MenuItem'\nimport {MenuItemGroup, MenuItemGroupBuilder, maybeSerializeMenuItemGroup} from './MenuItemGroup'\nimport {validateId} from './util/validateId'\nimport {UserComponent} from './types'\nimport {getStructureNodeId} from './util/getStructureNodeId'\n\n/**\n * Interface for component\n *\n * @public\n */\n// TODO: rename to `StructureComponent` since it clashes with React?\nexport interface Component extends StructureNode {\n  /** Component of type {@link UserComponent} */\n  component: UserComponent\n  /** Component child of type {@link Child} */\n  child?: Child\n  /** Component menu items, array of type {@link MenuItem} */\n  menuItems: MenuItem[]\n  /** Component menu item group, array of type {@link MenuItemGroup} */\n  menuItemGroups: MenuItemGroup[]\n  /** Component options */\n  options: {[key: string]: unknown}\n}\n\n/**\n * Interface for component input\n *\n * @public\n */\nexport interface ComponentInput extends StructureNode {\n  /** Component of type {@link UserComponent} */\n  component: UserComponent\n  /** Component child of type {@link Child} */\n  child?: Child\n  /** Component options */\n  options?: {[key: string]: unknown}\n  /** Component menu items. See {@link MenuItem} and {@link MenuItemBuilder}  */\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  /** Component menu item groups. See {@link MenuItemGroup} and {@link MenuItemGroupBuilder} */\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n}\n\n/**\n * Interface for buildable component\n *\n * @public\n */\nexport interface BuildableComponent extends Partial<StructureNode> {\n  /** Component of type {@link UserComponent} */\n  component?: UserComponent\n  /** Component child of type {@link Child} */\n  child?: Child\n  /** Component options */\n  options?: {[key: string]: unknown}\n  /** Component menu items. See {@link MenuItem} and {@link MenuItemBuilder}  */\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  /** Component menu item groups. See {@link MenuItemGroup} and {@link MenuItemGroupBuilder} */\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n}\n\n/**\n * Class for building components\n *\n * @public\n */\nexport class ComponentBuilder implements Serializable<Component> {\n  /** component builder option object */\n  protected spec: BuildableComponent\n\n  constructor(spec?: ComponentInput) {\n    this.spec = {options: {}, ...(spec ? spec : {})}\n  }\n\n  /** Set Component ID\n   * @param id - component ID\n   * @returns component builder based on ID provided\n   */\n  id(id: string): ComponentBuilder {\n    return this.clone({id})\n  }\n\n  /** Get ID\n   * @returns ID\n   */\n  getId(): BuildableComponent['id'] {\n    return this.spec.id\n  }\n\n  /** Set Component title\n   * @param title - component title\n   * @returns component builder based on title provided (and ID)\n   */\n  title(title: string): ComponentBuilder {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  /** Get Component title\n   * @returns title\n   */\n  getTitle(): BuildableComponent['title'] {\n    return this.spec.title\n  }\n\n  /** Set Component child\n   * @param child - child component\n   * @returns component builder based on child component provided\n   */\n  child(child: Child): ComponentBuilder {\n    return this.clone({child})\n  }\n\n  /** Get Component child\n   * @returns child component\n   */\n  getChild(): BuildableComponent['child'] {\n    return this.spec.child\n  }\n\n  /** Set component\n   * @param component - user built component\n   * @returns component builder based on component provided\n   */\n  component(component: UserComponent): ComponentBuilder {\n    return this.clone({component})\n  }\n\n  /** Get Component\n   * @returns component\n   */\n  getComponent(): BuildableComponent['component'] {\n    return this.spec.component\n  }\n\n  /** Set Component options\n   * @param options - component options\n   * @returns component builder based on options provided\n   */\n  options(options: {[key: string]: unknown}): ComponentBuilder {\n    return this.clone({options})\n  }\n\n  /** Get Component options\n   * @returns component options\n   */\n  getOptions(): NonNullable<BuildableComponent['options']> {\n    return this.spec.options || {}\n  }\n\n  /** Set Component menu items\n   * @param menuItems - component menu items\n   * @returns component builder based on menuItems provided\n   */\n  menuItems(menuItems: (MenuItem | MenuItemBuilder)[]): ComponentBuilder {\n    return this.clone({menuItems})\n  }\n\n  /** Get Component menu items\n   * @returns menu items\n   */\n  getMenuItems(): BuildableComponent['menuItems'] {\n    return this.spec.menuItems\n  }\n\n  /** Set Component menu item groups\n   * @param menuItemGroups - component menu item groups\n   * @returns component builder based on menuItemGroups provided\n   */\n  menuItemGroups(menuItemGroups: (MenuItemGroup | MenuItemGroupBuilder)[]): ComponentBuilder {\n    return this.clone({menuItemGroups})\n  }\n\n  /** Get Component menu item groups\n   * @returns menu item groups\n   */\n  getMenuItemGroups(): BuildableComponent['menuItemGroups'] {\n    return this.spec.menuItemGroups\n  }\n\n  /** Serialize component\n   * @param options - serialization options\n   * @returns component object based on path provided in options\n   *\n   */\n  serialize(options: SerializeOptions = {path: []}): Component {\n    const {id, title, child, options: componentOptions, component} = this.spec\n    if (!id) {\n      throw new SerializeError(\n        '`id` is required for `component` structure item',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!component) {\n      throw new SerializeError(\n        '`component` is required for `component` structure item',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    return {\n      id: validateId(id, options.path, options.index),\n      title,\n      type: 'component',\n      child,\n      component,\n      options: componentOptions || {},\n      menuItems: (this.spec.menuItems || []).map((item, i) =>\n        maybeSerializeMenuItem(item, i, options.path),\n      ),\n      menuItemGroups: (this.spec.menuItemGroups || []).map((item, i) =>\n        maybeSerializeMenuItemGroup(item, i, options.path),\n      ),\n    }\n  }\n\n  /** Clone component builder (allows for options overriding)\n   * @param withSpec - component builder options\n   * @returns cloned builder\n   */\n  clone(withSpec?: BuildableComponent): ComponentBuilder {\n    const builder = new ComponentBuilder()\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n", "import type {SanityClient} from '@sanity/client'\nimport {\n  DEFAULT_STUDIO_CLIENT_OPTIONS,\n  getDraftId,\n  getPublishedId,\n  type SourceClientOptions,\n} from 'sanity'\n\nexport async function resolveTypeForDocument(\n  getClient: (options: SourceClientOptions) => SanityClient,\n  id: string,\n): Promise<string | undefined> {\n  const query = '*[_id in [$documentId, $draftId]]._type'\n  const documentId = getPublishedId(id)\n  const draftId = getDraftId(id)\n\n  const types = await getClient(DEFAULT_STUDIO_CLIENT_OPTIONS).fetch(\n    query,\n    {documentId, draftId},\n    {tag: 'structure.resolve-type'},\n  )\n\n  return types[0]\n}\n", "import {kebabCase} from 'lodash'\nimport {Serializable, SerializeOptions, SerializePath} from '../StructureNodes'\nimport {HELP_URL, SerializeError} from '../SerializeError'\nimport {validateId} from '../util/validateId'\nimport {View} from '../types'\nimport {ComponentViewBuilder} from './ComponentView'\nimport {FormViewBuilder} from './FormView'\n\n/**\n * Interface for base view\n *\n * @public */\nexport interface BaseView {\n  /** View id */\n  id: string\n  /** View Title */\n  title: string\n  /** View Icon */\n  icon?: React.ComponentType | React.ReactNode\n}\n\n/**\n * Class for building generic views.\n *\n * @public\n */\nexport abstract class GenericViewBuilder<TView extends Partial<BaseView>, ConcreteImpl>\n  implements Serializable<BaseView>\n{\n  /** Generic view option object */\n  protected spec: TView = {} as TView\n\n  /** Set generic view ID\n   * @param id - generic view ID\n   * @returns generic view builder based on ID provided.\n   */\n  id(id: string): ConcreteImpl {\n    return this.clone({id})\n  }\n  /** Get generic view ID\n   * @returns generic view ID\n   */\n  getId(): TView['id'] {\n    return this.spec.id\n  }\n\n  /** Set generic view title\n   * @param title - generic view title\n   * @returns generic view builder based on title provided and (if provided) its ID.\n   */\n  title(title: string): ConcreteImpl {\n    return this.clone({title, id: this.spec.id || kebabCase(title)})\n  }\n\n  /** Get generic view title\n   * @returns generic view title\n   */\n  getTitle(): TView['title'] {\n    return this.spec.title\n  }\n\n  /** Set generic view icon\n   * @param icon - generic view icon\n   * @returns generic view builder based on icon provided.\n   */\n  icon(icon: React.ComponentType | React.ReactNode): ConcreteImpl {\n    return this.clone({icon})\n  }\n\n  /** Get generic view icon\n   * @returns generic view icon\n   */\n  getIcon(): TView['icon'] {\n    return this.spec.icon\n  }\n\n  /** Serialize generic view\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns generic view object based on path provided in options. See {@link BaseView}\n   */\n  serialize(options: SerializeOptions = {path: []}): BaseView {\n    const {id, title, icon} = this.spec\n    if (!id) {\n      throw new SerializeError(\n        '`id` is required for view item',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!title) {\n      throw new SerializeError(\n        '`title` is required for view item',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.TITLE_REQUIRED)\n    }\n\n    return {\n      id: validateId(id, options.path, options.index),\n      title,\n      icon,\n    }\n  }\n\n  /** Clone generic view builder (allows for options overriding)\n   * @param withSpec - Partial generic view builder options. See {@link BaseView}\n   * @returns Generic view builder.\n   */\n  abstract clone(withSpec?: Partial<BaseView>): ConcreteImpl\n}\n\nfunction isSerializable(view: BaseView | Serializable<BaseView>): view is Serializable<BaseView> {\n  return typeof (view as Serializable<BaseView>).serialize === 'function'\n}\n\n/** @internal */\nexport function maybeSerializeView(\n  item: View | Serializable<View>,\n  index: number,\n  path: SerializePath,\n): View {\n  return isSerializable(item) ? item.serialize({path, index}) : item\n}\n\n/**\n * View builder. See {@link ComponentViewBuilder} and {@link FormViewBuilder}\n *\n * @public\n */\nexport type ViewBuilder = ComponentViewBuilder | FormViewBuilder\n", "import {SerializeOptions} from '../StructureNodes'\nimport {SerializeError, HELP_URL} from '../SerializeError'\nimport type {UserViewComponent} from '../types'\nimport {BaseView, GenericViewBuilder} from './View'\nimport {isRecord} from 'sanity'\n\n/**\n * Interface for component views.\n *\n * @public */\nexport interface ComponentView<TOptions = Record<string, any>> extends BaseView {\n  type: 'component'\n  /** Component view components. See {@link UserViewComponent} */\n  component: UserViewComponent\n  /** Component view options */\n  options: TOptions\n}\n\nconst isComponentSpec = (spec: unknown): spec is ComponentView =>\n  isRecord(spec) && spec.type === 'component'\n\n/**\n * Class for building a component view.\n *\n * @public */\nexport class ComponentViewBuilder extends GenericViewBuilder<\n  Partial<ComponentView>,\n  ComponentViewBuilder\n> {\n  /** Partial Component view option object. See {@link ComponentView} */\n  protected spec: Partial<ComponentView>\n\n  constructor(\n    /**\n     * Component view component or spec\n     * @param componentOrSpec - user view component or partial component view. See {@link UserViewComponent} and {@link ComponentView}\n     */\n    componentOrSpec?: UserViewComponent | Partial<ComponentView>,\n  ) {\n    const spec = isComponentSpec(componentOrSpec) ? {...componentOrSpec} : {options: {}}\n\n    super()\n    this.spec = spec\n\n    const userComponent =\n      typeof componentOrSpec === 'function' ? componentOrSpec : this.spec.component\n\n    if (userComponent) {\n      // Because we're cloning, this'll return a new instance, so grab the spec from it\n      this.spec = this.component(userComponent).spec\n    }\n  }\n\n  /** Set view Component\n   * @param component - component view component. See {@link UserViewComponent}\n   * @returns component view builder based on component view provided. See {@link ComponentViewBuilder}\n   */\n  component(component: UserViewComponent): ComponentViewBuilder {\n    return this.clone({component})\n  }\n\n  /** Get view Component\n   * @returns Partial component view. See {@link ComponentView}\n   */\n  getComponent(): Partial<ComponentView>['component'] {\n    return this.spec.component\n  }\n\n  /** Set view Component options\n   * @param options - component view options\n   * @returns component view builder based on options provided. See {@link ComponentViewBuilder}\n   */\n  options(options: {[key: string]: any}): ComponentViewBuilder {\n    return this.clone({options})\n  }\n\n  /** Get view Component options\n   * @returns component view options. See {@link ComponentView}\n   */\n  getOptions(): ComponentView['options'] {\n    return this.spec.options || {}\n  }\n\n  /** Serialize view Component\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns component view based on path provided in options. See {@link ComponentView}\n   *\n   */\n  serialize(options: SerializeOptions = {path: []}): ComponentView {\n    const base = super.serialize(options)\n\n    const component = this.spec.component\n    if (typeof component !== 'function') {\n      throw new SerializeError(\n        '`component` is required and must be a function for `component()` view item',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.COMPONENT_REQUIRED)\n    }\n\n    return {\n      ...base,\n      component,\n      options: this.spec.options || {},\n      type: 'component',\n    }\n  }\n\n  /** Clone Component view builder (allows for options overriding)\n   * @param withSpec - partial for component view option. See {@link ComponentView}\n   * @returns component view builder. See {@link ComponentViewBuilder}\n   */\n  clone(withSpec?: Partial<ComponentView>): ComponentViewBuilder {\n    const builder = new ComponentViewBuilder()\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n", "import {SerializeOptions} from '../StructureNodes'\nimport {BaseView, GenericViewBuilder} from './View'\n\n/**\n * Interface for form views.\n *\n * @public */\nexport interface FormView extends BaseView {\n  type: 'form'\n}\n\n/**\n * Class for building a form view.\n *\n * @public */\nexport class FormViewBuilder extends GenericViewBuilder<Partial<BaseView>, FormViewBuilder> {\n  /** Document list options. See {@link FormView} */\n  protected spec: Partial<FormView>\n\n  constructor(spec?: Partial<FormView>) {\n    super()\n    this.spec = {id: 'editor', title: 'Editor', ...(spec ? spec : {})}\n  }\n\n  /**\n   * Serialize Form view builder\n   * @param options - Serialize options. See {@link SerializeOptions}\n   * @returns form view builder based on path provided in options. See {@link FormView}\n   */\n  serialize(options: SerializeOptions = {path: []}): FormView {\n    return {\n      ...super.serialize(options),\n      type: 'form',\n    }\n  }\n\n  /**\n   * Clone Form view builder (allows for options overriding)\n   * @param withSpec - Partial form view builder options. See {@link FormView}\n   * @returns form view builder. See {@link FormViewBuilder}\n   */\n  clone(withSpec?: Partial<FormView>): FormViewBuilder {\n    const builder = new FormViewBuilder()\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n", "import type {UserViewComponent} from '../types'\nimport {ComponentView, ComponentViewBuilder} from './ComponentView'\nimport {FormView, FormViewBuilder} from './FormView'\n\nexport * from './FormView'\nexport * from './ComponentView'\nexport * from './View'\n\n/** @internal */\nexport const form = (spec?: Partial<FormView>): FormViewBuilder => new FormViewBuilder(spec)\n\n/** @internal */\nexport const component = (\n  componentOrSpec?: UserViewComponent | Partial<ComponentView>,\n): ComponentViewBuilder => new ComponentViewBuilder(componentOrSpec)\n", "import {uniq} from 'lodash'\nimport {SchemaType} from '@sanity/types'\nimport {resolveTypeForDocument} from './util/resolveTypeForDocument'\nimport {ChildResolver} from './ChildResolver'\nimport {SerializeOptions, Serializable, Child, DocumentNode, EditorNode} from './StructureNodes'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {validateId} from './util/validateId'\nimport {ViewBuilder, maybeSerializeView} from './views/View'\nimport {form} from './views'\nimport type {StructureContext, View} from './types'\nimport {getStructureNodeId} from './util/getStructureNodeId'\n\nconst createDocumentChildResolver =\n  ({resolveDocumentNode, getClient}: StructureContext): ChildResolver =>\n  async (itemId, {params, path}) => {\n    let type = params.type\n\n    const parentPath = path.slice(0, path.length - 1)\n    const currentSegment = path[path.length - 1]\n\n    if (!type) {\n      type = await resolveTypeForDocument(getClient, itemId)\n    }\n\n    if (!type) {\n      throw new SerializeError(\n        `Failed to resolve document, and no type provided in parameters.`,\n        parentPath,\n        currentSegment,\n      )\n    }\n\n    return resolveDocumentNode({documentId: itemId, schemaType: type})\n  }\n\n/**\n * Interface for options of Partial Documents. See {@link PartialDocumentNode}\n *\n * @public */\nexport interface DocumentOptions {\n  /** Document Id */\n  id: string\n  /** Document Type */\n  type: string\n  /** Document Template */\n  template?: string\n  /** Template parameters */\n  templateParameters?: Record<string, unknown>\n}\n\n/**\n * Interface for partial document (focused on the document pane)\n *\n * @public */\nexport interface PartialDocumentNode {\n  /** Document Id */\n  id?: string\n  /** Document title */\n  title?: string\n  /** Document children of type {@link Child} */\n  child?: Child\n  /**\n   * Views for the document pane. See {@link ViewBuilder} and {@link View}\n   */\n  views?: (View | ViewBuilder)[]\n  /**\n   * Document options. See {@link DocumentOptions}\n   */\n  options?: Partial<DocumentOptions>\n}\n\n/**\n * A `DocumentBuilder` is used to build a document node.\n *\n * @public */\nexport class DocumentBuilder implements Serializable<DocumentNode> {\n  /** Component builder option object See {@link PartialDocumentNode} */\n  protected spec: PartialDocumentNode\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: PartialDocumentNode,\n  ) {\n    this.spec = spec ? spec : {}\n  }\n\n  /** Set Document Builder ID\n   * @param id - document builder ID\n   * @returns document builder based on ID provided. See {@link DocumentBuilder}\n   */\n  id(id: string): DocumentBuilder {\n    return this.clone({id})\n  }\n\n  /** Get Document Builder ID\n   * @returns document ID. See {@link PartialDocumentNode}\n   */\n  getId(): PartialDocumentNode['id'] {\n    return this.spec.id\n  }\n\n  /** Set Document title\n   * @param title - document title\n   * @returns document builder based on title provided (and ID). See {@link DocumentBuilder}\n   */\n  title(title: string): DocumentBuilder {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  /** Get Document title\n   * @returns document title. See {@link PartialDocumentNode}\n   */\n  getTitle(): PartialDocumentNode['title'] {\n    return this.spec.title\n  }\n\n  /** Set Document child\n   * @param child - document child\n   * @returns document builder based on child provided. See {@link DocumentBuilder}\n   */\n  child(child: Child): DocumentBuilder {\n    return this.clone({child})\n  }\n\n  /** Get Document child\n   * @returns document child. See {@link PartialDocumentNode}\n   */\n  getChild(): PartialDocumentNode['child'] {\n    return this.spec.child\n  }\n\n  /** Set Document ID\n   * @param documentId - document ID\n   * @returns document builder with document based on ID provided. See {@link DocumentBuilder}\n   */\n  documentId(documentId: string): DocumentBuilder {\n    // Let's try to be a bit helpful and assign an ID from document ID if none is specified\n    const paneId = this.spec.id || documentId\n    return this.clone({\n      id: paneId,\n      options: {\n        ...(this.spec.options || {}),\n        id: documentId,\n      },\n    })\n  }\n\n  /** Get Document ID\n   * @returns document ID. See {@link DocumentOptions}\n   */\n  getDocumentId(): Partial<DocumentOptions>['id'] {\n    return this.spec.options?.id\n  }\n\n  /** Set Document Type\n   * @param documentType - document type\n   * @returns document builder with document based on type provided. See {@link DocumentBuilder}\n   */\n  schemaType(documentType: SchemaType | string): DocumentBuilder {\n    return this.clone({\n      options: {\n        ...(this.spec.options || {}),\n        type: typeof documentType === 'string' ? documentType : documentType.name,\n      },\n    })\n  }\n\n  /** Get Document Type\n   * @returns document type. See {@link DocumentOptions}\n   */\n  getSchemaType(): Partial<DocumentOptions>['type'] {\n    return this.spec.options?.type\n  }\n\n  /** Set Document Template\n   * @param templateId - document template ID\n   * @param parameters - document template parameters\n   * @returns document builder with document based on template provided. See {@link DocumentBuilder}\n   */\n  initialValueTemplate(templateId: string, parameters?: Record<string, unknown>): DocumentBuilder {\n    return this.clone({\n      options: {\n        ...(this.spec.options || {}),\n        template: templateId,\n        templateParameters: parameters,\n      },\n    })\n  }\n\n  /** Get Document Template\n   * @returns document template. See {@link DocumentOptions}\n   */\n  getInitialValueTemplate(): Partial<DocumentOptions>['template'] {\n    return this.spec.options?.template\n  }\n\n  /** Get Document's initial value Template parameters\n   * @returns document template parameters. See {@link DocumentOptions}\n   */\n  getInitialValueTemplateParameters(): Partial<DocumentOptions>['templateParameters'] {\n    return this.spec.options?.templateParameters\n  }\n\n  /** Set Document views\n   * @param views - document views. See {@link ViewBuilder} and {@link View}\n   * @returns document builder with document based on views provided. See {@link DocumentBuilder}\n   */\n  views(views: (View | ViewBuilder)[]): DocumentBuilder {\n    return this.clone({views})\n  }\n\n  /** Get Document views\n   * @returns document views. See {@link ViewBuilder} and {@link View}\n   */\n  getViews(): (View | ViewBuilder)[] {\n    return this.spec.views || []\n  }\n\n  /** Serialize Document builder\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns document node based on path, index and hint provided in options. See {@link DocumentNode}\n   */\n  serialize({path = [], index, hint}: SerializeOptions = {path: []}): DocumentNode {\n    const urlId = path[index || path.length - 1]\n\n    // Try to grab document ID / editor ID from URL if not defined\n    const id = this.spec.id || (urlId && `${urlId}`) || ''\n    const options: Partial<DocumentOptions> = {\n      id,\n      type: undefined,\n      template: undefined,\n      templateParameters: undefined,\n      ...this.spec.options,\n    }\n\n    if (typeof id !== 'string' || !id) {\n      throw new SerializeError(\n        '`id` is required for document nodes',\n        path,\n        index,\n        hint,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!options || !options.id) {\n      throw new SerializeError(\n        'document id (`id`) is required for document nodes',\n        path,\n        id,\n        hint,\n      ).withHelpUrl(HELP_URL.DOCUMENT_ID_REQUIRED)\n    }\n\n    if (!options || !options.type) {\n      throw new SerializeError(\n        'document type (`schemaType`) is required for document nodes',\n        path,\n        id,\n        hint,\n      )\n    }\n\n    const views = (this.spec.views && this.spec.views.length > 0 ? this.spec.views : [form()]).map(\n      (item, i) => maybeSerializeView(item, i, path),\n    )\n\n    const viewIds = views.map((view) => view.id)\n    const dupes = uniq(viewIds.filter((viewId, i) => viewIds.includes(viewId, i + 1)))\n    if (dupes.length > 0) {\n      throw new SerializeError(\n        `document node has views with duplicate IDs: ${dupes.join(',  ')}`,\n        path,\n        id,\n        hint,\n      )\n    }\n\n    return {\n      ...this.spec,\n      child: this.spec.child || createDocumentChildResolver(this._context),\n      id: validateId(id, path, index),\n      type: 'document',\n      options: getDocumentOptions(options),\n      views,\n    }\n  }\n\n  /** Clone Document builder\n   * @param withSpec - partial document node specification used to extend the cloned builder. See {@link PartialDocumentNode}\n   * @returns document builder based on context and spec provided. See {@link DocumentBuilder}\n   */\n  clone(withSpec: PartialDocumentNode = {}): DocumentBuilder {\n    const builder = new DocumentBuilder(this._context)\n    const options = {...(this.spec.options || {}), ...(withSpec.options || {})}\n    builder.spec = {...this.spec, ...withSpec, options}\n    return builder\n  }\n}\n\nfunction getDocumentOptions(spec: Partial<DocumentOptions>): DocumentOptions {\n  const opts: DocumentOptions = {\n    id: spec.id || '',\n    type: spec.type || '*',\n  }\n\n  if (spec.template) {\n    opts.template = spec.template\n  }\n\n  if (spec.templateParameters) {\n    opts.templateParameters = spec.templateParameters\n  }\n\n  return opts\n}\n\n/** @internal */\nexport function documentFromEditor(context: StructureContext, spec?: EditorNode): DocumentBuilder {\n  let doc = spec?.type\n    ? // Use user-defined document fragment as base if possible\n      context.resolveDocumentNode({schemaType: spec.type})\n    : // Fall back to plain old document builder\n      new DocumentBuilder(context)\n\n  if (!spec) return doc\n\n  const {id, type, template, templateParameters} = spec.options\n  doc = doc.id(spec.id).documentId(id)\n\n  if (type) {\n    doc = doc.schemaType(type)\n  }\n  if (template) {\n    doc = doc.initialValueTemplate(template, templateParameters)\n  }\n  if (spec.child) {\n    doc = doc.child(spec.child)\n  }\n\n  return doc\n}\n\n/** @internal */\nexport function documentFromEditorWithInitialValue(\n  {resolveDocumentNode, templates}: StructureContext,\n  templateId: string,\n  parameters?: Record<string, unknown>,\n): DocumentBuilder {\n  const template = templates.find((t) => t.id === templateId)\n\n  if (!template) {\n    throw new Error(`Template with ID \"${templateId}\" not defined`)\n  }\n\n  return resolveDocumentNode({schemaType: template.schemaType}).initialValueTemplate(\n    templateId,\n    parameters,\n  )\n}\n", "export const layoutOptions = ['default', 'card', 'media', 'detail', 'block']\n", "import {PartialDocumentList, getTypeNamesFromFilter} from './DocumentList'\nimport {StructureNode} from './StructureNodes'\n\n/**\n * Intent parameters (json)\n *\n * @public\n */\nexport type IntentJsonParams = {[key: string]: any}\n\n/**\n * Interface for base intent parameters\n *\n * @public */\nexport interface BaseIntentParams {\n  /* Intent type */\n  type?: string\n  /* Intent Id */\n  id?: string\n  /* Intent template */\n  template?: string\n  /**\n   * Experimental field path\n   * @beta\n   * @experimental\n   * @hidden\n   */\n  path?: string\n}\n\n/** @internal */\nexport const DEFAULT_INTENT_HANDLER = Symbol('Document type list canHandleIntent')\n\n/**\n * Intent parameters\n * See {@link router.BaseIntentParams} and {@link router.IntentJsonParams}\n *\n * @public\n */\nexport type IntentParams = BaseIntentParams | [BaseIntentParams, IntentJsonParams]\n\n/**\n * Interface for intents\n * @public */\n// TODO: intents should be unified somewhere\nexport interface Intent {\n  /** Intent type */\n  type: string\n  /** Intent parameters. See {@link IntentParams}\n   */\n  params?: IntentParams\n}\n\n/**\n * Interface for intent checker\n *\n * @public\n */\nexport interface IntentChecker {\n  (\n    /** Intent name */\n    intentName: string,\n    /** Intent checker parameter */\n    params: {[key: string]: any},\n    /** Structure context. See {@link StructureNode} */\n    context: {pane: StructureNode; index: number},\n  ): boolean\n  /** intent checker identify */\n  identity?: symbol\n}\n\n/** @internal */\nexport const defaultIntentChecker: IntentChecker = (intentName, params, {pane}): boolean => {\n  const isEdit = intentName === 'edit'\n  const isCreate = intentName === 'create'\n  const typedSpec = pane as PartialDocumentList\n  const paneFilter = typedSpec.options?.filter || ''\n  const paneParams = typedSpec.options?.params || {}\n  const typeNames = typedSpec.schemaTypeName\n    ? [typedSpec.schemaTypeName]\n    : getTypeNamesFromFilter(paneFilter, paneParams)\n\n  const initialValueTemplates = typedSpec.initialValueTemplates || []\n\n  if (isCreate && params.template) {\n    return initialValueTemplates.some((tpl) => tpl.templateId === params.template)\n  }\n\n  return (\n    (isEdit && params.id && typeNames.includes(params.type)) ||\n    (isCreate && typeNames.includes(params.type))\n  )\n}\n\ndefaultIntentChecker.identity = DEFAULT_INTENT_HANDLER\n", "import {pickBy} from 'lodash'\nimport {ComposeIcon} from '@sanity/icons'\nimport {HELP_URL, SerializeError} from './SerializeError'\nimport {Serializable, SerializeOptions, SerializePath} from './StructureNodes'\nimport {MenuItemBuilder, MenuItem} from './MenuItem'\nimport {IntentParams} from './Intent'\nimport {StructureContext} from './types'\nimport {InitialValueTemplateItem} from 'sanity'\n\n/**\n * A `InitialValueTemplateItemBuilder` is used to build a document node with an initial value set.\n *\n * @public\n */\nexport class InitialValueTemplateItemBuilder implements Serializable<InitialValueTemplateItem> {\n  /** Initial Value template item option object. See {@link InitialValueTemplateItem} */\n  protected spec: Partial<InitialValueTemplateItem>\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: Partial<InitialValueTemplateItem>,\n  ) {\n    this.spec = spec ? spec : {}\n  }\n\n  /** Set initial value template item builder ID\n   * @param id - initial value template item ID\n   * @returns initial value template item based on ID provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  id(id: string): InitialValueTemplateItemBuilder {\n    return this.clone({id})\n  }\n\n  /** Get initial value template item builder ID\n   * @returns initial value template item ID. See {@link InitialValueTemplateItem}\n   */\n  getId(): Partial<InitialValueTemplateItem>['id'] {\n    return this.spec.id\n  }\n\n  /** Set initial value template item title\n   * @param title - initial value template item title\n   * @returns initial value template item based on title provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  title(title: string): InitialValueTemplateItemBuilder {\n    return this.clone({title})\n  }\n\n  /** Get initial value template item title\n   * @returns initial value template item title. See {@link InitialValueTemplateItem}\n   */\n  getTitle(): Partial<InitialValueTemplateItem>['title'] {\n    return this.spec.title\n  }\n\n  /** Set initial value template item description\n   * @param description - initial value template item description\n   * @returns initial value template item builder based on description provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  description(description: string): InitialValueTemplateItemBuilder {\n    return this.clone({description})\n  }\n\n  /** Get initial value template item description\n   * @returns initial value template item description. See {@link InitialValueTemplateItem}\n   */\n  getDescription(): Partial<InitialValueTemplateItem>['description'] {\n    return this.spec.description\n  }\n\n  /** Set initial value template ID\n   * @param templateId - initial value template item template ID\n   * @returns initial value template item based builder on template ID provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  templateId(templateId: string): InitialValueTemplateItemBuilder {\n    // Let's try to be a bit helpful and assign an ID from template ID if none is specified\n    const paneId = this.spec.id || templateId\n    return this.clone({\n      id: paneId,\n      templateId,\n    })\n  }\n\n  /** Get initial value template item template ID\n   * @returns initial value template item ID. See {@link InitialValueTemplateItem}\n   */\n  getTemplateId(): Partial<InitialValueTemplateItem>['templateId'] {\n    return this.spec.templateId\n  }\n\n  /** Get initial value template item template parameters\n   * @param parameters - initial value template item parameters\n   * @returns initial value template item builder based on parameters provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  parameters(parameters: {[key: string]: any}): InitialValueTemplateItemBuilder {\n    return this.clone({parameters})\n  }\n\n  /** Get initial value template item template parameters\n   * @returns initial value template item parameters. See {@link InitialValueTemplateItem}\n   */\n  getParameters(): Partial<InitialValueTemplateItem>['parameters'] {\n    return this.spec.parameters\n  }\n\n  /** Serialize initial value template item\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns initial value template item object based on the path, index and hint provided in options. See {@link InitialValueTemplateItem}\n   */\n  serialize({path = [], index, hint}: SerializeOptions = {path: []}): InitialValueTemplateItem {\n    const {spec, _context} = this\n    const {templates} = _context\n\n    if (typeof spec.id !== 'string' || !spec.id) {\n      throw new SerializeError(\n        '`id` is required for initial value template item nodes',\n        path,\n        index,\n        hint,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!spec.templateId) {\n      throw new SerializeError(\n        'template id (`templateId`) is required for initial value template item nodes',\n        path,\n        spec.id,\n        hint,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    const template = templates.find((t) => t.id === spec.templateId)\n\n    if (!template) {\n      throw new SerializeError(\n        'template id (`templateId`) is required for initial value template item nodes',\n        path,\n        spec.id,\n        hint,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    return {\n      id: spec.id,\n      templateId: spec.id,\n      schemaType: template.schemaType,\n      type: 'initialValueTemplateItem',\n      description: spec.description || template.description,\n      title: spec.title || template.title,\n      subtitle: spec.subtitle,\n      icon: spec.icon || template.icon,\n      initialDocumentId: spec.initialDocumentId,\n      parameters: spec.parameters,\n    }\n  }\n\n  /** Clone generic view builder (allows for options overriding)\n   * @param withSpec - initial value template item builder options. See {@link InitialValueTemplateItemBuilder}\n   * @returns initial value template item builder based on the context and options provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  clone(withSpec: Partial<InitialValueTemplateItem> = {}): InitialValueTemplateItemBuilder {\n    const builder = new InitialValueTemplateItemBuilder(this._context)\n    builder.spec = {...this.spec, ...withSpec}\n    return builder\n  }\n}\n\n/** @internal */\nexport function defaultInitialValueTemplateItems(\n  context: StructureContext,\n): InitialValueTemplateItemBuilder[] {\n  const {schema, getStructureBuilder, templates} = context\n\n  // Sort templates by their schema type, in order or definition\n  const typeNames = schema.getTypeNames()\n  const ordered = templates\n    // Don't list templates that require parameters\n    // TODO: this should use the new-document template items instead maybe?\n    .filter((tpl) => !tpl.parameters?.length)\n    .sort((a, b) => typeNames.indexOf(a.schemaType) - typeNames.indexOf(b.schemaType))\n\n  // Create actual template items out of the templates\n  return ordered.map((tpl) => getStructureBuilder().initialValueTemplateItem(tpl.id))\n}\n\n/** @internal */\nexport function maybeSerializeInitialValueTemplateItem(\n  item: InitialValueTemplateItem | InitialValueTemplateItemBuilder,\n  index: number,\n  path: SerializePath,\n): InitialValueTemplateItem {\n  return item instanceof InitialValueTemplateItemBuilder ? item.serialize({path, index}) : item\n}\n\n/** @internal */\nexport function menuItemsFromInitialValueTemplateItems(\n  context: StructureContext,\n  templateItems: InitialValueTemplateItem[],\n): MenuItem[] {\n  const {schema, templates} = context\n  return templateItems.map((item) => {\n    const template = templates.find((t) => t.id === item.templateId)\n    const title = item.title || template?.title || 'Create new'\n    const params = pickBy(\n      {type: template && template.schemaType, template: item.templateId},\n      Boolean,\n    )\n    const intentParams: IntentParams = item.parameters ? [params, item.parameters] : params\n    const schemaType = template && schema.get(template.schemaType)\n\n    return new MenuItemBuilder(context)\n      .title(title)\n      .icon((template && template.icon) || schemaType?.icon || ComposeIcon)\n      .intent({type: 'create', params: intentParams})\n      .serialize()\n  })\n}\n", "import {Child, Serializable, SerializeOptions, StructureNode} from './StructureNodes'\nimport {layoutOptions} from './Layout'\nimport {MenuItem, MenuItemBuilder, maybeSerializeMenuItem} from './MenuItem'\nimport {MenuItemGroup, MenuItemGroupBuilder, maybeSerializeMenuItemGroup} from './MenuItemGroup'\nimport {IntentChecker, defaultIntentChecker} from './Intent'\nimport {SerializeError} from './SerializeError'\nimport {\n  InitialValueTemplateItemBuilder,\n  maybeSerializeInitialValueTemplateItem,\n} from './InitialValueTemplateItem'\nimport {validateId} from './util/validateId'\nimport {getStructureNodeId} from './util/getStructureNodeId'\nimport {PreviewLayoutKey, InitialValueTemplateItem} from 'sanity'\n\nfunction noChildResolver() {\n  return undefined\n}\n\n/** @internal */\nexport const shallowIntentChecker: IntentChecker = (intentName, params, {pane, index}): boolean => {\n  return index <= 1 && defaultIntentChecker(intentName, params, {pane, index})\n}\n\n/**\n * Interface for list display options\n *\n * @public */\nexport interface ListDisplayOptions {\n  /** Check if list display should show icons */\n  showIcons?: boolean\n}\n\n/**\n * Interface for base generic list\n *\n * @public\n */\nexport interface BaseGenericList extends StructureNode {\n  /** List layout key. */\n  defaultLayout?: PreviewLayoutKey\n  /** Can handle intent. See {@link IntentChecker} */\n  canHandleIntent?: IntentChecker\n  /** List display options. See {@link ListDisplayOptions} */\n  displayOptions?: ListDisplayOptions\n  /** List child. See {@link Child} */\n  child: Child\n  /** List initial values array. See {@link InitialValueTemplateItem} and {@link InitialValueTemplateItemBuilder} */\n  initialValueTemplates?: (InitialValueTemplateItem | InitialValueTemplateItemBuilder)[]\n}\n\n/**\n * Interface for generic list\n *\n * @public\n */\n// \"POJO\"/verbatim-version - end result\nexport interface GenericList extends BaseGenericList {\n  /** List type */\n  type: string\n  /** List menu items array. See {@link MenuItem} */\n  menuItems: MenuItem[]\n  /** List menu item groups array. See {@link MenuItemGroup} */\n  menuItemGroups: MenuItemGroup[]\n}\n\n/**\n * Interface for buildable generic list\n *\n * @public\n */\n// Used internally in builder classes to make everything optional\nexport interface BuildableGenericList extends Partial<BaseGenericList> {\n  /** List menu items array. See {@link MenuItem} and {@link MenuItemBuilder} */\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  /** List menu items groups array. See {@link MenuItemGroup} and {@link MenuItemGroupBuilder} */\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n}\n\n/**\n * Interface for generic list input\n * Allows builders and only requires things not inferrable\n *\n * @public */\n// Input version, allows builders and only requires things not inferrable\nexport interface GenericListInput extends StructureNode {\n  /** Input id */\n  id: string\n  /** Input title */\n  title: string\n  /** Input menu items groups. See {@link MenuItem} and {@link MenuItemBuilder} */\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  /** Input menu items groups. See {@link MenuItemGroup} and {@link MenuItemGroupBuilder} */\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n  /** Input initial value array. See {@link InitialValueTemplateItem} and {@link InitialValueTemplateItemBuilder} */\n  initialValueTemplates?: (InitialValueTemplateItem | InitialValueTemplateItemBuilder)[]\n  /** Input default layout. */\n  defaultLayout?: PreviewLayoutKey\n  /** If input can handle intent. See {@link IntentChecker} */\n  canHandleIntent?: IntentChecker\n  /** Input child of type {@link Child} */\n  child?: Child\n}\n\n/**\n * Class for building generic lists\n *\n * @public\n */\nexport abstract class GenericListBuilder<TList extends BuildableGenericList, ConcreteImpl>\n  implements Serializable<GenericList>\n{\n  /** Check if initial value templates are set */\n  protected initialValueTemplatesSpecified = false\n  /** Generic list option object */\n  protected spec: TList = {} as TList\n\n  /** Set generic list ID\n   * @param id - generic list ID\n   * @returns generic list builder based on ID provided.\n   */\n  id(id: string): ConcreteImpl {\n    return this.clone({id})\n  }\n\n  /** Get generic list ID\n   * @returns generic list ID\n   */\n  getId(): TList['id'] {\n    return this.spec.id\n  }\n\n  /** Set generic list title\n   * @param title - generic list title\n   * @returns generic list builder based on title and ID provided.\n   */\n  title(title: string): ConcreteImpl {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  /** Get generic list title\n   * @returns generic list title\n   */\n  getTitle(): TList['title'] {\n    return this.spec.title\n  }\n\n  /** Set generic list layout\n   * @param defaultLayout - generic list layout key.\n   * @returns generic list builder based on layout provided.\n   */\n  defaultLayout(defaultLayout: PreviewLayoutKey): ConcreteImpl {\n    return this.clone({defaultLayout})\n  }\n\n  /** Get generic list layout\n   * @returns generic list layout\n   */\n  getDefaultLayout(): TList['defaultLayout'] {\n    return this.spec.defaultLayout\n  }\n\n  /** Set generic list menu items\n   * @param menuItems - generic list menu items. See {@link MenuItem} and {@link MenuItemBuilder}\n   * @returns generic list builder based on menu items provided.\n   */\n  menuItems(menuItems: (MenuItem | MenuItemBuilder)[] | undefined): ConcreteImpl {\n    return this.clone({menuItems})\n  }\n\n  /** Get generic list menu items\n   * @returns generic list menu items\n   */\n  getMenuItems(): TList['menuItems'] {\n    return this.spec.menuItems\n  }\n\n  /** Set generic list menu item groups\n   * @param menuItemGroups - generic list menu item groups. See {@link MenuItemGroup} and {@link MenuItemGroupBuilder}\n   * @returns generic list builder based on menu item groups provided.\n   */\n  menuItemGroups(menuItemGroups: (MenuItemGroup | MenuItemGroupBuilder)[]): ConcreteImpl {\n    return this.clone({menuItemGroups})\n  }\n\n  /** Get generic list menu item groups\n   * @returns generic list menu item groups\n   */\n  getMenuItemGroups(): TList['menuItemGroups'] {\n    return this.spec.menuItemGroups\n  }\n\n  /** Set generic list child\n   * @param child - generic list child. See {@link Child}\n   * @returns generic list builder based on child provided (clone).\n   */\n  child(child: Child): ConcreteImpl {\n    return this.clone({child})\n  }\n\n  /** Get generic list child\n   * @returns generic list child\n   */\n  getChild(): TList['child'] {\n    return this.spec.child\n  }\n\n  /** Set generic list can handle intent\n   * @param canHandleIntent - generic list intent checker. See {@link IntentChecker}\n   * @returns generic list builder based on can handle intent provided.\n   */\n  canHandleIntent(canHandleIntent: IntentChecker): ConcreteImpl {\n    return this.clone({canHandleIntent})\n  }\n\n  /** Get generic list can handle intent\n   * @returns generic list can handle intent\n   */\n  getCanHandleIntent(): TList['canHandleIntent'] {\n    return this.spec.canHandleIntent\n  }\n\n  /** Set generic list display options\n   * @param enabled - allow / disallow for showing icons\n   * @returns generic list builder based on display options (showIcons) provided.\n   */\n  showIcons(enabled = true): ConcreteImpl {\n    return this.clone({\n      displayOptions: {...(this.spec.displayOptions || {}), showIcons: enabled},\n    })\n  }\n\n  /** Get generic list display options\n   * @returns generic list display options (specifically showIcons)\n   */\n  getShowIcons(): boolean | undefined {\n    return this.spec.displayOptions ? this.spec.displayOptions.showIcons : undefined\n  }\n\n  /** Set generic list initial value templates\n   * @param templates - generic list initial value templates. See {@link InitialValueTemplateItemBuilder}\n   * @returns generic list builder based on templates provided.\n   */\n  initialValueTemplates(\n    templates:\n      | InitialValueTemplateItem\n      | InitialValueTemplateItemBuilder\n      | Array<InitialValueTemplateItem | InitialValueTemplateItemBuilder>,\n  ): ConcreteImpl {\n    this.initialValueTemplatesSpecified = true\n    return this.clone({initialValueTemplates: Array.isArray(templates) ? templates : [templates]})\n  }\n\n  /** Get generic list initial value templates\n   * @returns generic list initial value templates\n   */\n  getInitialValueTemplates(): TList['initialValueTemplates'] {\n    return this.spec.initialValueTemplates\n  }\n\n  /** Serialize generic list\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns generic list object based on path provided in options. See {@link GenericList}\n   */\n  serialize(options: SerializeOptions = {path: []}): GenericList {\n    const id = this.spec.id || ''\n    const path = options.path\n\n    const defaultLayout = this.spec.defaultLayout\n    if (defaultLayout && !layoutOptions.includes(defaultLayout)) {\n      throw new SerializeError(\n        `\\`layout\\` must be one of ${layoutOptions.map((item) => `\"${item}\"`).join(', ')}`,\n        path,\n        id || options.index,\n        this.spec.title,\n      )\n    }\n\n    const initialValueTemplates = (this.spec.initialValueTemplates || []).map((item, i) =>\n      maybeSerializeInitialValueTemplateItem(item, i, path),\n    )\n\n    return {\n      id: validateId(id, options.path, id || options.index),\n      title: this.spec.title,\n      type: 'genericList',\n      defaultLayout,\n      child: this.spec.child || noChildResolver,\n      canHandleIntent: this.spec.canHandleIntent || shallowIntentChecker,\n      displayOptions: this.spec.displayOptions,\n      initialValueTemplates,\n      menuItems: (this.spec.menuItems || []).map((item, i) =>\n        maybeSerializeMenuItem(item, i, path),\n      ),\n      menuItemGroups: (this.spec.menuItemGroups || []).map((item, i) =>\n        maybeSerializeMenuItemGroup(item, i, path),\n      ),\n    }\n  }\n\n  /** Clone generic list builder (allows for options overriding)\n   * @param _withSpec - generic list options.\n   * @returns generic list builder.\n   */\n  abstract clone(_withSpec?: object): ConcreteImpl\n}\n", "import {SchemaType, SortOrderingItem} from '@sanity/types'\nimport {ComposeIcon} from '@sanity/icons'\nimport {generateHelpUrl} from '@sanity/generate-help-url'\nimport {resolveTypeForDocument} from './util/resolveTypeForDocument'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {SerializeOptions, Child} from './StructureNodes'\nimport {ChildResolver, ChildResolverOptions, ItemChild} from './ChildResolver'\nimport {\n  GenericListBuilder,\n  BuildableGenericList,\n  GenericList,\n  GenericListInput,\n} from './GenericList'\nimport {DocumentBuilder} from './Document'\nimport {StructureContext} from './types'\nimport {DEFAULT_STUDIO_CLIENT_OPTIONS, InitialValueTemplateItem} from 'sanity'\n\nconst validateFilter = (spec: PartialDocumentList, options: SerializeOptions) => {\n  const filter = spec.options?.filter.trim() || ''\n\n  if (['*', '{'].includes(filter[0])) {\n    throw new SerializeError(\n      `\\`filter\\` cannot start with \\`${filter[0]}\\` - looks like you are providing a query, not a filter`,\n      options.path,\n      spec.id,\n      spec.title,\n    ).withHelpUrl(HELP_URL.QUERY_PROVIDED_FOR_FILTER)\n  }\n\n  return filter\n}\n\nconst createDocumentChildResolverForItem =\n  (context: StructureContext): ChildResolver =>\n  (itemId: string, options: ChildResolverOptions): ItemChild | Promise<ItemChild> | undefined => {\n    const parentItem = options.parent as DocumentList\n    const template = options.params?.template\n      ? context.templates.find((tpl) => tpl.id === options.params.template)\n      : undefined\n    const type = template\n      ? template.schemaType\n      : parentItem.schemaTypeName || resolveTypeForDocument(context.getClient, itemId)\n\n    return Promise.resolve(type).then((schemaType) =>\n      schemaType\n        ? context.resolveDocumentNode({schemaType, documentId: itemId})\n        : new DocumentBuilder(context).id('editor').documentId(itemId).schemaType(''),\n    )\n  }\n\n/**\n * Partial document list\n *\n * @public\n */\nexport interface PartialDocumentList extends BuildableGenericList {\n  /** Document list options. See {@link DocumentListOptions} */\n  options?: DocumentListOptions\n  /** Schema type name */\n  schemaTypeName?: string\n}\n\n/**\n * Interface for document list input\n *\n * @public\n */\nexport interface DocumentListInput extends GenericListInput {\n  /** Document list options. See {@link DocumentListOptions} */\n  options: DocumentListOptions\n}\n\n/**\n * Interface for document list\n *\n * @public\n */\nexport interface DocumentList extends GenericList {\n  type: 'documentList'\n  /** Document list options. See {@link DocumentListOptions} */\n  options: DocumentListOptions\n  /** Document list child. See {@link Child} */\n  child: Child\n  /** Document schema type name */\n  schemaTypeName?: string\n}\n\n/**\n * Interface for document List options\n *\n * @public\n */\nexport interface DocumentListOptions {\n  /** Document list filter */\n  filter: string\n  /** Document list parameters */\n  params?: Record<string, unknown>\n  /** Document list API version */\n  apiVersion?: string\n  /** Document list API default ordering array. */\n  defaultOrdering?: SortOrderingItem[]\n}\n\n/**\n * Class for building document list\n *\n * @public\n */\nexport class DocumentListBuilder extends GenericListBuilder<\n  PartialDocumentList,\n  DocumentListBuilder\n> {\n  /** Document list options. See {@link PartialDocumentList} */\n  protected spec: PartialDocumentList\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: DocumentListInput,\n  ) {\n    super()\n    this.spec = spec || {}\n    this.initialValueTemplatesSpecified = Boolean(spec?.initialValueTemplates)\n  }\n\n  /** Set API version\n   * @param apiVersion - API version\n   * @returns document list builder based on the options and API version provided. See {@link DocumentListBuilder}\n   */\n  apiVersion(apiVersion: string): DocumentListBuilder {\n    return this.clone({options: {...(this.spec.options || {filter: ''}), apiVersion}})\n  }\n\n  /** Get API version\n   * @returns API version\n   */\n  getApiVersion(): string | undefined {\n    return this.spec.options?.apiVersion\n  }\n\n  /** Set Document list filter\n   * @param filter - filter\n   * @returns document list builder based on the options and filter provided. See {@link DocumentListBuilder}\n   */\n  filter(filter: string): DocumentListBuilder {\n    return this.clone({options: {...(this.spec.options || {}), filter}})\n  }\n\n  /** Get Document list filter\n   * @returns filter\n   */\n  getFilter(): string | undefined {\n    return this.spec.options?.filter\n  }\n\n  /** Set Document list schema type name\n   * @param type - schema type name.\n   * @returns document list builder based on the schema type name provided. See {@link DocumentListBuilder}\n   */\n  schemaType(type: SchemaType | string): DocumentListBuilder {\n    const schemaTypeName = typeof type === 'string' ? type : type.name\n    return this.clone({schemaTypeName})\n  }\n\n  /** Get Document list schema type name\n   * @returns schema type name\n   */\n  getSchemaType(): string | undefined {\n    return this.spec.schemaTypeName\n  }\n\n  /** Set Document list options' parameters\n   * @param params - parameters\n   * @returns document list builder based on the options provided. See {@link DocumentListBuilder}\n   */\n  params(params: Record<string, unknown>): DocumentListBuilder {\n    return this.clone({\n      options: {...(this.spec.options || {filter: ''}), params},\n    })\n  }\n\n  /** Get Document list options' parameters\n   * @returns options\n   */\n  getParams(): Record<string, unknown> | undefined {\n    return this.spec.options?.params\n  }\n\n  /** Set Document list default ordering\n   * @param ordering - default sort ordering array. See {@link SortOrderingItem}\n   * @returns document list builder based on ordering provided. See {@link DocumentListBuilder}\n   */\n  defaultOrdering(ordering: SortOrderingItem[]): DocumentListBuilder {\n    if (!Array.isArray(ordering)) {\n      throw new Error('`defaultOrdering` must be an array of order clauses')\n    }\n\n    return this.clone({\n      options: {...(this.spec.options || {filter: ''}), defaultOrdering: ordering},\n    })\n  }\n\n  /** Get Document list default ordering\n   * @returns default ordering. See {@link SortOrderingItem}\n   */\n  getDefaultOrdering(): SortOrderingItem[] | undefined {\n    return this.spec.options?.defaultOrdering\n  }\n\n  /** Serialize Document list\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns document list object based on path provided in options. See {@link DocumentList}\n   */\n  serialize(options: SerializeOptions = {path: []}): DocumentList {\n    if (typeof this.spec.id !== 'string' || !this.spec.id) {\n      throw new SerializeError(\n        '`id` is required for document lists',\n        options.path,\n        options.index,\n        this.spec.title,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!this.spec.options || !this.spec.options.filter) {\n      throw new SerializeError(\n        '`filter` is required for document lists',\n        options.path,\n        this.spec.id,\n        this.spec.title,\n      ).withHelpUrl(HELP_URL.FILTER_REQUIRED)\n    }\n\n    const hasSimpleFilter = this.spec.options?.filter === '_type == $type'\n    if (!hasSimpleFilter && this.spec.options.filter && !this.spec.options.apiVersion) {\n      console.warn(\n        `No apiVersion specified for document type list with custom filter: \\`${this.spec.options.filter}\\`. This will be required in the future. See %s for more info.`,\n        generateHelpUrl(HELP_URL.API_VERSION_REQUIRED_FOR_CUSTOM_FILTER),\n      )\n    }\n    return {\n      ...super.serialize(options),\n      type: 'documentList',\n      schemaTypeName: this.spec.schemaTypeName,\n      child: this.spec.child || createDocumentChildResolverForItem(this._context),\n      options: {\n        ...this.spec.options,\n        // @todo: make specifying .apiVersion required when using custom (non-simple) filters in v4\n        apiVersion: this.spec.options.apiVersion || DEFAULT_STUDIO_CLIENT_OPTIONS.apiVersion,\n        filter: validateFilter(this.spec, options),\n      },\n    }\n  }\n\n  /** Clone Document list builder (allows for options overriding)\n   * @param withSpec - override document list spec. See {@link PartialDocumentList}\n   * @returns document list builder. See {@link DocumentListBuilder}\n   */\n  clone(withSpec?: PartialDocumentList): DocumentListBuilder {\n    const builder = new DocumentListBuilder(this._context)\n    builder.spec = {...this.spec, ...(withSpec || {})}\n\n    if (!this.initialValueTemplatesSpecified) {\n      builder.spec.initialValueTemplates = inferInitialValueTemplates(this._context, builder.spec)\n    }\n\n    if (!builder.spec.schemaTypeName) {\n      builder.spec.schemaTypeName = inferTypeName(builder.spec)\n    }\n\n    return builder\n  }\n\n  /** Get Document list spec\n   * @returns document list spec. See {@link PartialDocumentList}\n   */\n  getSpec(): PartialDocumentList {\n    return this.spec\n  }\n}\n\nfunction inferInitialValueTemplates(\n  context: StructureContext,\n  spec: PartialDocumentList,\n): InitialValueTemplateItem[] | undefined {\n  const {document} = context\n  const {schemaTypeName, options} = spec\n  const {filter, params} = options || {filter: '', params: {}}\n  const typeNames = schemaTypeName\n    ? [schemaTypeName]\n    : Array.from(new Set(getTypeNamesFromFilter(filter, params)))\n\n  if (typeNames.length === 0) {\n    return undefined\n  }\n\n  return typeNames\n    .flatMap((schemaType) =>\n      document.resolveNewDocumentOptions({\n        type: 'structure',\n        schemaType,\n      }),\n    )\n    .map((option) => ({...option, icon: ComposeIcon}))\n}\n\nfunction inferTypeName(spec: PartialDocumentList): string | undefined {\n  const {options} = spec\n  const {filter, params} = options || {filter: '', params: {}}\n  const typeNames = getTypeNamesFromFilter(filter, params)\n  return typeNames.length === 1 ? typeNames[0] : undefined\n}\n\n/** @internal */\nexport function getTypeNamesFromFilter(\n  filter: string,\n  params: Record<string, unknown> = {},\n): string[] {\n  let typeNames = getTypeNamesFromEqualityFilter(filter, params)\n\n  if (typeNames.length === 0) {\n    typeNames = getTypeNamesFromInTypesFilter(filter, params)\n  }\n\n  return typeNames\n}\n\n// From _type == \"movie\" || _type == $otherType\nfunction getTypeNamesFromEqualityFilter(\n  filter: string,\n  params: Record<string, unknown> = {},\n): string[] {\n  const pattern =\n    /\\b_type\\s*==\\s*(['\"].*?['\"]|\\$.*?(?:\\s|$))|\\B(['\"].*?['\"]|\\$.*?(?:\\s|$))\\s*==\\s*_type/g\n  const matches: string[] = []\n  let match\n  while ((match = pattern.exec(filter)) !== null) {\n    matches.push(match[1] || match[2])\n  }\n\n  return matches\n    .map((candidate) => {\n      const typeName = candidate[0] === '$' ? params[candidate.slice(1)] : candidate\n      const normalized = ((typeName as string) || '').trim().replace(/^[\"']|[\"']$/g, '')\n      return normalized\n    })\n    .filter(Boolean)\n}\n\n// From _type in [\"dog\", \"cat\", $otherSpecies]\nfunction getTypeNamesFromInTypesFilter(\n  filter: string,\n  params: Record<string, unknown> = {},\n): string[] {\n  const pattern = /\\b_type\\s+in\\s+\\[(.*?)\\]/\n  const matches = filter.match(pattern)\n  if (!matches) {\n    return []\n  }\n\n  return matches[1]\n    .split(/,\\s*/)\n    .map((match) => match.trim().replace(/^[\"']+|[\"']+$/g, ''))\n    .map((item) => (item[0] === '$' ? params[item.slice(1)] : item))\n    .filter(Boolean) as string[]\n}\n", "import {find} from 'lodash'\nimport {SerializePath, SerializeOptions, Divider} from './StructureNodes'\nimport {ChildResolverOptions, ChildResolver} from './ChildResolver'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {ListItem, ListItemBuilder} from './ListItem'\nimport {IntentChecker} from './Intent'\nimport {isDocumentListItem} from './DocumentListItem'\nimport {\n  GenericListBuilder,\n  BuildableGenericList,\n  GenericList,\n  GenericListInput,\n  shallowIntentChecker,\n} from './GenericList'\nimport {StructureContext} from './types'\nimport {isRecord} from 'sanity'\n\nconst getArgType = (thing: ListItem) => {\n  if (thing instanceof ListBuilder) {\n    return 'ListBuilder'\n  }\n\n  if (isPromise<ListItem>(thing)) {\n    return 'Promise'\n  }\n\n  return Array.isArray(thing) ? 'array' : typeof thing\n}\n\nconst isListItem = (item: ListItem | Divider): item is ListItem => {\n  return item.type === 'listItem'\n}\n\nconst defaultCanHandleIntent: IntentChecker = (intentName: string, params, context) => {\n  const pane = context.pane as List\n  const items = pane.items || []\n  return (\n    items\n      .filter(isDocumentListItem)\n      .some((item) => item.schemaType.name === params.type && item._id === params.id) ||\n    shallowIntentChecker(intentName, params, context)\n  )\n}\n\nconst resolveChildForItem: ChildResolver = (itemId: string, options: ChildResolverOptions) => {\n  const parentItem = options.parent as List\n  const items = parentItem.items.filter(isListItem)\n  const target = (items.find((item) => item.id === itemId) || {child: undefined}).child\n\n  if (!target || typeof target !== 'function') {\n    return target\n  }\n\n  return typeof target === 'function' ? target(itemId, options) : target\n}\n\nfunction maybeSerializeListItem(\n  item: ListItem | ListItemBuilder | Divider,\n  index: number,\n  path: SerializePath,\n): ListItem | Divider {\n  if (item instanceof ListItemBuilder) {\n    return item.serialize({path, index})\n  }\n\n  const listItem = item as ListItem\n  if (listItem && listItem.type === 'divider') {\n    return item as Divider\n  }\n\n  if (!listItem || listItem.type !== 'listItem') {\n    const gotWhat = (listItem && listItem.type) || getArgType(listItem)\n    const helpText = gotWhat === 'array' ? ' - did you forget to spread (...moreItems)?' : ''\n    throw new SerializeError(\n      `List items must be of type \"listItem\", got \"${gotWhat}\"${helpText}`,\n      path,\n      index,\n    ).withHelpUrl(HELP_URL.INVALID_LIST_ITEM)\n  }\n\n  return item\n}\n\nfunction isPromise<T>(thing: unknown): thing is PromiseLike<T> {\n  return isRecord(thing) && typeof thing.then === 'function'\n}\n\n/**\n * Interface for List\n *\n * @public\n */\nexport interface List extends GenericList {\n  type: 'list'\n  /** List items. See {@link ListItem} and {@link Divider} */\n  items: (ListItem | Divider)[]\n}\n\n/**\n * Interface for list input\n *\n * @public\n */\nexport interface ListInput extends GenericListInput {\n  /** List input items array. See {@link ListItem}, {@link ListItemBuilder} and {@link Divider} */\n  items?: (ListItem | ListItemBuilder | Divider)[]\n}\n\n/**\n * Interface for buildable list\n *\n * @public\n */\nexport interface BuildableList extends BuildableGenericList {\n  /** List items. See {@link ListItem}, {@link ListItemBuilder} and {@link Divider} */\n  items?: (ListItem | ListItemBuilder | Divider)[]\n}\n\n/**\n * A `ListBuilder` is used to build a list of items in the desk tool.\n *\n * @public */\nexport class ListBuilder extends GenericListBuilder<BuildableList, ListBuilder> {\n  /** buildable list option object. See {@link BuildableList} */\n  protected spec: BuildableList\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: ListInput,\n  ) {\n    super()\n    this.spec = spec ? spec : {}\n    this.initialValueTemplatesSpecified = Boolean(spec && spec.initialValueTemplates)\n  }\n\n  /**\n   * Set list builder based on items provided\n   * @param items - list items. See {@link ListItemBuilder}, {@link ListItem} and {@link Divider}\n   * @returns list builder based on items provided. See {@link ListBuilder}\n   */\n  items(items: (ListItemBuilder | ListItem | Divider)[]): ListBuilder {\n    return this.clone({items})\n  }\n\n  /** Get list builder items\n   * @returns list items. See {@link BuildableList}\n   */\n  getItems(): BuildableList['items'] {\n    return this.spec.items\n  }\n\n  /** Serialize list builder\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns list based on path in options. See {@link List}\n   */\n  serialize(options: SerializeOptions = {path: []}): List {\n    const id = this.spec.id\n    if (typeof id !== 'string' || !id) {\n      throw new SerializeError(\n        '`id` is required for lists',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    const items = typeof this.spec.items === 'undefined' ? [] : this.spec.items\n    if (!Array.isArray(items)) {\n      throw new SerializeError(\n        '`items` must be an array of items',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.LIST_ITEMS_MUST_BE_ARRAY)\n    }\n\n    const path = (options.path || []).concat(id)\n    const serializedItems = items.map((item, index) => maybeSerializeListItem(item, index, path))\n    const dupes = serializedItems.filter((val, i) => find(serializedItems, {id: val.id}, i + 1))\n\n    if (dupes.length > 0) {\n      const dupeIds = dupes.map((item) => item.id).slice(0, 5)\n      const dupeDesc = dupes.length > 5 ? `${dupeIds.join(', ')}...` : dupeIds.join(', ')\n      throw new SerializeError(\n        `List items with same ID found (${dupeDesc})`,\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.LIST_ITEM_IDS_MUST_BE_UNIQUE)\n    }\n\n    return {\n      ...super.serialize(options),\n      type: 'list',\n      canHandleIntent: this.spec.canHandleIntent || defaultCanHandleIntent,\n      child: this.spec.child || resolveChildForItem,\n      items: serializedItems,\n    }\n  }\n\n  /**\n   * Clone list builder and return new list builder based on context and spec provided\n   * @param withSpec - list options. See {@link BuildableList}\n   * @returns new list builder based on context and spec provided. See {@link ListBuilder}\n   */\n  clone(withSpec?: BuildableList): ListBuilder {\n    const builder = new ListBuilder(this._context)\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n", "import {SchemaType} from '@sanity/types'\nimport {Observable} from 'rxjs'\nimport {SerializeOptions, Serializable, Collection, CollectionBuilder} from './StructureNodes'\nimport {ChildResolver, ItemChild} from './ChildResolver'\nimport {DocumentListBuilder} from './DocumentList'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {ListBuilder} from './List'\nimport {DocumentBuilder} from './Document'\nimport {ComponentBuilder} from './Component'\nimport {validateId} from './util/validateId'\nimport {StructureContext} from './types'\nimport {getStructureNodeId} from './util/getStructureNodeId'\n\n/**\n * Unserialized list item child.\n * See {@link Collection}, {@link CollectionBuilder}, {@link ChildResolver} and {@link ItemChild}\n *\n * @public\n */\nexport type UnserializedListItemChild =\n  | Collection\n  | CollectionBuilder\n  | ChildResolver\n  | Observable<ItemChild>\n\n/**\n * Child of List Item\n * See {@link Collection}, {@link ChildResolver}, {@link ItemChild}\n * @public\n */\nexport type ListItemChild = Collection | ChildResolver | Observable<ItemChild> | undefined\n\n/**\n * Interface for serialize list item options\n *\n * @public\n */\nexport interface ListItemSerializeOptions extends SerializeOptions {\n  /** Check if list item title is optional */\n  titleIsOptional?: boolean\n}\n\n/**\n * Interface for ist item display options\n *\n * @public */\nexport interface ListItemDisplayOptions {\n  /** Check if list item display should show icon */\n  showIcon?: boolean\n}\n\n/**\n * interface for list item input\n *\n * @public */\nexport interface ListItemInput {\n  /** List item id */\n  id: string\n  /** List item title */\n  title?: string\n  /** List item icon */\n  icon?: React.ComponentType | React.ReactNode\n  /** List item child. See {@link ListItemChild} */\n  child?: ListItemChild\n  /** List item display options. See {@link ListItemDisplayOptions} */\n  displayOptions?: ListItemDisplayOptions\n  /** List item schema type. See {@link SchemaType} */\n  schemaType?: SchemaType | string\n}\n\n/**\n * Interface for List Item\n *\n * @public */\nexport interface ListItem {\n  /** List item id */\n  id: string\n  /** List item type */\n  type: string\n  /** List item title */\n  title?: string\n  /** List item icon */\n  icon?: React.ComponentType | React.ReactNode\n  /** List item child. See {@link ListItemChild} */\n  child?: ListItemChild\n  /** List item display options. See {@link ListItemDisplayOptions} */\n  displayOptions?: ListItemDisplayOptions\n  /** List item schema type. See {@link SchemaType} */\n  schemaType?: SchemaType\n}\n\n/**\n * Interface for unserialized list items.\n *\n * @public\n */\nexport interface UnserializedListItem {\n  /** List item ID */\n  id: string\n  /** List item title */\n  title: string\n  /** List item icon */\n  icon?: React.ComponentType | React.ReactNode\n  /** List item child. See {@link UnserializedListItemChild} */\n  child?: UnserializedListItemChild\n  /** List item display options. See {@link ListItemDisplayOptions} */\n  displayOptions?: ListItemDisplayOptions\n  /** List item schema. See {@link SchemaType} */\n  schemaType?: SchemaType | string\n}\n\n/**\n * Partial list item. See {@link UnserializedListItem}\n *\n * @public */\nexport type PartialListItem = Partial<UnserializedListItem>\n\n/**\n * Class for building list items\n *\n * @public */\nexport class ListItemBuilder implements Serializable<ListItem> {\n  /** List item option object. See {@link PartialListItem} */\n  protected spec: PartialListItem\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: ListItemInput,\n  ) {\n    this.spec = spec ? spec : {}\n  }\n\n  /**\n   * Set list item ID\n   * @returns list item builder based on ID provided. See {@link ListItemBuilder}\n   */\n  id(id: string): ListItemBuilder {\n    return this.clone({id})\n  }\n\n  /**\n   * Get list item ID\n   * @returns list item ID. See {@link PartialListItem}\n   */\n  getId(): PartialListItem['id'] {\n    return this.spec.id\n  }\n\n  /**\n   * Set list item title\n   * @returns list item builder based on title provided. See {@link ListItemBuilder}\n   */\n  title(title: string): ListItemBuilder {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  /**\n   * Get list item title\n   * @returns list item title. See {@link PartialListItem}\n   */\n  getTitle(): PartialListItem['title'] {\n    return this.spec.title\n  }\n\n  /**\n   * Set list item icon\n   * @returns list item builder based on icon provided. See {@link ListItemBuilder}\n   */\n  icon(icon: React.ComponentType | React.ReactNode): ListItemBuilder {\n    return this.clone({icon})\n  }\n\n  /**\n   * Set if list item should show icon\n   * @returns list item builder based on showIcon provided. See {@link ListItemBuilder}\n   */\n  showIcon(enabled = true): ListItemBuilder {\n    return this.clone({\n      displayOptions: {...(this.spec.displayOptions || {}), showIcon: enabled},\n    })\n  }\n\n  /**\n   * Check if list item should show icon\n   * @returns true if it should show the icon, false if not, undefined if not set\n   */\n  getShowIcon(): boolean | undefined {\n    return this.spec.displayOptions ? this.spec.displayOptions.showIcon : undefined\n  }\n\n  /**\n   *Get list item icon\n   * @returns list item icon. See {@link PartialListItem}\n   */\n  getIcon(): PartialListItem['icon'] {\n    return this.spec.icon\n  }\n\n  /**\n   * Set list item child\n   * @param child - list item child. See {@link UnserializedListItemChild}\n   * @returns list item builder based on child provided. See {@link ListItemBuilder}\n   */\n  child(child: UnserializedListItemChild): ListItemBuilder {\n    return this.clone({child})\n  }\n\n  /**\n   * Get list item child\n   * @returns list item child. See {@link PartialListItem}\n   */\n  getChild(): PartialListItem['child'] {\n    return this.spec.child\n  }\n\n  /**\n   * Set list item schema type\n   * @param schemaType - list item schema type. See {@link SchemaType}\n   * @returns list item builder based on schema type provided. See {@link ListItemBuilder}\n   */\n  schemaType(schemaType: SchemaType | string): ListItemBuilder {\n    return this.clone({schemaType})\n  }\n\n  /**\n   * Get list item schema type\n   * @returns list item schema type. See {@link PartialListItem}\n   */\n  getSchemaType(): PartialListItem['schemaType'] {\n    const schemaType = this.spec.schemaType\n\n    if (typeof schemaType === 'string') {\n      return this._context.schema.get(schemaType)\n    }\n\n    return this.spec.schemaType\n  }\n\n  /** Serialize list item builder\n   * @param options - serialization options. See {@link ListItemSerializeOptions}\n   * @returns list item node based on path provided in options. See {@link ListItem}\n   */\n  serialize(options: ListItemSerializeOptions = {path: []}): ListItem {\n    const {id, title, child} = this.spec\n    if (typeof id !== 'string' || !id) {\n      throw new SerializeError(\n        '`id` is required for list items',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!options.titleIsOptional && (typeof title !== 'string' || !title)) {\n      throw new SerializeError('`title` is required for list items', options.path, id).withHelpUrl(\n        HELP_URL.TITLE_REQUIRED,\n      )\n    }\n\n    let schemaType = this.spec.schemaType\n    if (typeof schemaType === 'string') {\n      const type = this._context.schema.get(schemaType)\n      if (!type) {\n        throw new SerializeError(\n          `Could not find type \"${schemaType}\" in schema`,\n          options.path,\n          id,\n        ).withHelpUrl(HELP_URL.SCHEMA_TYPE_NOT_FOUND)\n      }\n\n      schemaType = type\n    }\n\n    const serializeOptions = {path: options.path.concat(id), hint: 'child'}\n    let listChild =\n      child instanceof ComponentBuilder ||\n      child instanceof DocumentListBuilder ||\n      child instanceof DocumentBuilder ||\n      child instanceof ListBuilder\n        ? child.serialize(serializeOptions)\n        : child\n\n    // In the case of a function, create a bound version that will pass the correct serialize\n    // context, so we may lazily resolve it at some point in the future without losing context\n    if (typeof listChild === 'function') {\n      const originalChild = listChild\n      listChild = (itemId, childOptions) => {\n        return originalChild(itemId, {...childOptions, serializeOptions})\n      }\n    }\n\n    return {\n      ...this.spec,\n      id: validateId(id, options.path, options.index),\n      schemaType,\n      child: listChild,\n      title,\n      type: 'listItem',\n    }\n  }\n\n  /** Clone list item builder\n   * @param withSpec - partial list item options. See {@link PartialListItem}\n   * @returns list item builder based on context and spec provided. See {@link ListItemBuilder}\n   */\n  clone(withSpec?: PartialListItem): ListItemBuilder {\n    const builder = new ListItemBuilder(this._context)\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n", "import {SchemaType} from '@sanity/types'\nimport {SerializeOptions} from './StructureNodes'\nimport {ListItemBuilder, ListItem, UnserializedListItem, ListItemInput} from './ListItem'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {DocumentBuilder} from './Document'\nimport {StructureContext} from './types'\nimport {isRecord} from 'sanity'\n\n/**\n * Interface for document list item input\n *\n * @public\n */\nexport interface DocumentListItemInput extends ListItemInput {\n  /** Document list item input schema type. See {@link SchemaType} */\n  schemaType: SchemaType | string\n}\n\n/**\n * Interface for document list item\n *\n * @public\n */\nexport interface DocumentListItem extends ListItem {\n  /** Document schema type. See {@link SchemaType} */\n  schemaType: SchemaType\n  /** Document ID */\n  _id: string\n}\n\n/**\n * Partial document list item\n *\n * @public\n */\nexport type PartialDocumentListItem = Partial<UnserializedListItem>\n\nconst createDefaultChildResolver =\n  (context: StructureContext, spec: PartialDocumentListItem) => (documentId: string) => {\n    const schemaType =\n      spec.schemaType &&\n      (typeof spec.schemaType === 'string' ? spec.schemaType : spec.schemaType.name)\n\n    return schemaType\n      ? context.resolveDocumentNode({schemaType, documentId})\n      : new DocumentBuilder(context).id('documentEditor').documentId(documentId)\n  }\n\n/**\n * Class for building a document list item\n *\n * @public\n */\nexport class DocumentListItemBuilder extends ListItemBuilder {\n  /** Document list options. See {@link PartialDocumentListItem} */\n  protected spec: PartialDocumentListItem\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: DocumentListItemInput,\n  ) {\n    super(_context, spec)\n    this.spec = spec ? spec : {}\n  }\n\n  /**\n   * Serialize document list item\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns document list item object based on path provided in options. See {@link DocumentListItem}\n   */\n  serialize(options: SerializeOptions = {path: []}): DocumentListItem {\n    const spec = super.serialize({...options, titleIsOptional: true})\n\n    if (!spec.schemaType) {\n      throw new SerializeError(\n        '`schemaType` is required for document list items',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.SCHEMA_TYPE_REQUIRED)\n    }\n\n    const child = spec.child || createDefaultChildResolver(this._context, spec)\n    return {...spec, child, schemaType: spec.schemaType, _id: spec.id}\n  }\n\n  /** Clone Document list item builder (allows for options overriding)\n   * @param withSpec - Document list item builder options. See {@link PartialDocumentListItem}\n   * @returns document list item builder. See {@link DocumentListItemBuilder}\n   */\n  clone(withSpec?: PartialDocumentListItem): DocumentListItemBuilder {\n    const builder = new DocumentListItemBuilder(this._context)\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n\n/** @internal */\nexport function isDocumentListItem(item: unknown): item is DocumentListItem {\n  return isRecord(item) && typeof item.schemaType !== 'undefined' && typeof item._id === 'string'\n}\n", "import {SchemaType} from '@sanity/types'\nimport {DocumentListBuilder, DocumentListInput, PartialDocumentList} from './DocumentList'\nimport {Child} from './StructureNodes'\nimport {DEFAULT_INTENT_HANDLER} from './Intent'\nimport {GenericListInput} from './GenericList'\nimport {StructureContext} from './types'\n\n/**\n * Interface for document type list input\n *\n * @public\n */\nexport interface DocumentTypeListInput extends Partial<GenericListInput> {\n  /** Document type list input schema type. See {@link SchemaType} */\n  schemaType: SchemaType | string\n}\n\n/**\n * Class for building a document type list\n *\n * @public\n */\nexport class DocumentTypeListBuilder extends DocumentListBuilder {\n  /** Document list options. See {@link PartialDocumentList} */\n  protected spec: PartialDocumentList\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: DocumentListInput,\n  ) {\n    super(_context)\n    this.spec = spec ? spec : {}\n  }\n\n  /**\n   * Set Document type list child\n   * @param child - Child component. See {@link Child}\n   * @returns document type list builder based on child component provided without default intent handler. See {@link DocumentTypeListBuilder}\n   */\n  child(child: Child): DocumentTypeListBuilder {\n    return this.cloneWithoutDefaultIntentHandler({child})\n  }\n\n  /** Clone Document type list builder (allows for options overriding)\n   * @param withSpec - Document type list builder options. See {@link PartialDocumentList}\n   * @returns document type list builder. See {@link DocumentTypeListBuilder}\n   */\n  clone(withSpec?: PartialDocumentList): DocumentTypeListBuilder {\n    const parent = super.clone(withSpec)\n    const builder = new DocumentTypeListBuilder(this._context)\n    builder.spec = {...this.spec, ...parent.getSpec(), ...(withSpec || {})}\n    return builder\n  }\n\n  /** Clone Document type list builder (allows for options overriding) and remove default intent handler\n   * @param withSpec - Document type list builder options. See {@link PartialDocumentList}\n   * @returns document type list builder without default intent handler. See {@link DocumentTypeListBuilder}\n   */\n  cloneWithoutDefaultIntentHandler(withSpec?: PartialDocumentList): DocumentTypeListBuilder {\n    const parent = super.clone(withSpec)\n    const builder = new DocumentTypeListBuilder(this._context)\n    const canHandleIntent = this.spec.canHandleIntent\n    const shouldOverride = canHandleIntent && canHandleIntent.identity === DEFAULT_INTENT_HANDLER\n    const override = shouldOverride ? {canHandleIntent: undefined} : {}\n    builder.spec = {\n      ...parent.getSpec(),\n      ...this.spec,\n      ...(withSpec || {}),\n      ...override,\n    }\n    return builder\n  }\n}\n", "import {SchemaType} from '@sanity/types'\nimport {startCase} from 'lodash'\nimport {StackCompactIcon, StackIcon} from '@sanity/icons'\nimport {MenuItemBuilder, getOrderingMenuItemsForSchemaType} from './MenuItem'\nimport {DEFAULT_SELECTED_ORDERING_OPTION} from './Sort'\nimport {DocumentListBuilder} from './DocumentList'\nimport {ListItemBuilder, ListItem} from './ListItem'\nimport {DocumentTypeListBuilder, DocumentTypeListInput} from './DocumentTypeList'\nimport {defaultIntentChecker} from './Intent'\nimport {List} from './List'\nimport {Collection} from './StructureNodes'\nimport {StructureContext} from './types'\n\nfunction shouldShowIcon(schemaType: SchemaType): boolean {\n  const preview = schemaType.preview\n  return Boolean(preview && (preview.prepare || (preview.select && preview.select.media)))\n}\n\nconst BUNDLED_DOC_TYPES = ['sanity.imageAsset', 'sanity.fileAsset']\n\nfunction isBundledDocType(typeName: string) {\n  return BUNDLED_DOC_TYPES.includes(typeName)\n}\n\nfunction isDocumentType(schemaType: SchemaType) {\n  return schemaType.type?.name === 'document'\n}\n\nfunction isList(collection: Collection): collection is List {\n  return collection.type === 'list'\n}\n\nexport function getDocumentTypes({schema}: StructureContext): string[] {\n  return schema\n    .getTypeNames()\n    .filter((n) => {\n      const schemaType = schema.get(n)\n      return schemaType && isDocumentType(schemaType)\n    })\n    .filter((n) => !isBundledDocType(n))\n}\n\nexport function getDocumentTypeListItems(context: StructureContext): ListItemBuilder[] {\n  const types = getDocumentTypes(context)\n  return types.map((typeName) => getDocumentTypeListItem(context, typeName))\n}\n\nexport function getDocumentTypeListItem(\n  context: StructureContext,\n  typeName: string,\n): ListItemBuilder {\n  const {schema} = context\n\n  const type = schema.get(typeName)\n  if (!type) {\n    throw new Error(`Schema type with name \"${typeName}\" not found`)\n  }\n\n  const title = type.title || startCase(typeName)\n\n  return new ListItemBuilder(context)\n    .id(typeName)\n    .title(title)\n    .schemaType(type)\n    .child((id, childContext) => {\n      const parent = childContext.parent as Collection\n      const parentItem = isList(parent)\n        ? (parent.items.find((item) => item.id === id) as ListItem)\n        : null\n\n      let list = getDocumentTypeList(context, typeName)\n      if (parentItem && parentItem.title) {\n        list = list.title(parentItem.title)\n      }\n\n      return list\n    })\n}\n\nexport function getDocumentTypeList(\n  context: StructureContext,\n  typeNameOrSpec: string | DocumentTypeListInput,\n): DocumentListBuilder {\n  const {schema, resolveDocumentNode} = context\n\n  const schemaType = typeof typeNameOrSpec === 'string' ? typeNameOrSpec : typeNameOrSpec.schemaType\n  const typeName = typeof schemaType === 'string' ? schemaType : schemaType.name\n  const spec: DocumentTypeListInput =\n    typeof typeNameOrSpec === 'string' ? {schemaType} : typeNameOrSpec\n\n  const type = schema.get(typeName)\n  if (!type) {\n    throw new Error(`Schema type with name \"${typeName}\" not found`)\n  }\n\n  const title = type.title || startCase(typeName)\n  const showIcons = shouldShowIcon(type)\n\n  return new DocumentTypeListBuilder(context)\n    .id(spec.id || typeName)\n    .title(spec.title || title)\n    .filter('_type == $type')\n    .params({type: typeName})\n    .schemaType(type)\n    .showIcons(showIcons)\n    .defaultOrdering(DEFAULT_SELECTED_ORDERING_OPTION.by)\n    .menuItemGroups(\n      spec.menuItemGroups || [\n        {id: 'sorting', title: 'Sort'},\n        {id: 'layout', title: 'Layout'},\n        {id: 'actions', title: 'Actions'},\n      ],\n    )\n    .child(\n      spec.child ||\n        ((documentId: string) => resolveDocumentNode({schemaType: typeName, documentId})),\n    )\n    .canHandleIntent(spec.canHandleIntent || defaultIntentChecker)\n    .menuItems(\n      spec.menuItems || [\n        // Create new (from action button) will be added in serialization step of GenericList\n\n        // Sort by <Y>\n        ...getOrderingMenuItemsForSchemaType(context, type),\n\n        // Display as <Z>\n        new MenuItemBuilder(context)\n          .group('layout')\n          .title('Compact view')\n          .icon(StackCompactIcon)\n          .action('setLayout')\n          .params({layout: 'default'}),\n\n        new MenuItemBuilder(context)\n          .group('layout')\n          .title('Detailed view')\n          .icon(StackIcon)\n          .action('setLayout')\n          .params({layout: 'detail'}),\n\n        // Create new (from menu) will be added in serialization step of GenericList\n      ],\n    )\n}\n", "import {uniqueId} from 'lodash'\nimport type {SchemaType} from '@sanity/types'\nimport {isValidElementType} from 'react-is'\nimport {ListBuilder} from './List'\nimport {\n  getDocumentTypeListItems,\n  getDocumentTypeListItem,\n  getDocumentTypeList,\n} from './documentTypeListItems'\nimport {MenuItemBuilder, getOrderingMenuItemsForSchemaType, getOrderingMenuItem} from './MenuItem'\nimport {ListItemBuilder} from './ListItem'\nimport {MenuItemGroupBuilder} from './MenuItemGroup'\nimport {DocumentListBuilder} from './DocumentList'\nimport type {Divider} from './StructureNodes'\nimport {DocumentBuilder, documentFromEditor, documentFromEditorWithInitialValue} from './Document'\nimport {ComponentInput, ComponentBuilder} from './Component'\nimport {DocumentListItemBuilder} from './DocumentListItem'\nimport * as views from './views'\nimport {\n  InitialValueTemplateItemBuilder,\n  defaultInitialValueTemplateItems,\n  menuItemsFromInitialValueTemplateItems,\n} from './InitialValueTemplateItem'\nimport type {\n  StructureBuilder,\n  UserComponent,\n  StructureContext,\n  DefaultDocumentNodeResolver,\n} from './types'\nimport {Source, getConfigContextFromSource, getPublishedId} from 'sanity'\n\n/** @internal */\nexport interface StructureBuilderOptions {\n  source: Source\n  defaultDocumentNode?: DefaultDocumentNodeResolver\n}\n\nfunction hasIcon(schemaType?: SchemaType | string): boolean {\n  if (!schemaType || typeof schemaType === 'string') {\n    return false\n  }\n\n  return Boolean(schemaType.icon)\n}\n\nfunction getDefaultStructure(context: StructureContext): ListBuilder {\n  const items = getDocumentTypeListItems(context)\n  return new ListBuilder(context)\n    .id('__root__')\n    .title('Content')\n    .items(items)\n    .showIcons(items.some((item) => hasIcon(item.getSchemaType())))\n}\n\n/** @internal */\nexport function createStructureBuilder({\n  defaultDocumentNode,\n  source,\n}: StructureBuilderOptions): StructureBuilder {\n  const configContext = getConfigContextFromSource(source)\n  const context: StructureContext = {\n    ...source,\n    getStructureBuilder: () => structureBuilder,\n    resolveDocumentNode: (options) => {\n      let builder =\n        defaultDocumentNode?.(structureBuilder, {...options, ...configContext}) ||\n        new DocumentBuilder(context)\n\n      if (!builder.getId()) {\n        builder = builder.id('documentEditor')\n      }\n\n      if (options.documentId) {\n        builder = builder.documentId(getPublishedId(options.documentId))\n      }\n\n      return builder.schemaType(options.schemaType)\n    },\n  }\n\n  const structureBuilder: StructureBuilder = {\n    defaults: () => getDefaultStructure(context),\n    documentTypeList: (...args) => getDocumentTypeList(context, ...args),\n    documentTypeListItem: (...args) => getDocumentTypeListItem(context, ...args),\n    documentTypeListItems: (...args) => getDocumentTypeListItems(context, ...args),\n    document: (...args) => new DocumentBuilder(context, ...args),\n    documentWithInitialValueTemplate: (...args) =>\n      documentFromEditorWithInitialValue(context, ...args),\n    defaultDocument: context.resolveDocumentNode,\n\n    list: (...args) => new ListBuilder(context, ...args),\n    listItem: (...args) => new ListItemBuilder(context, ...args),\n\n    menuItem: (...args) => new MenuItemBuilder(context, ...args),\n    menuItemGroup: (...args) => new MenuItemGroupBuilder(context, ...args),\n    menuItemsFromInitialValueTemplateItems: (...args) =>\n      menuItemsFromInitialValueTemplateItems(context, ...args),\n\n    documentList: (...args) => new DocumentListBuilder(context, ...args),\n    documentListItem: (...args) => new DocumentListItemBuilder(context, ...args),\n\n    orderingMenuItem: (...args) => getOrderingMenuItem(context, ...args),\n    orderingMenuItemsForType: (...args) => getOrderingMenuItemsForSchemaType(context, ...args),\n\n    editor: (...args) => documentFromEditor(context, ...args),\n\n    defaultInitialValueTemplateItems: (...args) =>\n      defaultInitialValueTemplateItems(context, ...args),\n\n    initialValueTemplateItem: (\n      templateId: string,\n      parameters?: Record<string, unknown>,\n    ): InitialValueTemplateItemBuilder =>\n      new InitialValueTemplateItemBuilder(context, {\n        id: templateId,\n        parameters,\n        templateId,\n      }),\n\n    component: (spec?: ComponentInput | UserComponent) => {\n      return isValidElementType(spec)\n        ? new ComponentBuilder().component(spec as UserComponent)\n        : new ComponentBuilder(spec as ComponentInput)\n    },\n\n    divider: (): Divider => ({id: uniqueId('__divider__'), type: 'divider'}),\n\n    view: views,\n    context,\n  }\n\n  return structureBuilder\n}\n", "import React, {useMemo, useState} from 'react'\nimport {DeskToolContext} from './DeskToolContext'\nimport {createStructureBuilder, DefaultDocumentNodeResolver} from './structureBuilder'\nimport {DeskToolContextValue, StructureResolver, UnresolvedPaneNode} from './types'\nimport {useConfigContextFromSource, useDocumentStore, useSource} from 'sanity'\n\n/** @internal */\nexport interface DeskToolProviderProps {\n  structure?: StructureResolver\n  defaultDocumentNode?: DefaultDocumentNodeResolver\n  children: React.ReactNode\n}\n\n/** @internal */\nexport function DeskToolProvider({\n  defaultDocumentNode,\n  structure: resolveStructure,\n  children,\n}: DeskToolProviderProps): React.ReactElement {\n  const [layoutCollapsed, setLayoutCollapsed] = useState(false)\n  const source = useSource()\n  const configContext = useConfigContextFromSource(source)\n  const documentStore = useDocumentStore()\n\n  const S = useMemo(() => {\n    return createStructureBuilder({\n      defaultDocumentNode,\n      source,\n    })\n  }, [defaultDocumentNode, source])\n\n  const rootPaneNode = useMemo(() => {\n    // TODO: unify types and remove cast\n    if (resolveStructure)\n      return resolveStructure(S, {\n        ...configContext,\n        documentStore,\n      }) as UnresolvedPaneNode\n    return S.defaults() as UnresolvedPaneNode\n  }, [S, resolveStructure, configContext, documentStore])\n\n  const features: DeskToolContextValue['features'] = useMemo(\n    () => ({\n      backButton: layoutCollapsed,\n      resizablePanes: !layoutCollapsed,\n      reviewChanges: !layoutCollapsed,\n      splitPanes: !layoutCollapsed,\n      splitViews: !layoutCollapsed,\n    }),\n    [layoutCollapsed],\n  )\n\n  const deskTool: DeskToolContextValue = useMemo(() => {\n    return {\n      features,\n      layoutCollapsed,\n      setLayoutCollapsed,\n      rootPaneNode,\n      structureContext: S.context,\n    }\n  }, [features, layoutCollapsed, rootPaneNode, S.context])\n\n  return <DeskToolContext.Provider value={deskTool}>{children}</DeskToolContext.Provider>\n}\n"],
  "mappings": "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",
  "names": ["isNumber", "camelCase", "kebabCase", "format", "err", "obj", "_setPrototypeOf", "o", "p", "_getPrototypeOf", "CopyToClipboard", "require_lib", "CopyToClipboard", "Delay", "_ref", "children", "ms", "ready", "setReady", "useState", "useEffect", "timeoutId", "setTimeout", "clearTimeout", "jsx", "Fragment", "DocTitle", "props", "document", "documentValue", "schema", "useSchema", "schemaType", "get", "_type", "error", "value", "useValuePreview", "jsxs", "message", "title", "style", "color", "TimeAgo", "_ref2", "time", "timeAgo", "useTimeAgo", "isClientError", "e", "POLL_INTERVAL", "visiblePoll$", "getVisiblePoll$", "fromEvent", "pipe", "startWith", "map", "visibilityState", "distinctUntilChanged", "switchMap", "visible", "timer", "EMPTY", "shareReplay", "refCount", "bufferSize", "getDocumentExistence", "documentId", "_ref3", "versionedClient", "draftId", "getDraftId", "publishedId", "getPublishedId", "requestOptions", "uri", "getDataUrl", "concat", "json", "query", "excludeContent", "tag", "observable", "request", "_ref4", "omitted", "nonExistant", "filter", "doc", "reason", "length", "some", "id", "fetchCrossDatasetReferences", "context", "checkDocumentId", "of", "totalCount", "references", "currentDataset", "config", "dataset", "url", "catchError", "statusCode", "useInternalReferences", "createHookFromObservableFactory", "_ref5", "documentStore", "referencesClause", "totalClause", "fetchQuery", "listenQuery", "fetch", "listen", "transitions", "throttleTime", "useCrossDatasetReferences", "_ref6", "useReferringDocuments", "useClient", "DEFAULT_STUDIO_CLIENT_OPTIONS", "useDocumentStore", "internalReferences", "isInternalReferencesLoading", "useMemo", "crossDatasetReferences", "isCrossDatasetReferencesLoading", "projectIds", "Array", "from", "Set", "crossDatasetReference", "projectId", "Boolean", "sort", "datasetNames", "datasetName", "hasUnknownDatasetNames", "isLoading", "PublishedStatus", "updatedAt", "_updatedAt", "statusLabel", "Tooltip", "portal", "content", "Box", "padding", "Text", "size", "TextWithTone", "tone", "dimmed", "muted", "PublishIcon", "DraftStatus", "EditIcon", "PaneItemPreview", "icon", "layout", "presence", "isRecord", "isValidElement", "isString", "isNumber", "draft", "published", "useMemoObservable", "getPreviewStateObservable", "documentPreviewStore", "_id", "status", "Inline", "space", "DocumentPreviewPresence", "SanityDefaultPreview", "getPreviewValueWithFallback", "isPlaceholder", "missingContext", "Error", "PaneRouterContext", "createContext", "index", "groupIndex", "siblingIndex", "payload", "params", "hasGroupSiblings", "groupLength", "routerPanesState", "BackLink", "ChildLink", "ReferenceChildLink", "handleEditReference", "ParameterizedLink", "replaceCurrent", "closeCurrentAndAfter", "closeCurrent", "duplicateCurrent", "setView", "setParams", "setPayload", "navigateIntent", "forwardRef", "ref", "useContext", "panes", "slice", "state", "StateLink", "PaneLayoutContext", "usePaneLayout", "pane", "childId", "childPayload", "childParameters", "rest", "documentType", "parentRefPath", "template", "type", "pathToString", "currentPanes", "nextParams", "useUnique", "nextPayload", "nextState", "currentGroup", "currentSibling", "nextSibling", "nextGroup", "nextPanes", "usePaneRouter", "EMPTY_ARRAY", "ReferencePreviewLink", "onClick", "documentPresence", "useDocumentPresence", "useDocumentPreviewStore", "Link", "useCallback", "LinkComponent", "linkProps", "name", "PreviewCard", "__unstable_focusRing", "as", "radius", "_a", "_b", "_c", "_d", "_e", "ChevronWrapper", "styled", "__template", "CrossDatasetReferencesDetails", "details", "CrossDatasetReferencesSummary", "summary", "Table", "table", "_ref8", "theme", "rem", "sanity", "_ref9", "_ref10", "DocumentIdFlex", "Flex", "OtherReferenceCount", "difference", "placement", "Container", "width", "InfoOutlineIcon", "ConfirmDeleteDialogBody", "_ref11", "documentTitle", "action", "onReferenceLinkClick", "toast", "useToast", "renderPreviewItem", "item", "UnknownIcon", "subtitle", "documentCount", "toLocaleString", "normalizedDatasetNames", "datasetsCount", "datasetNameList", "join", "Card", "marginBottom", "flex", "WarningOutlineIcon", "marginLeft", "shadow", "direction", "Stack", "borderTop", "margin", "paddingY", "align", "marginRight", "DocumentsIcon", "textOverflow", "ChevronDownIcon", "overflow", "paddingBottom", "paddingX", "Label", "minWidth", "reference", "_ref12", "gap", "justify", "CopyToClipboard", "text", "onCopy", "push", "Button", "mode", "ClipboardIcon", "fontSize", "DialogBody", "attrs", "LoadingContainer", "ConfirmDeleteDialog", "_ref13", "onCancel", "onConfirm", "dialogId", "useId", "capitalizedAction", "substring", "toUpperCase", "showConfirmButton", "Dialog", "header", "footer", "Grid", "columns", "onClose", "onClickOutside", "Spinner", "marginTop", "ConfirmDeleteDialogContainer", "setError", "handleRetry", "ErrorBoundary", "onCatch", "MENU_GROUP_POPOVER_PROPS", "constrainSize", "PaneMenuButtonItem", "disabled", "isAfterGroup", "node", "MenuDivider", "expanded", "child", "childIndex", "key", "MenuGroup", "popover", "PaneContextMenuItemResolver", "intent", "PaneContextIntentMenuItem", "PaneContextMenuItem", "tooltipContent", "TooltipOfDisabled", "MenuItem", "hotkeys", "hotkey", "split", "iconRight", "selected", "CheckmarkIcon", "onAction", "pressed", "intentLink", "useIntentLink", "handleClick", "event", "href", "CONTEXT_MENU_POPOVER_PROPS", "nodesHasTone", "nodes", "PaneContextMenuButton", "hasCritical", "hasCaution", "MenuButton", "button", "StatusButton", "EllipsisVerticalIcon", "menu", "Menu", "nodeIndex", "PANE_DEBUG", "PANE_COLLAPSED_WIDTH", "PANE_DEFAULT_MIN_WIDTH", "PaneContext", "Root", "Layer", "PaneDivider", "_ref14", "element", "resize", "dragging", "setDragging", "handleMouseDown", "preventDefault", "startX", "pageX", "handleMouseMove", "deltaX", "handleMouseUp", "window", "removeEventListener", "addEventListener", "onMouseDown", "Pane", "currentMinWidth", "currentMinWidthProp", "currentMaxWidth", "currentMaxWidthProp", "flexProp", "minWidthProp", "maxWidth", "maxWidthProp", "restProps", "rootElement", "setRootElement", "collapse", "collapsed", "layoutCollapsed", "expand", "expandedElement", "mount", "find", "p", "paneIndex", "indexOf", "nextPane", "isLast", "nextCollapsed", "forwardedRef", "useForwardedRef", "setRef", "refValue", "current", "handleCollapse", "handleExpand", "contextValue", "hidden", "divider", "LegacyLayerProvider", "zOffset", "Infinity", "Provider", "BoundaryElementProvider", "height", "usePane", "displayName", "PaneContent", "forwardedAs", "RootCard", "PaneFooter", "_f", "Layout", "TitleCard", "_ref15", "fg", "bg", "card", "enabled", "css", "TitleTextSkeleton", "TextSkeleton", "TitleText", "TabsBox", "_ref16", "rgba", "base", "PaneHeader", "actions", "backButton", "contentAfter", "loading", "subActions", "tabs", "tabIndex", "paneElement", "paneRect", "useElementRect", "layoutStyle", "innerHeight", "handleTitleClick", "handleLayoutClick", "showTabsOrSubActions", "LayerProvider", "sizing", "paddingLeft", "animated", "weight", "paddingTop", "PaneHeaderActionButton", "PaneHeaderMenuItemActionButton", "PaneHeaderMenuGroupActionButton", "console", "warn", "PaneHeaderActionIntentButton", "disabledTooltipContent", "label", "idx", "isMenuNodeButton", "renderAsButton", "isNotMenuNodeButton", "negate", "resolveMenuNodes", "fieldActions", "menuItems", "menuItemGroups", "keyOffset", "i", "a", "mapFieldActionToPaneMenuNode", "groups", "itemGroup", "group", "g", "ungroupedItems", "shortcut", "actionHandler", "showAsAction", "childIdx", "IntentButton", "linkRef", "IntentLink", "role", "InsufficientPermissionsMessageTooltip", "_ref17", "reveal", "currentUser", "useCurrentUser", "InsufficientPermissionsMessage", "POPOVER_PROPS", "getIntent", "templates", "typeName", "t", "templateId", "baseParams", "initialDocumentId", "parameters", "PaneHeaderCreateButton", "_ref18", "templateItems", "useTemplates", "templatePermissions", "isTemplatePermissionsLoading", "useTemplatePermissions", "nothingGranted", "every", "permission", "granted", "permissionsById", "reduce", "acc", "ComposeIcon", "firstItem", "permissions", "itemIndex", "isNonNullable", "hashObject", "sortObject", "v", "isArray", "Object", "entries", "_ref19", "_ref20", "keyA", "keyB", "localeCompare", "normalize", "JSON", "parse", "stringify", "PaneHeaderActions", "memo", "initialValueTemplateItems", "initialValueTemplateItemsFromStructure", "actionHandlers", "EMPTY_OBJECT", "handleAction", "handler", "menuNodes", "actionNodes", "contextMenuNodes", "initialValueTemplateItemFromMenuItems", "menuItemIndex", "intentParams", "templateParams", "_ref21", "initialValueTemplateItem", "description", "combinedInitialValueTemplates", "uniqBy", "DocumentPaneContext", "useDocumentPane", "documentPane", "DISABLED_REASON_TITLE", "NOTHING_TO_DELETE", "DeleteAction", "_ref22", "onComplete", "setIsDeleting", "paneSetIsDeleting", "delete", "deleteOp", "useDocumentOperation", "isDeleting", "isConfirmDialogOpen", "setConfirmDialogOpen", "handleCancel", "handleConfirm", "execute", "handle", "isPermissionsLoading", "useDocumentPairPermissions", "TrashIcon", "operationLabel", "onHandle", "dialog", "component", "NO_CHANGES", "NOT_PUBLISHED", "DiscardChangesAction", "_ref23", "liveEdit", "discardChanges", "ResetIcon", "NOTHING_TO_DUPLICATE", "DuplicateAction", "_ref24", "duplicate", "useRouter", "isDuplicating", "setDuplicating", "dupeId", "uuid", "CopyIcon", "HistoryRestoreAction", "_ref25", "revision", "restore", "useDocumentOperationEvent", "prevEvent", "useRef", "op", "isRevisionInitialVersion", "isRevisionLatestVersion", "RestoreIcon", "LIVE_EDIT_ENABLED", "ALREADY_PUBLISHED", "NOT_READY", "getDisabledReason", "publishedAt", "PublishAction", "publishState", "setPublishState", "publish", "validationStatus", "useValidationStatus", "syncState", "useSyncState", "changesOpen", "onHistoryOpen", "editState", "useEditState", "_rev", "hasValidationErrors", "validation", "isValidationErrorMarker", "publishScheduled", "setPublishScheduled", "isSyncing", "isValidating", "hasDraft", "doPublish", "validationComplete", "didPublish", "delay", "transactionSyncLock", "UnpublishAction", "_ref26", "unpublish", "UnpublishIcon", "LiveEditBadge", "_DEBUG", "EMPTY_PARAMS", "LOADING_PANE", "Symbol", "DOCUMENT_PANEL_PORTAL_ELEMENT", "activePanes", "setActivePanes", "getIntentState", "routerState", "editDocumentId", "isTemplate", "canHandleIntent", "call", "schemaTypeName", "options", "paneParams", "legacyEditParamsToState", "decodeURIComponent", "err", "encodePanesSegment", "encodeChunks", "encodeURIComponent", "legacyEditParamsToPath", "toState", "pathSegment", "parsePanesSegment", "toPath", "router", "route", "create", "intents", "path", "transform", "panePattern", "isParam", "str", "test", "isPayload", "exclusiveParams", "isTruthy", "parseChunks", "chunks", "initial", "chunk", "tryParseBase64Payload", "firstSibling", "paneIsFirstSibling", "sameAsFirst", "encodedPayload", "btoa", "encodedParams", "entry", "valueFromFirstSibling", "includes", "_ref27", "flat", "parseOldPanesSegment", "restOfSiblings", "segment", "sibling", "omit", "buffer", "match", "payloadChunk", "tryParsePayload", "data", "atob", "DOCUMENT_PANEL_MIN_WIDTH", "DOCUMENT_PANEL_INITIAL_MIN_WIDTH", "DOCUMENT_INSPECTOR_MIN_WIDTH", "DOCUMENT_INSPECTOR_MAX_WIDTH", "INSPECT_ACTION_PREFIX", "DEFAULT_MENU_ITEM_GROUPS", "HISTORY_INSPECTOR_NAME", "VALIDATION_INSPECTOR_NAME", "position", "zIndex", "lineHeight", "display", "left", "bottom", "right", "borderBottom", "opacity", "DocumentInspectorHeader", "closeButtonLabel", "CloseIcon", "DeskToolContext", "useDeskTool", "deskTool", "div", "Resizer", "onResize", "onResizeStart", "mouseXRef", "Resizable", "setElement", "elementWidthRef", "targetWidth", "setTargetWidth", "handleResizeStart", "offsetWidth", "handleResize", "w", "Math", "min", "max", "getPathTypes", "result", "s", "jsonType", "field", "fields", "f", "itemType", "ofType", "_key", "values", "MARKER_ICON", "ErrorOutlineIcon", "warning", "info", "MARKER_TONE", "ValidationInspector", "onFocus", "onPathOpen", "handleOpen", "marker", "ValidationCard", "onOpen", "errorInfo", "setErrorInfo", "level", "createElement", "DocumentNodePathBreadcrumbs", "pathTypes", "fontWeight", "useMenuItem", "validationMarkers", "hasErrors", "isValidationError", "hasWarnings", "isValidationWarning", "CheckmarkCircleIcon", "validationInspector", "TIMELINE_LABELS", "discardDraft", "editDraft", "editLive", "TIMELINE_ICON_COMPONENTS", "AddCircleIcon", "formatTimelineEventLabel", "getTimelineEventIconComponent", "UserAvatarStack", "_ref28", "maxLength", "userIds", "AvatarStack", "userId", "UserAvatar", "user", "withTooltip", "_g", "IconWrapper", "_ref29", "borderColor", "skeleton", "_ref30", "$selected", "$disabled", "IconBox", "EventLabel", "TimestampBox", "_ref31", "TIMELINE_ITEM_EVENT_TONE", "withinSelection", "TimelineItem", "_ref32", "isFirst", "isLatest", "isSelected", "onSelect", "timestamp", "iconComponent", "authorUserIds", "authors", "isSelectable", "formattedTimestamp", "parsedDate", "Date", "formattedDate", "format", "evt", "stopPropagation", "StackWrapper", "ListWrapper", "_ref33", "$visible", "Timeline", "_ref34", "disabledBeforeFirstChunk", "hasMoreChunks", "lastChunk", "onLoadMore", "firstChunk", "mounted", "setMounted", "filteredChunks", "c", "selectedIndex", "findIndex", "renderItem", "_ref35", "activeIndex", "endTimestamp", "CommandList", "activeItemDataAttr", "ariaLabel", "autoFocus", "initialIndex", "initialScrollAlign", "itemHeight", "items", "onEndReached", "onEndReachedIndexOffset", "overscan", "wrapAround", "TimelineError", "Popover", "TimelineMenu", "_ref36", "setTimelineRange", "setTimelineMode", "timelineError", "timelineStore", "isDeleted", "open", "setOpen", "setButton", "setPopover", "useTimelineSelector", "realRevChunk", "sinceTime", "handleClose", "handleClickOutside", "handleGlobalKeyDown", "focus", "useClickOutside", "useGlobalKeyDown", "selectRev", "revChunk", "sinceId", "revId", "findRangeForRev", "closable", "selectSince", "sinceChunk", "findRangeForSince", "handleLoadMore", "loadMore", "timeLabel", "useFormattedTimestamp", "revLabel", "upperFirst", "sinceLabel", "buttonLabel", "SelectIcon", "formatted", "LoadingContent", "collectLatestAuthorAnnotations", "diff", "authorMap", "Map", "visitDiff", "annotation", "author", "previous", "set", "b", "Scroller", "ScrollContainer", "ChangesInspector", "scrollRef", "onOlderRevision", "selectionState", "isComparingCurrent", "documentContext", "React", "FieldWrapper", "ChangeFieldWrapper", "rootDiff", "changeAnnotations", "DiffTooltip", "annotations", "_ref37", "Content", "_ref38", "NoChanges", "DocumentChangeContext", "ChangeList", "changesInspector", "features", "reviewChanges", "_ref39", "since", "_ref40", "documentActions", "documentBadges", "inspectors", "definePlugin", "prevActions", "badges", "prevBadges", "prevInspectors", "tools", "MasterDetailIcon", "lazy", "controlsDocumentTitle", "getInspectorItems", "_ref41", "currentInspector", "hasValue", "inspectorMenuItems", "inspector", "menuItem", "isDisabled", "getInspectItem", "_ref42", "BinaryDocumentIcon", "getProductionPreviewItem", "_ref43", "previewUrl", "EarthAmericasIcon", "getMenuItems", "inspectorItems", "isSanityDocument", "usePreviewUrl", "setPreviewUrl", "resolveProductionUrl", "useSource", "value$", "useAsObservable", "debounceTime", "subscribe", "next", "getInitialValueTemplateOpts", "opts", "panePayload", "structureNodeTemplate", "templateName", "urlTemplate", "typeTemplates", "InspectorMenuItem", "setMenuItem", "DocumentInspectorMenuItemsResolver", "onMenuItems", "len", "lenRef", "setMenuItems", "menuItemsRef", "newFieldActions", "prev", "inspectorIndex", "DocumentPaneProvider", "paneKey", "unstable_fieldActions", "fieldActionsResolver", "unstable_languageFilter", "languageFilterResolver", "inspectorsResolver", "presenceStore", "usePresenceStore", "paneRouter", "setPaneParams", "pushToast", "views", "viewsProp", "paneOptions", "documentIdRaw", "templateParameters", "initialValueRaw", "useInitialValue", "initialValue", "patch", "validationRaw", "connectionState", "useConnectionState", "setInspectorMenuItems", "languageFilter", "focusPath", "setFocusPath", "pathFromString", "activeViewId", "view", "timelineMode", "setTimelineError", "useTimelineStore", "onError", "rev", "revTime", "sinceAttributes", "timelineDisplayed", "timelineReady", "isPristine", "setPresence", "subscription", "nextPresence", "unsubscribe", "inspectorName", "setInspectorName", "inspect", "inspectParamRef", "resolvedChangesInspector", "inspectOpen", "compareValue", "displayed", "newSince", "newRev", "handleFocus", "nextFocusPath", "setLocation", "lastActiveAt", "toISOString", "handleBlur", "blurredPath", "patchRef", "toMutationPatches", "patches", "handleChange", "closeInspector", "closeInspectorName", "openInspector", "nextInspectorName", "nextInspector", "currentParams", "closeResult", "handleHistoryClose", "handleHistoryOpen", "handlePaneClose", "handlePaneSplit", "toggleLegacyInspect", "toggle", "arguments", "undefined", "handleMenuAction", "startsWith", "handleKeyUp", "isHotkey", "handleLegacyInspectClose", "openPath", "onSetOpenPath", "fieldGroupState", "onSetFieldGroupState", "collapsedPaths", "onSetCollapsedPath", "collapsedFieldSets", "onSetCollapsedFieldSets", "handleOnSetCollapsedPath", "prevState", "setAtPath", "handleOnSetCollapsedFieldSet", "handleSetActiveFieldGroup", "groupName", "requiredPermission", "_createdAt", "docId", "docPermissionsInput", "useDocumentValuePermissions", "isNonExistent", "readOnly", "hasNoPermission", "updateActionDisabled", "isActionEnabled", "createActionDisabled", "reconnecting", "isLocked", "formState", "useFormState", "comparisonValue", "formStateRef", "setOpenPath", "ops", "getExpandOperations", "forEach", "onBlur", "onChange", "onHistoryClose", "onInspectClose", "onKeyUp", "onMenuAction", "onPaneClose", "onPaneSplit", "onSetActiveFieldGroup", "onSetCollapsedFieldSet", "restParams", "pathFromUrl", "resolveKeyedPath", "rootFieldActionNodes", "setRootFieldActionNodes", "FieldActionsResolver", "onActions", "FieldActionsProvider", "SerializeError", "constructor", "parentPath", "hint", "__publicField", "withHelpUrl", "helpId", "HELP_URL", "IMPLICIT_FIELDS", "joinReferences", "head", "tail", "schemaField", "refTypes", "to", "refType", "tailFields", "tailWrapper", "getExtendedProjection", "orderBy", "ordering", "ORDER_BY_UPDATED_AT", "by", "ORDER_BY_CREATED_AT", "DEFAULT_SELECTED_ORDERING_OPTION", "DEFAULT_ORDERING_OPTIONS", "maybeSerializeMenuItem", "MenuItemBuilder", "serialize", "_context", "spec", "clone", "getAction", "getTitle", "getGroup", "getIcon", "getParams", "getShowAsAction", "TITLE_REQUIRED", "ACTION_OR_INTENT_REQUIRED", "ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE", "withSpec", "builder", "getOrderingMenuItem", "extendedProjection", "SortIcon", "getOrderingMenuItemsForSchemaType", "orderings", "maybeSerializeMenuItemGroup", "MenuItemGroupBuilder", "_title", "getId", "ID_REQUIRED", "disallowedPattern", "validateId", "disallowedChar", "getStructureNodeId", "camelCased", "camelCase", "getSlug", "ComponentBuilder", "getChild", "getComponent", "getOptions", "getMenuItemGroups", "componentOptions", "resolveTypeForDocument", "getClient", "types", "GenericViewBuilder", "kebabCase", "isSerializable", "maybeSerializeView", "isComponentSpec", "ComponentViewBuilder", "componentOrSpec", "userComponent", "COMPONENT_REQUIRED", "FormViewBuilder", "form", "createDocumentChildResolver", "_ref44", "resolveDocumentNode", "itemId", "_ref45", "currentSegment", "DocumentBuilder", "paneId", "getDocumentId", "getSchemaType", "initialValueTemplate", "getInitialValueTemplate", "getInitialValueTemplateParameters", "getViews", "urlId", "DOCUMENT_ID_REQUIRED", "viewIds", "dupes", "uniq", "viewId", "getDocumentOptions", "documentFromEditor", "documentFromEditorWithInitialValue", "_ref46", "layoutOptions", "DEFAULT_INTENT_HANDLER", "defaultIntentChecker", "intentName", "_ref47", "isEdit", "isCreate", "typedSpec", "paneFilter", "typeNames", "getTypeNamesFromFilter", "initialValueTemplates", "tpl", "identity", "InitialValueTemplateItemBuilder", "getDescription", "getTemplateId", "getParameters", "defaultInitialValueTemplateItems", "getStructureBuilder", "getTypeNames", "ordered", "maybeSerializeInitialValueTemplateItem", "menuItemsFromInitialValueTemplateItems", "pickBy", "noChildResolver", "shallowIntentChecker", "_ref48", "GenericListBuilder", "defaultLayout", "getDefaultLayout", "getCanHandleIntent", "showIcons", "displayOptions", "getShowIcons", "initialValueTemplatesSpecified", "getInitialValueTemplates", "validateFilter", "trim", "QUERY_PROVIDED_FOR_FILTER", "createDocumentChildResolverForItem", "parentItem", "parent", "Promise", "resolve", "then", "DocumentListBuilder", "apiVersion", "getApiVersion", "getFilter", "defaultOrdering", "getDefaultOrdering", "FILTER_REQUIRED", "hasSimpleFilter", "generateHelpUrl", "API_VERSION_REQUIRED_FOR_CUSTOM_FILTER", "inferInitialValueTemplates", "inferTypeName", "getSpec", "flatMap", "resolveNewDocumentOptions", "option", "getTypeNamesFromEqualityFilter", "getTypeNamesFromInTypesFilter", "pattern", "matches", "exec", "candidate", "normalized", "replace", "getArgType", "thing", "ListBuilder", "isPromise", "isListItem", "defaultCanHandleIntent", "isDocumentListItem", "resolveChildForItem", "target", "maybeSerializeListItem", "ListItemBuilder", "listItem", "gotWhat", "helpText", "INVALID_LIST_ITEM", "getItems", "LIST_ITEMS_MUST_BE_ARRAY", "serializedItems", "val", "dupeIds", "dupeDesc", "LIST_ITEM_IDS_MUST_BE_UNIQUE", "showIcon", "getShowIcon", "titleIsOptional", "SCHEMA_TYPE_NOT_FOUND", "serializeOptions", "listChild", "originalChild", "childOptions", "createDefaultChildResolver", "DocumentListItemBuilder", "SCHEMA_TYPE_REQUIRED", "DocumentTypeListBuilder", "cloneWithoutDefaultIntentHandler", "shouldOverride", "override", "shouldShowIcon", "preview", "prepare", "select", "media", "BUNDLED_DOC_TYPES", "isBundledDocType", "isDocumentType", "isList", "collection", "getDocumentTypes", "_ref49", "n", "getDocumentTypeListItems", "getDocumentTypeListItem", "startCase", "childContext", "list", "getDocumentTypeList", "typeNameOrSpec", "StackCompactIcon", "StackIcon", "hasIcon", "getDefaultStructure", "createStructureBuilder", "_ref50", "defaultDocumentNode", "source", "configContext", "getConfigContextFromSource", "structureBuilder", "defaults", "documentTypeList", "_len", "args", "documentTypeListItem", "_len2", "_key2", "documentTypeListItems", "_len3", "_key3", "_len4", "_key4", "documentWithInitialValueTemplate", "_len5", "_key5", "defaultDocument", "_len6", "_key6", "_len7", "_key7", "_len8", "_key8", "menuItemGroup", "_len9", "_key9", "_len10", "_key10", "documentList", "_len11", "_key11", "documentListItem", "_len12", "_key12", "orderingMenuItem", "_len13", "_key13", "orderingMenuItemsForType", "_len14", "_key14", "editor", "_len15", "_key15", "_len16", "_key16", "isValidElementType", "uniqueId", "DeskToolProvider", "_ref51", "structure", "resolveStructure", "setLayoutCollapsed", "useConfigContextFromSource", "S", "rootPaneNode", "resizablePanes", "splitPanes", "splitViews", "structureContext"]
}
